

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=light>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="MATLAB代码MATLAB 绘制 2D&#x2F;3D 图片plot_func(dimension,x, y, z,  fontsize, linewidth, x_dis, y_dis, width, height, x_label, y_label, title1) 123456789101112131415161718192021222324252627282930function Y &#x3D;">
<meta property="og:type" content="article">
<meta property="og:title" content="MATLAB代码">
<meta property="og:url" content="http://example.com/2023/11/08/MATLAB/MATLAB%E4%BB%A3%E7%A0%81/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="MATLAB代码MATLAB 绘制 2D&#x2F;3D 图片plot_func(dimension,x, y, z,  fontsize, linewidth, x_dis, y_dis, width, height, x_label, y_label, title1) 123456789101112131415161718192021222324252627282930function Y &#x3D;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.staticaly.com/gh/yangmulao/blogcdn@master/img/image-20230405221005646.png">
<meta property="og:image" content="https://cdn.staticaly.com/gh/yangmulao/blogcdn@master/img/image-20230405220929573.png">
<meta property="og:image" content="https://cdn.staticaly.com/gh/yangmulao/blogcdn@master/img/image-20230405173146881.png">
<meta property="article:published_time" content="2023-11-08T01:57:50.062Z">
<meta property="article:modified_time" content="2023-05-12T02:46:46.585Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="博客图片">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://cdn.staticaly.com/gh/yangmulao/blogcdn@master/img/image-20230405221005646.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>MATLAB代码 - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.4","typing":{"enable":false,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":false,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"left","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  

  

  



  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 60vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>wbupt</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle">MATLAB代码</span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-11-08 09:57" pubdate>
          2023年11月8日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          60k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          499 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="padding-left: 2rem; margin-right: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">MATLAB代码</h1>
            
              <p class="note note-info">
                
                  
                    本文最后更新于：1 年前
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <h1 id="MATLAB代码"><a href="#MATLAB代码" class="headerlink" title="MATLAB代码"></a>MATLAB代码</h1><h2 id="MATLAB-绘制-2D-3D-图片"><a href="#MATLAB-绘制-2D-3D-图片" class="headerlink" title="MATLAB 绘制 2D&#x2F;3D 图片"></a>MATLAB 绘制 2D&#x2F;3D 图片</h2><p><code>plot_func(dimension,x, y, z,  fontsize, linewidth, x_dis, y_dis, width, height, x_label, y_label, title1)</code></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Y</span> = <span class="title">plot_func</span><span class="params">(dimension,x, y, z,  fontsize, linewidth, x_dis, y_dis, width, height, x_label, y_label, title1)</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> dimension == <span class="number">3</span></span><br><span class="line">        <span class="built_in">figure</span>(<span class="string">&#x27;color&#x27;</span>,[<span class="number">1</span> <span class="number">1</span> <span class="number">1</span>], <span class="string">&#x27;position&#x27;</span>, [x_dis, y_dis, width, height]); <span class="comment">% [位置横纵 宽 高]</span></span><br><span class="line">        h = pcolor(x, y, z); <span class="comment">% 绘制图像，并返回句柄</span></span><br><span class="line">        set(h, <span class="string">&#x27;EdgeColor&#x27;</span>, <span class="string">&#x27;none&#x27;</span>);</span><br><span class="line">        axis tight; <span class="comment">% 自动调整坐标轴的范围，使其紧贴着数据的最小值和最大值</span></span><br><span class="line">        colorbar;colormap jet;</span><br><span class="line">        set(gca, <span class="string">&#x27;TickDir&#x27;</span>, <span class="string">&#x27;in&#x27;</span>, <span class="string">&#x27;Box&#x27;</span>, <span class="string">&#x27;off&#x27;</span>, <span class="string">&#x27;LineWidth&#x27;</span>, linewidth);</span><br><span class="line">        set(gca,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Times New Roman&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,fontsize); <span class="comment">% Times New Roman</span></span><br><span class="line">        xlabel(x_label,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Times New Roman&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,fontsize);</span><br><span class="line">        ylabel(y_label,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Times New Roman&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,fontsize);</span><br><span class="line">        title(title1,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Monospaced&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,fontsize);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> dimension == <span class="number">2</span></span><br><span class="line">        <span class="built_in">figure</span>(<span class="string">&#x27;color&#x27;</span>,[<span class="number">1</span> <span class="number">1</span> <span class="number">1</span>], <span class="string">&#x27;position&#x27;</span>, [x_dis, y_dis, width, height]); <span class="comment">% [位置横纵 宽 高]</span></span><br><span class="line">        <span class="built_in">plot</span>([<span class="number">0</span> <span class="number">0</span>],[<span class="number">0</span> <span class="number">0</span>],<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">1.5</span>);<span class="built_in">hold</span> on;</span><br><span class="line">        set(gca,<span class="string">&#x27;FontSize&#x27;</span>,fontsize,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Times New Roman&#x27;</span>, <span class="string">&#x27;LineWidth&#x27;</span>, linewidth);</span><br><span class="line">        xlabel(x_label,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Times New Roman&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,fontsize);</span><br><span class="line">        ylabel(y_label,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Times New Roman&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,fontsize);</span><br><span class="line">        title(title1,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Monospaced&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,fontsize);</span><br><span class="line">        axis tight;</span><br><span class="line">        <span class="keyword">for</span> ix = <span class="number">1</span>:<span class="built_in">length</span>(y(<span class="number">1</span>,:))</span><br><span class="line">            <span class="built_in">plot</span>(x, y(:,ix),  <span class="string">&#x27;Color&#x27;</span>, <span class="built_in">rand</span>(<span class="number">1</span>,<span class="number">3</span>), <span class="string">&#x27;LineWidth&#x27;</span>, linewidth);<span class="built_in">hold</span> on;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        xlim([<span class="built_in">min</span>(x), <span class="built_in">max</span>(x)]);</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<img src="https://cdn.staticaly.com/gh/yangmulao/blogcdn@master/img/image-20230405221005646.png" srcset="/img/loading.gif" lazyload alt="image-20230405221005646" style="zoom:50%;" />

<img src="https://cdn.staticaly.com/gh/yangmulao/blogcdn@master/img/image-20230405220929573.png" srcset="/img/loading.gif" lazyload alt="image-20230405220929573" style="zoom:50%;" />

<h2 id="Comsol-数据导出成矩阵1"><a href="#Comsol-数据导出成矩阵1" class="headerlink" title="Comsol 数据导出成矩阵1"></a>Comsol 数据导出成矩阵1</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">clear M;</span><br><span class="line">a=<span class="number">0</span>:<span class="number">2</span>:<span class="number">86</span>;</span><br><span class="line">b=<span class="number">486</span>;</span><br><span class="line">M=[];</span><br><span class="line"><span class="keyword">for</span> i=<span class="number">1</span>:length(a)</span><br><span class="line">    x=df(((i-<span class="number">1</span>)*b+<span class="number">1</span>:(i-<span class="number">1</span>)*b+<span class="number">486</span>),<span class="number">2</span>);</span><br><span class="line">    M=[M x];</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<h2 id="Comsol-数据导出成矩阵2"><a href="#Comsol-数据导出成矩阵2" class="headerlink" title="Comsol 数据导出成矩阵2"></a>Comsol 数据导出成矩阵2</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">wave=<span class="number">400</span>:<span class="number">20</span>:<span class="number">1300</span>;</span><br><span class="line"></span><br><span class="line">a=load(<span class="string">&#x27;C:\Users\Administrator\Desktop\Y.txt&#x27;</span>);</span><br><span class="line">dis=<span class="built_in">round</span>(a(<span class="number">2</span>,<span class="number">1</span>)-a(<span class="number">1</span>,<span class="number">1</span>),<span class="number">0</span>);</span><br><span class="line">x = <span class="built_in">round</span>((a(end,<span class="number">1</span>)-a(<span class="number">1</span>,<span class="number">1</span>))/dis,<span class="number">0</span>)+<span class="number">1</span>;</span><br><span class="line">clear M;</span><br><span class="line">dis=<span class="built_in">round</span>(a(<span class="number">2</span>,<span class="number">1</span>)-a(<span class="number">1</span>,<span class="number">1</span>),<span class="number">0</span>);</span><br><span class="line">x = <span class="built_in">round</span>((a(end,<span class="number">1</span>)-a(<span class="number">1</span>,<span class="number">1</span>))/dis,<span class="number">0</span>)+<span class="number">1</span>;</span><br><span class="line">dis = <span class="number">1</span>;</span><br><span class="line">x = <span class="number">31</span>;</span><br><span class="line"><span class="keyword">for</span> ix =<span class="number">1</span>:length(a(:,<span class="number">1</span>))/x</span><br><span class="line">    M(:,ix) =a((ix-<span class="number">1</span>)*x+<span class="number">1</span>:x*ix,<span class="number">2</span>); </span><br><span class="line">end</span><br><span class="line">plot(wave,M(:,<span class="number">8</span>:<span class="number">14</span>))</span><br><span class="line">plot(wave,M(:,<span class="number">15</span>:<span class="number">21</span>))</span><br><span class="line"></span><br><span class="line">b = reshape(a,<span class="number">217</span>,<span class="number">41</span>)</span><br></pre></td></tr></table></figure>

<p>MATLAB CRT Ra色坐标</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br></pre></td><td class="code"><pre><span class="line">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line">%This script calculates chromaticity coordinates, CCT, CRI, GAI, <span class="keyword">and</span> FSCI</span><br><span class="line">%<span class="keyword">for</span> a <span class="number">2856</span> blackbody source (illuminant A).  To use other sources, just</span><br><span class="line">%replace the spd matrix <span class="keyword">with</span> the values <span class="keyword">for</span> the other source.</span><br><span class="line">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line"></span><br><span class="line">% Light source SPD</span><br><span class="line">%   The light source spd <span class="keyword">is</span> entered <span class="keyword">in</span> a <span class="number">2</span>-column <span class="built_in">format</span> <span class="keyword">as</span> shown below.</span><br><span class="line">%   [wavelength (nm)    value]</span><br><span class="line">spd =[                 <span class="number">380</span>       <span class="number">0.00132948037347175</span>;...</span><br><span class="line">                       <span class="number">390</span>       <span class="number">0.00164023432576807</span>;...</span><br><span class="line">                       <span class="number">400</span>       <span class="number">0.00199607408541092</span>;...</span><br><span class="line">                       <span class="number">410</span>       <span class="number">0.00239863299576014</span>;...</span><br><span class="line">                       <span class="number">420</span>       <span class="number">0.00284898784428011</span>;...</span><br><span class="line">                       <span class="number">430</span>       <span class="number">0.00334764547822949</span>;...</span><br><span class="line">                       <span class="number">440</span>       <span class="number">0.00389454498476917</span>;...</span><br><span class="line">                       <span class="number">450</span>        <span class="number">0.0044890736644276</span>;...</span><br><span class="line">                       <span class="number">460</span>       <span class="number">0.00513009474369056</span>;...</span><br><span class="line">                       <span class="number">470</span>       <span class="number">0.00581598464137424</span>;...</span><br><span class="line">                       <span class="number">480</span>       <span class="number">0.00654467759688934</span>;...</span><br><span class="line">                       <span class="number">490</span>       <span class="number">0.00731371555834619</span>;...</span><br><span class="line">                       <span class="number">500</span>       <span class="number">0.00812030138807687</span>;...</span><br><span class="line">                       <span class="number">510</span>       <span class="number">0.00896135364886274</span>;...</span><br><span class="line">                       <span class="number">520</span>       <span class="number">0.00983356146587939</span>;...</span><br><span class="line">                       <span class="number">530</span>        <span class="number">0.0107334382008557</span>;...</span><br><span class="line">                       <span class="number">540</span>        <span class="number">0.0116573729136429</span>;...</span><br><span class="line">                       <span class="number">550</span>        <span class="number">0.0126016788131223</span>;...</span><br><span class="line">                       <span class="number">560</span>        <span class="number">0.0135626381078808</span>;...</span><br><span class="line">                       <span class="number">570</span>        <span class="number">0.0145365428535139</span>;...</span><br><span class="line">                       <span class="number">580</span>        <span class="number">0.0155197315558729</span>;...</span><br><span class="line">                       <span class="number">590</span>        <span class="number">0.0165086214276558</span>;...</span><br><span class="line">                       <span class="number">600</span>        <span class="number">0.0174997363101301</span>;...</span><br><span class="line">                       <span class="number">610</span>        <span class="number">0.0184897303639286</span>;...</span><br><span class="line">                       <span class="number">620</span>        <span class="number">0.0194754077047119</span>;...</span><br><span class="line">                       <span class="number">630</span>        <span class="number">0.0204537382132532</span>;...</span><br><span class="line">                       <span class="number">640</span>        <span class="number">0.0214218697874947</span>;...</span><br><span class="line">                       <span class="number">650</span>         <span class="number">0.022377137328638</span>;...</span><br><span class="line">                       <span class="number">660</span>        <span class="number">0.0233170687665763</span>;...</span><br><span class="line">                       <span class="number">670</span>        <span class="number">0.0242393884339735</span>;...</span><br><span class="line">                       <span class="number">680</span>        <span class="number">0.0251420180949075</span>;...</span><br><span class="line">                       <span class="number">690</span>        <span class="number">0.0260230759248419</span>;...</span><br><span class="line">                       <span class="number">700</span>         <span class="number">0.026880873725211</span>;...</span><br><span class="line">                       <span class="number">710</span>        <span class="number">0.0277139126393038</span>;...</span><br><span class="line">                       <span class="number">720</span>        <span class="number">0.0285208776174515</span>;...</span><br><span class="line">                       <span class="number">730</span>        <span class="number">0.0293006308595934</span>;...</span><br><span class="line">                       <span class="number">740</span>        <span class="number">0.0300522044428256</span>;...</span><br><span class="line">                       <span class="number">750</span>        <span class="number">0.0307747923210527</span>;...</span><br><span class="line">                       <span class="number">760</span>        <span class="number">0.0314677418638086</span>;...</span><br><span class="line">                       <span class="number">770</span>        <span class="number">0.0321305450820022</span>;...</span><br><span class="line">                       <span class="number">780</span>        <span class="number">0.0327628296700076</span>];</span><br><span class="line">                   </span><br><span class="line">  wavelength_spd = spd(:,<span class="number">1</span>);</span><br><span class="line">  spd = spd(:,<span class="number">2</span>);</span><br><span class="line">       </span><br><span class="line">% First, obtain reference data values</span><br><span class="line">% The CIE <span class="number">1931</span> <span class="number">2</span> degree Standard Colorimetric Observer</span><br><span class="line">% [wavelength(nm)   xbar    ybar zbar]</span><br><span class="line">CIE31Table = [<span class="number">360</span> <span class="number">0.000130</span> <span class="number">0.000004</span> <span class="number">0.000606</span>;...</span><br><span class="line">            <span class="number">361</span> <span class="number">0.000146</span> <span class="number">0.000004</span> <span class="number">0.000681</span>;...</span><br><span class="line">            <span class="number">362</span> <span class="number">0.000164</span> <span class="number">0.000005</span> <span class="number">0.000765</span>;...</span><br><span class="line">            <span class="number">363</span> <span class="number">0.000184</span> <span class="number">0.000006</span> <span class="number">0.000860</span>;...</span><br><span class="line">            <span class="number">364</span> <span class="number">0.000207</span> <span class="number">0.000006</span> <span class="number">0.000967</span>;...</span><br><span class="line">            <span class="number">365</span> <span class="number">0.000232</span> <span class="number">0.000007</span> <span class="number">0.001086</span>;...</span><br><span class="line">            <span class="number">366</span> <span class="number">0.000261</span> <span class="number">0.000008</span> <span class="number">0.001221</span>;...</span><br><span class="line">            <span class="number">367</span> <span class="number">0.000293</span> <span class="number">0.000009</span> <span class="number">0.001373</span>;...</span><br><span class="line">            <span class="number">368</span> <span class="number">0.000329</span> <span class="number">0.000010</span> <span class="number">0.001544</span>;...</span><br><span class="line">            <span class="number">369</span> <span class="number">0.000370</span> <span class="number">0.000011</span> <span class="number">0.001734</span>;...</span><br><span class="line">            <span class="number">370</span> <span class="number">0.000415</span> <span class="number">0.000012</span> <span class="number">0.001946</span>;...</span><br><span class="line">            <span class="number">371</span> <span class="number">0.000464</span> <span class="number">0.000014</span> <span class="number">0.002178</span>;...</span><br><span class="line">            <span class="number">372</span> <span class="number">0.000519</span> <span class="number">0.000016</span> <span class="number">0.002436</span>;...</span><br><span class="line">            <span class="number">373</span> <span class="number">0.000582</span> <span class="number">0.000017</span> <span class="number">0.002732</span>;...</span><br><span class="line">            <span class="number">374</span> <span class="number">0.000655</span> <span class="number">0.000020</span> <span class="number">0.003078</span>;...</span><br><span class="line">            <span class="number">375</span> <span class="number">0.000742</span> <span class="number">0.000022</span> <span class="number">0.003486</span>;...</span><br><span class="line">            <span class="number">376</span> <span class="number">0.000845</span> <span class="number">0.000025</span> <span class="number">0.003975</span>;...</span><br><span class="line">            <span class="number">377</span> <span class="number">0.000965</span> <span class="number">0.000028</span> <span class="number">0.004541</span>;...</span><br><span class="line">            <span class="number">378</span> <span class="number">0.001095</span> <span class="number">0.000032</span> <span class="number">0.005158</span>;...</span><br><span class="line">            <span class="number">379</span> <span class="number">0.001231</span> <span class="number">0.000035</span> <span class="number">0.005803</span>;...</span><br><span class="line">            <span class="number">380</span> <span class="number">0.001368</span> <span class="number">0.000039</span> <span class="number">0.006450</span>;...</span><br><span class="line">            <span class="number">381</span> <span class="number">0.001502</span> <span class="number">0.000043</span> <span class="number">0.007083</span>;...</span><br><span class="line">            <span class="number">382</span> <span class="number">0.001642</span> <span class="number">0.000047</span> <span class="number">0.007745</span>;...</span><br><span class="line">            <span class="number">383</span> <span class="number">0.001802</span> <span class="number">0.000052</span> <span class="number">0.008501</span>;...</span><br><span class="line">            <span class="number">384</span> <span class="number">0.001996</span> <span class="number">0.000057</span> <span class="number">0.009415</span>;...</span><br><span class="line">            <span class="number">385</span> <span class="number">0.002236</span> <span class="number">0.000064</span> <span class="number">0.010550</span>;...</span><br><span class="line">            <span class="number">386</span> <span class="number">0.002535</span> <span class="number">0.000072</span> <span class="number">0.011966</span>;...</span><br><span class="line">            <span class="number">387</span> <span class="number">0.002893</span> <span class="number">0.000082</span> <span class="number">0.013656</span>;...</span><br><span class="line">            <span class="number">388</span> <span class="number">0.003301</span> <span class="number">0.000094</span> <span class="number">0.015588</span>;...</span><br><span class="line">            <span class="number">389</span> <span class="number">0.003753</span> <span class="number">0.000106</span> <span class="number">0.017730</span>;...</span><br><span class="line">            <span class="number">390</span> <span class="number">0.004243</span> <span class="number">0.000120</span> <span class="number">0.020050</span>;...</span><br><span class="line">            <span class="number">391</span> <span class="number">0.004762</span> <span class="number">0.000135</span> <span class="number">0.022511</span>;...</span><br><span class="line">            <span class="number">392</span> <span class="number">0.005330</span> <span class="number">0.000151</span> <span class="number">0.025203</span>;...</span><br><span class="line">            <span class="number">393</span> <span class="number">0.005979</span> <span class="number">0.000170</span> <span class="number">0.028280</span>;...</span><br><span class="line">            <span class="number">394</span> <span class="number">0.006741</span> <span class="number">0.000192</span> <span class="number">0.031897</span>;...</span><br><span class="line">            <span class="number">395</span> <span class="number">0.007650</span> <span class="number">0.000217</span> <span class="number">0.036210</span>;...</span><br><span class="line">            <span class="number">396</span> <span class="number">0.008751</span> <span class="number">0.000247</span> <span class="number">0.041438</span>;...</span><br><span class="line">            <span class="number">397</span> <span class="number">0.010029</span> <span class="number">0.000281</span> <span class="number">0.047504</span>;...</span><br><span class="line">            <span class="number">398</span> <span class="number">0.011422</span> <span class="number">0.000319</span> <span class="number">0.054120</span>;...</span><br><span class="line">            <span class="number">399</span> <span class="number">0.012869</span> <span class="number">0.000357</span> <span class="number">0.060998</span>;...</span><br><span class="line">            <span class="number">400</span> <span class="number">0.014310</span> <span class="number">0.000396</span> <span class="number">0.067850</span>;...</span><br><span class="line">            <span class="number">401</span> <span class="number">0.015704</span> <span class="number">0.000434</span> <span class="number">0.074486</span>;...</span><br><span class="line">            <span class="number">402</span> <span class="number">0.017147</span> <span class="number">0.000473</span> <span class="number">0.081362</span>;...</span><br><span class="line">            <span class="number">403</span> <span class="number">0.018781</span> <span class="number">0.000518</span> <span class="number">0.089154</span>;...</span><br><span class="line">            <span class="number">404</span> <span class="number">0.020748</span> <span class="number">0.000572</span> <span class="number">0.098540</span>;...</span><br><span class="line">            <span class="number">405</span> <span class="number">0.023190</span> <span class="number">0.000640</span> <span class="number">0.110200</span>;...</span><br><span class="line">            <span class="number">406</span> <span class="number">0.026207</span> <span class="number">0.000725</span> <span class="number">0.124613</span>;...</span><br><span class="line">            <span class="number">407</span> <span class="number">0.029782</span> <span class="number">0.000825</span> <span class="number">0.141702</span>;...</span><br><span class="line">            <span class="number">408</span> <span class="number">0.033881</span> <span class="number">0.000941</span> <span class="number">0.161303</span>;...</span><br><span class="line">            <span class="number">409</span> <span class="number">0.038468</span> <span class="number">0.001070</span> <span class="number">0.183257</span>;...</span><br><span class="line">            <span class="number">410</span> <span class="number">0.043510</span> <span class="number">0.001210</span> <span class="number">0.207400</span>;...</span><br><span class="line">            <span class="number">411</span> <span class="number">0.048996</span> <span class="number">0.001362</span> <span class="number">0.233692</span>;...</span><br><span class="line">            <span class="number">412</span> <span class="number">0.055023</span> <span class="number">0.001531</span> <span class="number">0.262611</span>;...</span><br><span class="line">            <span class="number">413</span> <span class="number">0.061719</span> <span class="number">0.001720</span> <span class="number">0.294775</span>;...</span><br><span class="line">            <span class="number">414</span> <span class="number">0.069212</span> <span class="number">0.001935</span> <span class="number">0.330799</span>;...</span><br><span class="line">            <span class="number">415</span> <span class="number">0.077630</span> <span class="number">0.002180</span> <span class="number">0.371300</span>;...</span><br><span class="line">            <span class="number">416</span> <span class="number">0.086958</span> <span class="number">0.002455</span> <span class="number">0.416209</span>;...</span><br><span class="line">            <span class="number">417</span> <span class="number">0.097177</span> <span class="number">0.002764</span> <span class="number">0.465464</span>;...</span><br><span class="line">            <span class="number">418</span> <span class="number">0.108406</span> <span class="number">0.003118</span> <span class="number">0.519695</span>;...</span><br><span class="line">            <span class="number">419</span> <span class="number">0.120767</span> <span class="number">0.003526</span> <span class="number">0.579530</span>;...</span><br><span class="line">            <span class="number">420</span> <span class="number">0.134380</span> <span class="number">0.004000</span> <span class="number">0.645600</span>;...</span><br><span class="line">            <span class="number">421</span> <span class="number">0.149358</span> <span class="number">0.004546</span> <span class="number">0.718484</span>;...</span><br><span class="line">            <span class="number">422</span> <span class="number">0.165396</span> <span class="number">0.005159</span> <span class="number">0.796713</span>;...</span><br><span class="line">            <span class="number">423</span> <span class="number">0.181983</span> <span class="number">0.005829</span> <span class="number">0.877846</span>;...</span><br><span class="line">            <span class="number">424</span> <span class="number">0.198611</span> <span class="number">0.006546</span> <span class="number">0.959439</span>;...</span><br><span class="line">            <span class="number">425</span> <span class="number">0.214770</span> <span class="number">0.007300</span> <span class="number">1.039050</span>;...</span><br><span class="line">            <span class="number">426</span> <span class="number">0.230187</span> <span class="number">0.008087</span> <span class="number">1.115367</span>;...</span><br><span class="line">            <span class="number">427</span> <span class="number">0.244880</span> <span class="number">0.008909</span> <span class="number">1.188497</span>;...</span><br><span class="line">            <span class="number">428</span> <span class="number">0.258777</span> <span class="number">0.009768</span> <span class="number">1.258123</span>;...</span><br><span class="line">            <span class="number">429</span> <span class="number">0.271808</span> <span class="number">0.010664</span> <span class="number">1.323930</span>;...</span><br><span class="line">            <span class="number">430</span> <span class="number">0.283900</span> <span class="number">0.011600</span> <span class="number">1.385600</span>;...</span><br><span class="line">            <span class="number">431</span> <span class="number">0.294944</span> <span class="number">0.012573</span> <span class="number">1.442635</span>;...</span><br><span class="line">            <span class="number">432</span> <span class="number">0.304897</span> <span class="number">0.013583</span> <span class="number">1.494804</span>;...</span><br><span class="line">            <span class="number">433</span> <span class="number">0.313787</span> <span class="number">0.014630</span> <span class="number">1.542190</span>;...</span><br><span class="line">            <span class="number">434</span> <span class="number">0.321645</span> <span class="number">0.015715</span> <span class="number">1.584881</span>;...</span><br><span class="line">            <span class="number">435</span> <span class="number">0.328500</span> <span class="number">0.016840</span> <span class="number">1.622960</span>;...</span><br><span class="line">            <span class="number">436</span> <span class="number">0.334351</span> <span class="number">0.018007</span> <span class="number">1.656405</span>;...</span><br><span class="line">            <span class="number">437</span> <span class="number">0.339210</span> <span class="number">0.019214</span> <span class="number">1.685296</span>;...</span><br><span class="line">            <span class="number">438</span> <span class="number">0.343121</span> <span class="number">0.020454</span> <span class="number">1.709875</span>;...</span><br><span class="line">            <span class="number">439</span> <span class="number">0.346130</span> <span class="number">0.021718</span> <span class="number">1.730382</span>;...</span><br><span class="line">            <span class="number">440</span> <span class="number">0.348280</span> <span class="number">0.023000</span> <span class="number">1.747060</span>;...</span><br><span class="line">            <span class="number">441</span> <span class="number">0.349600</span> <span class="number">0.024295</span> <span class="number">1.760045</span>;...</span><br><span class="line">            <span class="number">442</span> <span class="number">0.350147</span> <span class="number">0.025610</span> <span class="number">1.769623</span>;...</span><br><span class="line">            <span class="number">443</span> <span class="number">0.350013</span> <span class="number">0.026959</span> <span class="number">1.776264</span>;...</span><br><span class="line">            <span class="number">444</span> <span class="number">0.349287</span> <span class="number">0.028351</span> <span class="number">1.780433</span>;...</span><br><span class="line">            <span class="number">445</span> <span class="number">0.348060</span> <span class="number">0.029800</span> <span class="number">1.782600</span>;...</span><br><span class="line">            <span class="number">446</span> <span class="number">0.346373</span> <span class="number">0.031311</span> <span class="number">1.782968</span>;...</span><br><span class="line">            <span class="number">447</span> <span class="number">0.344262</span> <span class="number">0.032884</span> <span class="number">1.781700</span>;...</span><br><span class="line">            <span class="number">448</span> <span class="number">0.341809</span> <span class="number">0.034521</span> <span class="number">1.779198</span>;...</span><br><span class="line">            <span class="number">449</span> <span class="number">0.339094</span> <span class="number">0.036226</span> <span class="number">1.775867</span>;...</span><br><span class="line">            <span class="number">450</span> <span class="number">0.336200</span> <span class="number">0.038000</span> <span class="number">1.772110</span>;...</span><br><span class="line">            <span class="number">451</span> <span class="number">0.333198</span> <span class="number">0.039847</span> <span class="number">1.768259</span>;...</span><br><span class="line">            <span class="number">452</span> <span class="number">0.330041</span> <span class="number">0.041768</span> <span class="number">1.764039</span>;...</span><br><span class="line">            <span class="number">453</span> <span class="number">0.326636</span> <span class="number">0.043766</span> <span class="number">1.758944</span>;...</span><br><span class="line">            <span class="number">454</span> <span class="number">0.322887</span> <span class="number">0.045843</span> <span class="number">1.752466</span>;...</span><br><span class="line">            <span class="number">455</span> <span class="number">0.318700</span> <span class="number">0.048000</span> <span class="number">1.744100</span>;...</span><br><span class="line">            <span class="number">456</span> <span class="number">0.314025</span> <span class="number">0.050244</span> <span class="number">1.733559</span>;...</span><br><span class="line">            <span class="number">457</span> <span class="number">0.308884</span> <span class="number">0.052573</span> <span class="number">1.720858</span>;...</span><br><span class="line">            <span class="number">458</span> <span class="number">0.303290</span> <span class="number">0.054981</span> <span class="number">1.705937</span>;...</span><br><span class="line">            <span class="number">459</span> <span class="number">0.297258</span> <span class="number">0.057459</span> <span class="number">1.688737</span>;...</span><br><span class="line">            <span class="number">460</span> <span class="number">0.290800</span> <span class="number">0.060000</span> <span class="number">1.669200</span>;...</span><br><span class="line">            <span class="number">461</span> <span class="number">0.283970</span> <span class="number">0.062602</span> <span class="number">1.647529</span>;...</span><br><span class="line">            <span class="number">462</span> <span class="number">0.276721</span> <span class="number">0.065278</span> <span class="number">1.623413</span>;...</span><br><span class="line">            <span class="number">463</span> <span class="number">0.268918</span> <span class="number">0.068042</span> <span class="number">1.596022</span>;...</span><br><span class="line">            <span class="number">464</span> <span class="number">0.260423</span> <span class="number">0.070911</span> <span class="number">1.564528</span>;...</span><br><span class="line">            <span class="number">465</span> <span class="number">0.251100</span> <span class="number">0.073900</span> <span class="number">1.528100</span>;...</span><br><span class="line">            <span class="number">466</span> <span class="number">0.240847</span> <span class="number">0.077016</span> <span class="number">1.486111</span>;...</span><br><span class="line">            <span class="number">467</span> <span class="number">0.229851</span> <span class="number">0.080266</span> <span class="number">1.439521</span>;...</span><br><span class="line">            <span class="number">468</span> <span class="number">0.218407</span> <span class="number">0.083667</span> <span class="number">1.389880</span>;...</span><br><span class="line">            <span class="number">469</span> <span class="number">0.206812</span> <span class="number">0.087233</span> <span class="number">1.338736</span>;...</span><br><span class="line">            <span class="number">470</span> <span class="number">0.195360</span> <span class="number">0.090980</span> <span class="number">1.287640</span>;...</span><br><span class="line">            <span class="number">471</span> <span class="number">0.184214</span> <span class="number">0.094918</span> <span class="number">1.237422</span>;...</span><br><span class="line">            <span class="number">472</span> <span class="number">0.173327</span> <span class="number">0.099046</span> <span class="number">1.187824</span>;...</span><br><span class="line">            <span class="number">473</span> <span class="number">0.162688</span> <span class="number">0.103367</span> <span class="number">1.138761</span>;...</span><br><span class="line">            <span class="number">474</span> <span class="number">0.152283</span> <span class="number">0.107885</span> <span class="number">1.090148</span>;...</span><br><span class="line">            <span class="number">475</span> <span class="number">0.142100</span> <span class="number">0.112600</span> <span class="number">1.041900</span>;...</span><br><span class="line">            <span class="number">476</span> <span class="number">0.132179</span> <span class="number">0.117532</span> <span class="number">0.994198</span>;...</span><br><span class="line">            <span class="number">477</span> <span class="number">0.122570</span> <span class="number">0.122674</span> <span class="number">0.947347</span>;...</span><br><span class="line">            <span class="number">478</span> <span class="number">0.113275</span> <span class="number">0.127993</span> <span class="number">0.901453</span>;...</span><br><span class="line">            <span class="number">479</span> <span class="number">0.104298</span> <span class="number">0.133453</span> <span class="number">0.856619</span>;...</span><br><span class="line">            <span class="number">480</span> <span class="number">0.095640</span> <span class="number">0.139020</span> <span class="number">0.812950</span>;...</span><br><span class="line">            <span class="number">481</span> <span class="number">0.087300</span> <span class="number">0.144676</span> <span class="number">0.770517</span>;...</span><br><span class="line">            <span class="number">482</span> <span class="number">0.079308</span> <span class="number">0.150469</span> <span class="number">0.729445</span>;...</span><br><span class="line">            <span class="number">483</span> <span class="number">0.071718</span> <span class="number">0.156462</span> <span class="number">0.689914</span>;...</span><br><span class="line">            <span class="number">484</span> <span class="number">0.064581</span> <span class="number">0.162718</span> <span class="number">0.652105</span>;...</span><br><span class="line">            <span class="number">485</span> <span class="number">0.057950</span> <span class="number">0.169300</span> <span class="number">0.616200</span>;...</span><br><span class="line">            <span class="number">486</span> <span class="number">0.051862</span> <span class="number">0.176243</span> <span class="number">0.582329</span>;...</span><br><span class="line">            <span class="number">487</span> <span class="number">0.046282</span> <span class="number">0.183558</span> <span class="number">0.550416</span>;...</span><br><span class="line">            <span class="number">488</span> <span class="number">0.041151</span> <span class="number">0.191274</span> <span class="number">0.520338</span>;...</span><br><span class="line">            <span class="number">489</span> <span class="number">0.036413</span> <span class="number">0.199418</span> <span class="number">0.491967</span>;...</span><br><span class="line">            <span class="number">490</span> <span class="number">0.032010</span> <span class="number">0.208020</span> <span class="number">0.465180</span>;...</span><br><span class="line">            <span class="number">491</span> <span class="number">0.027917</span> <span class="number">0.217120</span> <span class="number">0.439925</span>;...</span><br><span class="line">            <span class="number">492</span> <span class="number">0.024144</span> <span class="number">0.226735</span> <span class="number">0.416184</span>;...</span><br><span class="line">            <span class="number">493</span> <span class="number">0.020687</span> <span class="number">0.236857</span> <span class="number">0.393882</span>;...</span><br><span class="line">            <span class="number">494</span> <span class="number">0.017540</span> <span class="number">0.247481</span> <span class="number">0.372946</span>;...</span><br><span class="line">            <span class="number">495</span> <span class="number">0.014700</span> <span class="number">0.258600</span> <span class="number">0.353300</span>;...</span><br><span class="line">            <span class="number">496</span> <span class="number">0.012162</span> <span class="number">0.270185</span> <span class="number">0.334858</span>;...</span><br><span class="line">            <span class="number">497</span> <span class="number">0.009920</span> <span class="number">0.282294</span> <span class="number">0.317552</span>;...</span><br><span class="line">            <span class="number">498</span> <span class="number">0.007967</span> <span class="number">0.295050</span> <span class="number">0.301337</span>;...</span><br><span class="line">            <span class="number">499</span> <span class="number">0.006296</span> <span class="number">0.308578</span> <span class="number">0.286169</span>;...</span><br><span class="line">            <span class="number">500</span> <span class="number">0.004900</span> <span class="number">0.323000</span> <span class="number">0.272000</span>;...</span><br><span class="line">            <span class="number">501</span> <span class="number">0.003777</span> <span class="number">0.338402</span> <span class="number">0.258817</span>;...</span><br><span class="line">            <span class="number">502</span> <span class="number">0.002945</span> <span class="number">0.354686</span> <span class="number">0.246484</span>;...</span><br><span class="line">            <span class="number">503</span> <span class="number">0.002425</span> <span class="number">0.371699</span> <span class="number">0.234772</span>;...</span><br><span class="line">            <span class="number">504</span> <span class="number">0.002236</span> <span class="number">0.389288</span> <span class="number">0.223453</span>;...</span><br><span class="line">            <span class="number">505</span> <span class="number">0.002400</span> <span class="number">0.407300</span> <span class="number">0.212300</span>;...</span><br><span class="line">            <span class="number">506</span> <span class="number">0.002926</span> <span class="number">0.425630</span> <span class="number">0.201169</span>;...</span><br><span class="line">            <span class="number">507</span> <span class="number">0.003837</span> <span class="number">0.444310</span> <span class="number">0.190120</span>;...</span><br><span class="line">            <span class="number">508</span> <span class="number">0.005175</span> <span class="number">0.463394</span> <span class="number">0.179225</span>;...</span><br><span class="line">            <span class="number">509</span> <span class="number">0.006982</span> <span class="number">0.482940</span> <span class="number">0.168561</span>;...</span><br><span class="line">            <span class="number">510</span> <span class="number">0.009300</span> <span class="number">0.503000</span> <span class="number">0.158200</span>;...</span><br><span class="line">            <span class="number">511</span> <span class="number">0.012149</span> <span class="number">0.523569</span> <span class="number">0.148138</span>;...</span><br><span class="line">            <span class="number">512</span> <span class="number">0.015536</span> <span class="number">0.544512</span> <span class="number">0.138376</span>;...</span><br><span class="line">            <span class="number">513</span> <span class="number">0.019478</span> <span class="number">0.565690</span> <span class="number">0.128994</span>;...</span><br><span class="line">            <span class="number">514</span> <span class="number">0.023993</span> <span class="number">0.586965</span> <span class="number">0.120075</span>;...</span><br><span class="line">            <span class="number">515</span> <span class="number">0.029100</span> <span class="number">0.608200</span> <span class="number">0.111700</span>;...</span><br><span class="line">            <span class="number">516</span> <span class="number">0.034815</span> <span class="number">0.629346</span> <span class="number">0.103905</span>;...</span><br><span class="line">            <span class="number">517</span> <span class="number">0.041120</span> <span class="number">0.650307</span> <span class="number">0.096667</span>;...</span><br><span class="line">            <span class="number">518</span> <span class="number">0.047985</span> <span class="number">0.670875</span> <span class="number">0.089983</span>;...</span><br><span class="line">            <span class="number">519</span> <span class="number">0.055379</span> <span class="number">0.690842</span> <span class="number">0.083845</span>;...</span><br><span class="line">            <span class="number">520</span> <span class="number">0.063270</span> <span class="number">0.710000</span> <span class="number">0.078250</span>;...</span><br><span class="line">            <span class="number">521</span> <span class="number">0.071635</span> <span class="number">0.728185</span> <span class="number">0.073209</span>;...</span><br><span class="line">            <span class="number">522</span> <span class="number">0.080462</span> <span class="number">0.745464</span> <span class="number">0.068678</span>;...</span><br><span class="line">            <span class="number">523</span> <span class="number">0.089740</span> <span class="number">0.761969</span> <span class="number">0.064568</span>;...</span><br><span class="line">            <span class="number">524</span> <span class="number">0.099456</span> <span class="number">0.777837</span> <span class="number">0.060788</span>;...</span><br><span class="line">            <span class="number">525</span> <span class="number">0.109600</span> <span class="number">0.793200</span> <span class="number">0.057250</span>;...</span><br><span class="line">            <span class="number">526</span> <span class="number">0.120167</span> <span class="number">0.808110</span> <span class="number">0.053904</span>;...</span><br><span class="line">            <span class="number">527</span> <span class="number">0.131114</span> <span class="number">0.822496</span> <span class="number">0.050747</span>;...</span><br><span class="line">            <span class="number">528</span> <span class="number">0.142368</span> <span class="number">0.836307</span> <span class="number">0.047753</span>;...</span><br><span class="line">            <span class="number">529</span> <span class="number">0.153854</span> <span class="number">0.849492</span> <span class="number">0.044899</span>;...</span><br><span class="line">            <span class="number">530</span> <span class="number">0.165500</span> <span class="number">0.862000</span> <span class="number">0.042160</span>;...</span><br><span class="line">            <span class="number">531</span> <span class="number">0.177257</span> <span class="number">0.873811</span> <span class="number">0.039507</span>;...</span><br><span class="line">            <span class="number">532</span> <span class="number">0.189140</span> <span class="number">0.884962</span> <span class="number">0.036936</span>;...</span><br><span class="line">            <span class="number">533</span> <span class="number">0.201169</span> <span class="number">0.895494</span> <span class="number">0.034458</span>;...</span><br><span class="line">            <span class="number">534</span> <span class="number">0.213366</span> <span class="number">0.905443</span> <span class="number">0.032089</span>;...</span><br><span class="line">            <span class="number">535</span> <span class="number">0.225750</span> <span class="number">0.914850</span> <span class="number">0.029840</span>;...</span><br><span class="line">            <span class="number">536</span> <span class="number">0.238321</span> <span class="number">0.923735</span> <span class="number">0.027712</span>;...</span><br><span class="line">            <span class="number">537</span> <span class="number">0.251067</span> <span class="number">0.932092</span> <span class="number">0.025694</span>;...</span><br><span class="line">            <span class="number">538</span> <span class="number">0.263992</span> <span class="number">0.939923</span> <span class="number">0.023787</span>;...</span><br><span class="line">            <span class="number">539</span> <span class="number">0.277102</span> <span class="number">0.947225</span> <span class="number">0.021989</span>;...</span><br><span class="line">            <span class="number">540</span> <span class="number">0.290400</span> <span class="number">0.954000</span> <span class="number">0.020300</span>;...</span><br><span class="line">            <span class="number">541</span> <span class="number">0.303891</span> <span class="number">0.960256</span> <span class="number">0.018718</span>;...</span><br><span class="line">            <span class="number">542</span> <span class="number">0.317573</span> <span class="number">0.966007</span> <span class="number">0.017240</span>;...</span><br><span class="line">            <span class="number">543</span> <span class="number">0.331438</span> <span class="number">0.971261</span> <span class="number">0.015864</span>;...</span><br><span class="line">            <span class="number">544</span> <span class="number">0.345483</span> <span class="number">0.976023</span> <span class="number">0.014585</span>;...</span><br><span class="line">            <span class="number">545</span> <span class="number">0.359700</span> <span class="number">0.980300</span> <span class="number">0.013400</span>;...</span><br><span class="line">            <span class="number">546</span> <span class="number">0.374084</span> <span class="number">0.984092</span> <span class="number">0.012307</span>;...</span><br><span class="line">            <span class="number">547</span> <span class="number">0.388640</span> <span class="number">0.987418</span> <span class="number">0.011302</span>;...</span><br><span class="line">            <span class="number">548</span> <span class="number">0.403378</span> <span class="number">0.990313</span> <span class="number">0.010378</span>;...</span><br><span class="line">            <span class="number">549</span> <span class="number">0.418312</span> <span class="number">0.992812</span> <span class="number">0.009529</span>;...</span><br><span class="line">            <span class="number">550</span> <span class="number">0.433450</span> <span class="number">0.994950</span> <span class="number">0.008750</span>;...</span><br><span class="line">            <span class="number">551</span> <span class="number">0.448795</span> <span class="number">0.996711</span> <span class="number">0.008035</span>;...</span><br><span class="line">            <span class="number">552</span> <span class="number">0.464336</span> <span class="number">0.998098</span> <span class="number">0.007382</span>;...</span><br><span class="line">            <span class="number">553</span> <span class="number">0.480064</span> <span class="number">0.999112</span> <span class="number">0.006785</span>;...</span><br><span class="line">            <span class="number">554</span> <span class="number">0.495971</span> <span class="number">0.999748</span> <span class="number">0.006243</span>;...</span><br><span class="line">            <span class="number">555</span> <span class="number">0.512050</span> <span class="number">1.000000</span> <span class="number">0.005750</span>;...</span><br><span class="line">            <span class="number">556</span> <span class="number">0.528296</span> <span class="number">0.999857</span> <span class="number">0.005304</span>;...</span><br><span class="line">            <span class="number">557</span> <span class="number">0.544692</span> <span class="number">0.999305</span> <span class="number">0.004900</span>;...</span><br><span class="line">            <span class="number">558</span> <span class="number">0.561209</span> <span class="number">0.998325</span> <span class="number">0.004534</span>;...</span><br><span class="line">            <span class="number">559</span> <span class="number">0.577821</span> <span class="number">0.996899</span> <span class="number">0.004202</span>;...</span><br><span class="line">            <span class="number">560</span> <span class="number">0.594500</span> <span class="number">0.995000</span> <span class="number">0.003900</span>;...</span><br><span class="line">            <span class="number">561</span> <span class="number">0.611221</span> <span class="number">0.992601</span> <span class="number">0.003623</span>;...</span><br><span class="line">            <span class="number">562</span> <span class="number">0.627976</span> <span class="number">0.989743</span> <span class="number">0.003371</span>;...</span><br><span class="line">            <span class="number">563</span> <span class="number">0.644760</span> <span class="number">0.986444</span> <span class="number">0.003141</span>;...</span><br><span class="line">            <span class="number">564</span> <span class="number">0.661570</span> <span class="number">0.982724</span> <span class="number">0.002935</span>;...</span><br><span class="line">            <span class="number">565</span> <span class="number">0.678400</span> <span class="number">0.978600</span> <span class="number">0.002750</span>;...</span><br><span class="line">            <span class="number">566</span> <span class="number">0.695239</span> <span class="number">0.974084</span> <span class="number">0.002585</span>;...</span><br><span class="line">            <span class="number">567</span> <span class="number">0.712059</span> <span class="number">0.969171</span> <span class="number">0.002439</span>;...</span><br><span class="line">            <span class="number">568</span> <span class="number">0.728828</span> <span class="number">0.963857</span> <span class="number">0.002309</span>;...</span><br><span class="line">            <span class="number">569</span> <span class="number">0.745519</span> <span class="number">0.958135</span> <span class="number">0.002197</span>;...</span><br><span class="line">            <span class="number">570</span> <span class="number">0.762100</span> <span class="number">0.952000</span> <span class="number">0.002100</span>;...</span><br><span class="line">            <span class="number">571</span> <span class="number">0.778543</span> <span class="number">0.945450</span> <span class="number">0.002018</span>;...</span><br><span class="line">            <span class="number">572</span> <span class="number">0.794826</span> <span class="number">0.938499</span> <span class="number">0.001948</span>;...</span><br><span class="line">            <span class="number">573</span> <span class="number">0.810926</span> <span class="number">0.931163</span> <span class="number">0.001890</span>;...</span><br><span class="line">            <span class="number">574</span> <span class="number">0.826825</span> <span class="number">0.923458</span> <span class="number">0.001841</span>;...</span><br><span class="line">            <span class="number">575</span> <span class="number">0.842500</span> <span class="number">0.915400</span> <span class="number">0.001800</span>;...</span><br><span class="line">            <span class="number">576</span> <span class="number">0.857932</span> <span class="number">0.907006</span> <span class="number">0.001766</span>;...</span><br><span class="line">            <span class="number">577</span> <span class="number">0.873082</span> <span class="number">0.898277</span> <span class="number">0.001738</span>;...</span><br><span class="line">            <span class="number">578</span> <span class="number">0.887894</span> <span class="number">0.889205</span> <span class="number">0.001711</span>;...</span><br><span class="line">            <span class="number">579</span> <span class="number">0.902318</span> <span class="number">0.879782</span> <span class="number">0.001683</span>;...</span><br><span class="line">            <span class="number">580</span> <span class="number">0.916300</span> <span class="number">0.870000</span> <span class="number">0.001650</span>;...</span><br><span class="line">            <span class="number">581</span> <span class="number">0.929800</span> <span class="number">0.859861</span> <span class="number">0.001610</span>;...</span><br><span class="line">            <span class="number">582</span> <span class="number">0.942798</span> <span class="number">0.849392</span> <span class="number">0.001564</span>;...</span><br><span class="line">            <span class="number">583</span> <span class="number">0.955278</span> <span class="number">0.838622</span> <span class="number">0.001514</span>;...</span><br><span class="line">            <span class="number">584</span> <span class="number">0.967218</span> <span class="number">0.827581</span> <span class="number">0.001459</span>;...</span><br><span class="line">            <span class="number">585</span> <span class="number">0.978600</span> <span class="number">0.816300</span> <span class="number">0.001400</span>;...</span><br><span class="line">            <span class="number">586</span> <span class="number">0.989386</span> <span class="number">0.804795</span> <span class="number">0.001337</span>;...</span><br><span class="line">            <span class="number">587</span> <span class="number">0.999549</span> <span class="number">0.793082</span> <span class="number">0.001270</span>;...</span><br><span class="line">            <span class="number">588</span> <span class="number">1.009089</span> <span class="number">0.781192</span> <span class="number">0.001205</span>;...</span><br><span class="line">            <span class="number">589</span> <span class="number">1.018006</span> <span class="number">0.769155</span> <span class="number">0.001147</span>;...</span><br><span class="line">            <span class="number">590</span> <span class="number">1.026300</span> <span class="number">0.757000</span> <span class="number">0.001100</span>;...</span><br><span class="line">            <span class="number">591</span> <span class="number">1.033983</span> <span class="number">0.744754</span> <span class="number">0.001069</span>;...</span><br><span class="line">            <span class="number">592</span> <span class="number">1.040986</span> <span class="number">0.732422</span> <span class="number">0.001049</span>;...</span><br><span class="line">            <span class="number">593</span> <span class="number">1.047188</span> <span class="number">0.720004</span> <span class="number">0.001036</span>;...</span><br><span class="line">            <span class="number">594</span> <span class="number">1.052467</span> <span class="number">0.707496</span> <span class="number">0.001021</span>;...</span><br><span class="line">            <span class="number">595</span> <span class="number">1.056700</span> <span class="number">0.694900</span> <span class="number">0.001000</span>;...</span><br><span class="line">            <span class="number">596</span> <span class="number">1.059794</span> <span class="number">0.682219</span> <span class="number">0.000969</span>;...</span><br><span class="line">            <span class="number">597</span> <span class="number">1.061799</span> <span class="number">0.669472</span> <span class="number">0.000930</span>;...</span><br><span class="line">            <span class="number">598</span> <span class="number">1.062807</span> <span class="number">0.656674</span> <span class="number">0.000887</span>;...</span><br><span class="line">            <span class="number">599</span> <span class="number">1.062910</span> <span class="number">0.643845</span> <span class="number">0.000843</span>;...</span><br><span class="line">            <span class="number">600</span> <span class="number">1.062200</span> <span class="number">0.631000</span> <span class="number">0.000800</span>;...</span><br><span class="line">            <span class="number">601</span> <span class="number">1.060735</span> <span class="number">0.618155</span> <span class="number">0.000761</span>;...</span><br><span class="line">            <span class="number">602</span> <span class="number">1.058444</span> <span class="number">0.605314</span> <span class="number">0.000724</span>;...</span><br><span class="line">            <span class="number">603</span> <span class="number">1.055224</span> <span class="number">0.592476</span> <span class="number">0.000686</span>;...</span><br><span class="line">            <span class="number">604</span> <span class="number">1.050977</span> <span class="number">0.579638</span> <span class="number">0.000645</span>;...</span><br><span class="line">            <span class="number">605</span> <span class="number">1.045600</span> <span class="number">0.566800</span> <span class="number">0.000600</span>;...</span><br><span class="line">            <span class="number">606</span> <span class="number">1.039037</span> <span class="number">0.553961</span> <span class="number">0.000548</span>;...</span><br><span class="line">            <span class="number">607</span> <span class="number">1.031361</span> <span class="number">0.541137</span> <span class="number">0.000492</span>;...</span><br><span class="line">            <span class="number">608</span> <span class="number">1.022666</span> <span class="number">0.528353</span> <span class="number">0.000435</span>;...</span><br><span class="line">            <span class="number">609</span> <span class="number">1.013048</span> <span class="number">0.515632</span> <span class="number">0.000383</span>;...</span><br><span class="line">            <span class="number">610</span> <span class="number">1.002600</span> <span class="number">0.503000</span> <span class="number">0.000340</span>;...</span><br><span class="line">            <span class="number">611</span> <span class="number">0.991367</span> <span class="number">0.490469</span> <span class="number">0.000307</span>;...</span><br><span class="line">            <span class="number">612</span> <span class="number">0.979331</span> <span class="number">0.478030</span> <span class="number">0.000283</span>;...</span><br><span class="line">            <span class="number">613</span> <span class="number">0.966492</span> <span class="number">0.465678</span> <span class="number">0.000265</span>;...</span><br><span class="line">            <span class="number">614</span> <span class="number">0.952848</span> <span class="number">0.453403</span> <span class="number">0.000252</span>;...</span><br><span class="line">            <span class="number">615</span> <span class="number">0.938400</span> <span class="number">0.441200</span> <span class="number">0.000240</span>;...</span><br><span class="line">            <span class="number">616</span> <span class="number">0.923194</span> <span class="number">0.429080</span> <span class="number">0.000230</span>;...</span><br><span class="line">            <span class="number">617</span> <span class="number">0.907244</span> <span class="number">0.417036</span> <span class="number">0.000221</span>;...</span><br><span class="line">            <span class="number">618</span> <span class="number">0.890502</span> <span class="number">0.405032</span> <span class="number">0.000212</span>;...</span><br><span class="line">            <span class="number">619</span> <span class="number">0.872920</span> <span class="number">0.393032</span> <span class="number">0.000202</span>;...</span><br><span class="line">            <span class="number">620</span> <span class="number">0.854450</span> <span class="number">0.381000</span> <span class="number">0.000190</span>;...</span><br><span class="line">            <span class="number">621</span> <span class="number">0.835084</span> <span class="number">0.368918</span> <span class="number">0.000174</span>;...</span><br><span class="line">            <span class="number">622</span> <span class="number">0.814946</span> <span class="number">0.356827</span> <span class="number">0.000156</span>;...</span><br><span class="line">            <span class="number">623</span> <span class="number">0.794186</span> <span class="number">0.344777</span> <span class="number">0.000136</span>;...</span><br><span class="line">            <span class="number">624</span> <span class="number">0.772954</span> <span class="number">0.332818</span> <span class="number">0.000117</span>;...</span><br><span class="line">            <span class="number">625</span> <span class="number">0.751400</span> <span class="number">0.321000</span> <span class="number">0.000100</span>;...</span><br><span class="line">            <span class="number">626</span> <span class="number">0.729584</span> <span class="number">0.309338</span> <span class="number">0.000086</span>;...</span><br><span class="line">            <span class="number">627</span> <span class="number">0.707589</span> <span class="number">0.297850</span> <span class="number">0.000075</span>;...</span><br><span class="line">            <span class="number">628</span> <span class="number">0.685602</span> <span class="number">0.286594</span> <span class="number">0.000065</span>;...</span><br><span class="line">            <span class="number">629</span> <span class="number">0.663810</span> <span class="number">0.275624</span> <span class="number">0.000057</span>;...</span><br><span class="line">            <span class="number">630</span> <span class="number">0.642400</span> <span class="number">0.265000</span> <span class="number">0.000050</span>;...</span><br><span class="line">            <span class="number">631</span> <span class="number">0.621515</span> <span class="number">0.254763</span> <span class="number">0.000044</span>;...</span><br><span class="line">            <span class="number">632</span> <span class="number">0.601114</span> <span class="number">0.244890</span> <span class="number">0.000039</span>;...</span><br><span class="line">            <span class="number">633</span> <span class="number">0.581105</span> <span class="number">0.235334</span> <span class="number">0.000036</span>;...</span><br><span class="line">            <span class="number">634</span> <span class="number">0.561398</span> <span class="number">0.226053</span> <span class="number">0.000033</span>;...</span><br><span class="line">            <span class="number">635</span> <span class="number">0.541900</span> <span class="number">0.217000</span> <span class="number">0.000030</span>;...</span><br><span class="line">            <span class="number">636</span> <span class="number">0.522599</span> <span class="number">0.208162</span> <span class="number">0.000028</span>;...</span><br><span class="line">            <span class="number">637</span> <span class="number">0.503546</span> <span class="number">0.199549</span> <span class="number">0.000026</span>;...</span><br><span class="line">            <span class="number">638</span> <span class="number">0.484744</span> <span class="number">0.191155</span> <span class="number">0.000024</span>;...</span><br><span class="line">            <span class="number">639</span> <span class="number">0.466194</span> <span class="number">0.182974</span> <span class="number">0.000022</span>;...</span><br><span class="line">            <span class="number">640</span> <span class="number">0.447900</span> <span class="number">0.175000</span> <span class="number">0.000020</span>;...</span><br><span class="line">            <span class="number">641</span> <span class="number">0.429861</span> <span class="number">0.167224</span> <span class="number">0.000018</span>;...</span><br><span class="line">            <span class="number">642</span> <span class="number">0.412098</span> <span class="number">0.159646</span> <span class="number">0.000016</span>;...</span><br><span class="line">            <span class="number">643</span> <span class="number">0.394644</span> <span class="number">0.152278</span> <span class="number">0.000014</span>;...</span><br><span class="line">            <span class="number">644</span> <span class="number">0.377533</span> <span class="number">0.145126</span> <span class="number">0.000012</span>;...</span><br><span class="line">            <span class="number">645</span> <span class="number">0.360800</span> <span class="number">0.138200</span> <span class="number">0.000010</span>;...</span><br><span class="line">            <span class="number">646</span> <span class="number">0.344456</span> <span class="number">0.131500</span> <span class="number">0.000008</span>;...</span><br><span class="line">            <span class="number">647</span> <span class="number">0.328517</span> <span class="number">0.125025</span> <span class="number">0.000005</span>;...</span><br><span class="line">            <span class="number">648</span> <span class="number">0.313019</span> <span class="number">0.118779</span> <span class="number">0.000003</span>;...</span><br><span class="line">            <span class="number">649</span> <span class="number">0.298001</span> <span class="number">0.112769</span> <span class="number">0.000001</span>;...</span><br><span class="line">            <span class="number">650</span> <span class="number">0.283500</span> <span class="number">0.107000</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">651</span> <span class="number">0.269545</span> <span class="number">0.101476</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">652</span> <span class="number">0.256118</span> <span class="number">0.096189</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">653</span> <span class="number">0.243190</span> <span class="number">0.091123</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">654</span> <span class="number">0.230727</span> <span class="number">0.086265</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">655</span> <span class="number">0.218700</span> <span class="number">0.081600</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">656</span> <span class="number">0.207097</span> <span class="number">0.077121</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">657</span> <span class="number">0.195923</span> <span class="number">0.072826</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">658</span> <span class="number">0.185171</span> <span class="number">0.068710</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">659</span> <span class="number">0.174832</span> <span class="number">0.064770</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">660</span> <span class="number">0.164900</span> <span class="number">0.061000</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">661</span> <span class="number">0.155367</span> <span class="number">0.057396</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">662</span> <span class="number">0.146230</span> <span class="number">0.053955</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">663</span> <span class="number">0.137490</span> <span class="number">0.050674</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">664</span> <span class="number">0.129147</span> <span class="number">0.047550</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">665</span> <span class="number">0.121200</span> <span class="number">0.044580</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">666</span> <span class="number">0.113640</span> <span class="number">0.041759</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">667</span> <span class="number">0.106465</span> <span class="number">0.039085</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">668</span> <span class="number">0.099690</span> <span class="number">0.036564</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">669</span> <span class="number">0.093331</span> <span class="number">0.034200</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">670</span> <span class="number">0.087400</span> <span class="number">0.032000</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">671</span> <span class="number">0.081901</span> <span class="number">0.029963</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">672</span> <span class="number">0.076804</span> <span class="number">0.028077</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">673</span> <span class="number">0.072077</span> <span class="number">0.026329</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">674</span> <span class="number">0.067687</span> <span class="number">0.024708</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">675</span> <span class="number">0.063600</span> <span class="number">0.023200</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">676</span> <span class="number">0.059807</span> <span class="number">0.021801</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">677</span> <span class="number">0.056282</span> <span class="number">0.020501</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">678</span> <span class="number">0.052971</span> <span class="number">0.019281</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">679</span> <span class="number">0.049819</span> <span class="number">0.018121</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">680</span> <span class="number">0.046770</span> <span class="number">0.017000</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">681</span> <span class="number">0.043784</span> <span class="number">0.015904</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">682</span> <span class="number">0.040875</span> <span class="number">0.014837</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">683</span> <span class="number">0.038073</span> <span class="number">0.013811</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">684</span> <span class="number">0.035405</span> <span class="number">0.012835</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">685</span> <span class="number">0.032900</span> <span class="number">0.011920</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">686</span> <span class="number">0.030564</span> <span class="number">0.011068</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">687</span> <span class="number">0.028381</span> <span class="number">0.010273</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">688</span> <span class="number">0.026345</span> <span class="number">0.009533</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">689</span> <span class="number">0.024453</span> <span class="number">0.008846</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">690</span> <span class="number">0.022700</span> <span class="number">0.008210</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">691</span> <span class="number">0.021084</span> <span class="number">0.007624</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">692</span> <span class="number">0.019600</span> <span class="number">0.007085</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">693</span> <span class="number">0.018237</span> <span class="number">0.006591</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">694</span> <span class="number">0.016987</span> <span class="number">0.006138</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">695</span> <span class="number">0.015840</span> <span class="number">0.005723</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">696</span> <span class="number">0.014791</span> <span class="number">0.005343</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">697</span> <span class="number">0.013831</span> <span class="number">0.004996</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">698</span> <span class="number">0.012949</span> <span class="number">0.004676</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">699</span> <span class="number">0.012129</span> <span class="number">0.004380</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">700</span> <span class="number">0.011359</span> <span class="number">0.004102</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">701</span> <span class="number">0.010629</span> <span class="number">0.003838</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">702</span> <span class="number">0.009939</span> <span class="number">0.003589</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">703</span> <span class="number">0.009288</span> <span class="number">0.003354</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">704</span> <span class="number">0.008679</span> <span class="number">0.003134</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">705</span> <span class="number">0.008111</span> <span class="number">0.002929</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">706</span> <span class="number">0.007582</span> <span class="number">0.002738</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">707</span> <span class="number">0.007089</span> <span class="number">0.002560</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">708</span> <span class="number">0.006627</span> <span class="number">0.002393</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">709</span> <span class="number">0.006195</span> <span class="number">0.002237</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">710</span> <span class="number">0.005790</span> <span class="number">0.002091</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">711</span> <span class="number">0.005410</span> <span class="number">0.001954</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">712</span> <span class="number">0.005053</span> <span class="number">0.001825</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">713</span> <span class="number">0.004718</span> <span class="number">0.001704</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">714</span> <span class="number">0.004404</span> <span class="number">0.001590</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">715</span> <span class="number">0.004109</span> <span class="number">0.001484</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">716</span> <span class="number">0.003834</span> <span class="number">0.001384</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">717</span> <span class="number">0.003576</span> <span class="number">0.001291</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">718</span> <span class="number">0.003334</span> <span class="number">0.001204</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">719</span> <span class="number">0.003109</span> <span class="number">0.001123</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">720</span> <span class="number">0.002899</span> <span class="number">0.001047</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">721</span> <span class="number">0.002704</span> <span class="number">0.000977</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">722</span> <span class="number">0.002523</span> <span class="number">0.000911</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">723</span> <span class="number">0.002354</span> <span class="number">0.000850</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">724</span> <span class="number">0.002197</span> <span class="number">0.000793</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">725</span> <span class="number">0.002049</span> <span class="number">0.000740</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">726</span> <span class="number">0.001911</span> <span class="number">0.000690</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">727</span> <span class="number">0.001781</span> <span class="number">0.000643</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">728</span> <span class="number">0.001660</span> <span class="number">0.000599</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">729</span> <span class="number">0.001546</span> <span class="number">0.000558</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">730</span> <span class="number">0.001440</span> <span class="number">0.000520</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">731</span> <span class="number">0.001340</span> <span class="number">0.000484</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">732</span> <span class="number">0.001246</span> <span class="number">0.000450</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">733</span> <span class="number">0.001158</span> <span class="number">0.000418</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">734</span> <span class="number">0.001076</span> <span class="number">0.000389</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">735</span> <span class="number">0.001000</span> <span class="number">0.000361</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">736</span> <span class="number">0.000929</span> <span class="number">0.000335</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">737</span> <span class="number">0.000862</span> <span class="number">0.000311</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">738</span> <span class="number">0.000801</span> <span class="number">0.000289</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">739</span> <span class="number">0.000743</span> <span class="number">0.000268</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">740</span> <span class="number">0.000690</span> <span class="number">0.000249</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">741</span> <span class="number">0.000641</span> <span class="number">0.000231</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">742</span> <span class="number">0.000595</span> <span class="number">0.000215</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">743</span> <span class="number">0.000552</span> <span class="number">0.000199</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">744</span> <span class="number">0.000512</span> <span class="number">0.000185</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">745</span> <span class="number">0.000476</span> <span class="number">0.000172</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">746</span> <span class="number">0.000442</span> <span class="number">0.000160</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">747</span> <span class="number">0.000412</span> <span class="number">0.000149</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">748</span> <span class="number">0.000383</span> <span class="number">0.000138</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">749</span> <span class="number">0.000357</span> <span class="number">0.000129</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">750</span> <span class="number">0.000332</span> <span class="number">0.000120</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">751</span> <span class="number">0.000310</span> <span class="number">0.000112</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">752</span> <span class="number">0.000289</span> <span class="number">0.000104</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">753</span> <span class="number">0.000270</span> <span class="number">0.000097</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">754</span> <span class="number">0.000252</span> <span class="number">0.000091</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">755</span> <span class="number">0.000235</span> <span class="number">0.000085</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">756</span> <span class="number">0.000219</span> <span class="number">0.000079</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">757</span> <span class="number">0.000205</span> <span class="number">0.000074</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">758</span> <span class="number">0.000191</span> <span class="number">0.000069</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">759</span> <span class="number">0.000178</span> <span class="number">0.000064</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">760</span> <span class="number">0.000166</span> <span class="number">0.000060</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">761</span> <span class="number">0.000155</span> <span class="number">0.000056</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">762</span> <span class="number">0.000145</span> <span class="number">0.000052</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">763</span> <span class="number">0.000135</span> <span class="number">0.000049</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">764</span> <span class="number">0.000126</span> <span class="number">0.000045</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">765</span> <span class="number">0.000117</span> <span class="number">0.000042</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">766</span> <span class="number">0.000110</span> <span class="number">0.000040</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">767</span> <span class="number">0.000102</span> <span class="number">0.000037</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">768</span> <span class="number">0.000095</span> <span class="number">0.000034</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">769</span> <span class="number">0.000089</span> <span class="number">0.000032</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">770</span> <span class="number">0.000083</span> <span class="number">0.000030</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">771</span> <span class="number">0.000078</span> <span class="number">0.000028</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">772</span> <span class="number">0.000072</span> <span class="number">0.000026</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">773</span> <span class="number">0.000067</span> <span class="number">0.000024</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">774</span> <span class="number">0.000063</span> <span class="number">0.000023</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">775</span> <span class="number">0.000059</span> <span class="number">0.000021</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">776</span> <span class="number">0.000055</span> <span class="number">0.000020</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">777</span> <span class="number">0.000051</span> <span class="number">0.000018</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">778</span> <span class="number">0.000048</span> <span class="number">0.000017</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">779</span> <span class="number">0.000044</span> <span class="number">0.000016</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">780</span> <span class="number">0.000042</span> <span class="number">0.000015</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">781</span> <span class="number">0.000039</span> <span class="number">0.000014</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">782</span> <span class="number">0.000036</span> <span class="number">0.000013</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">783</span> <span class="number">0.000034</span> <span class="number">0.000012</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">784</span> <span class="number">0.000031</span> <span class="number">0.000011</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">785</span> <span class="number">0.000029</span> <span class="number">0.000011</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">786</span> <span class="number">0.000027</span> <span class="number">0.000010</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">787</span> <span class="number">0.000026</span> <span class="number">0.000009</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">788</span> <span class="number">0.000024</span> <span class="number">0.000009</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">789</span> <span class="number">0.000022</span> <span class="number">0.000008</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">790</span> <span class="number">0.000021</span> <span class="number">0.000007</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">791</span> <span class="number">0.000019</span> <span class="number">0.000007</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">792</span> <span class="number">0.000018</span> <span class="number">0.000006</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">793</span> <span class="number">0.000017</span> <span class="number">0.000006</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">794</span> <span class="number">0.000016</span> <span class="number">0.000006</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">795</span> <span class="number">0.000015</span> <span class="number">0.000005</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">796</span> <span class="number">0.000014</span> <span class="number">0.000005</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">797</span> <span class="number">0.000013</span> <span class="number">0.000005</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">798</span> <span class="number">0.000012</span> <span class="number">0.000004</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">799</span> <span class="number">0.000011</span> <span class="number">0.000004</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">800</span> <span class="number">0.000010</span> <span class="number">0.000004</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">801</span> <span class="number">0.000010</span> <span class="number">0.000003</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">802</span> <span class="number">0.000009</span> <span class="number">0.000003</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">803</span> <span class="number">0.000008</span> <span class="number">0.000003</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">804</span> <span class="number">0.000008</span> <span class="number">0.000003</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">805</span> <span class="number">0.000007</span> <span class="number">0.000003</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">806</span> <span class="number">0.000007</span> <span class="number">0.000002</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">807</span> <span class="number">0.000006</span> <span class="number">0.000002</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">808</span> <span class="number">0.000006</span> <span class="number">0.000002</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">809</span> <span class="number">0.000005</span> <span class="number">0.000002</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">810</span> <span class="number">0.000005</span> <span class="number">0.000002</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">811</span> <span class="number">0.000005</span> <span class="number">0.000002</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">812</span> <span class="number">0.000004</span> <span class="number">0.000002</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">813</span> <span class="number">0.000004</span> <span class="number">0.000001</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">814</span> <span class="number">0.000004</span> <span class="number">0.000001</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">815</span> <span class="number">0.000004</span> <span class="number">0.000001</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">816</span> <span class="number">0.000003</span> <span class="number">0.000001</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">817</span> <span class="number">0.000003</span> <span class="number">0.000001</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">818</span> <span class="number">0.000003</span> <span class="number">0.000001</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">819</span> <span class="number">0.000003</span> <span class="number">0.000001</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">820</span> <span class="number">0.000003</span> <span class="number">0.000001</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">821</span> <span class="number">0.000002</span> <span class="number">0.000001</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">822</span> <span class="number">0.000002</span> <span class="number">0.000001</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">823</span> <span class="number">0.000002</span> <span class="number">0.000001</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">824</span> <span class="number">0.000002</span> <span class="number">0.000001</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">825</span> <span class="number">0.000002</span> <span class="number">0.000001</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">826</span> <span class="number">0.000002</span> <span class="number">0.000001</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">827</span> <span class="number">0.000002</span> <span class="number">0.000001</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">828</span> <span class="number">0.000001</span> <span class="number">0.000001</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">829</span> <span class="number">0.000001</span> <span class="number">0.000000</span> <span class="number">0.000000</span>;...</span><br><span class="line">            <span class="number">830</span> <span class="number">0.000001</span> <span class="number">0.000000</span> <span class="number">0.000000</span>];</span><br><span class="line">        wavelength = CIE31Table(:,<span class="number">1</span>);</span><br><span class="line">        xbar = CIE31Table(:,<span class="number">2</span>);</span><br><span class="line">        ybar = CIE31Table(:,<span class="number">3</span>);</span><br><span class="line">        zbar = CIE31Table(:,<span class="number">4</span>);</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">% The spectral reflectance data of <span class="number">14</span> color test samples <span class="keyword">for</span> CRI</span><br><span class="line">% [wavelength (nm) TCS1 TCS2 TCS3 ... TCS14]</span><br><span class="line">TCS =  [<span class="number">360</span> <span class="number">116</span>  <span class="number">53</span>  <span class="number">58</span>  <span class="number">57</span> <span class="number">143</span>  <span class="number">79</span> <span class="number">150</span>  <span class="number">75</span>  <span class="number">69</span>  <span class="number">42</span>  <span class="number">74</span> <span class="number">189</span>  <span class="number">71</span>  <span class="number">36</span>;...</span><br><span class="line">        <span class="number">365</span> <span class="number">136</span>  <span class="number">55</span>  <span class="number">59</span>  <span class="number">59</span> <span class="number">187</span>  <span class="number">81</span> <span class="number">177</span>  <span class="number">78</span>  <span class="number">72</span>  <span class="number">43</span>  <span class="number">79</span> <span class="number">175</span>  <span class="number">76</span>  <span class="number">36</span>;...</span><br><span class="line">        <span class="number">370</span> <span class="number">159</span>  <span class="number">59</span>  <span class="number">61</span>  <span class="number">62</span> <span class="number">233</span>  <span class="number">89</span> <span class="number">218</span>  <span class="number">84</span>  <span class="number">73</span>  <span class="number">45</span>  <span class="number">86</span> <span class="number">158</span>  <span class="number">82</span>  <span class="number">36</span>;...</span><br><span class="line">        <span class="number">375</span> <span class="number">190</span>  <span class="number">64</span>  <span class="number">63</span>  <span class="number">67</span> <span class="number">269</span> <span class="number">113</span> <span class="number">293</span>  <span class="number">90</span>  <span class="number">70</span>  <span class="number">47</span>  <span class="number">98</span> <span class="number">139</span>  <span class="number">90</span>  <span class="number">36</span>;...</span><br><span class="line">        <span class="number">380</span> <span class="number">219</span>  <span class="number">70</span>  <span class="number">65</span>  <span class="number">74</span> <span class="number">295</span> <span class="number">151</span> <span class="number">378</span> <span class="number">104</span>  <span class="number">66</span>  <span class="number">50</span> <span class="number">111</span> <span class="number">120</span> <span class="number">104</span>  <span class="number">36</span>;...</span><br><span class="line">        <span class="number">385</span> <span class="number">239</span>  <span class="number">79</span>  <span class="number">68</span>  <span class="number">83</span> <span class="number">306</span> <span class="number">203</span> <span class="number">459</span> <span class="number">129</span>  <span class="number">62</span>  <span class="number">54</span> <span class="number">121</span> <span class="number">103</span> <span class="number">127</span>  <span class="number">36</span>;...</span><br><span class="line">        <span class="number">390</span> <span class="number">252</span>  <span class="number">89</span>  <span class="number">70</span>  <span class="number">93</span> <span class="number">310</span> <span class="number">265</span> <span class="number">524</span> <span class="number">170</span>  <span class="number">58</span>  <span class="number">59</span> <span class="number">127</span>  <span class="number">90</span> <span class="number">161</span>  <span class="number">37</span>;...</span><br><span class="line">        <span class="number">395</span> <span class="number">256</span> <span class="number">101</span>  <span class="number">72</span> <span class="number">105</span> <span class="number">312</span> <span class="number">339</span> <span class="number">546</span> <span class="number">240</span>  <span class="number">55</span>  <span class="number">63</span> <span class="number">129</span>  <span class="number">82</span> <span class="number">211</span>  <span class="number">38</span>;...</span><br><span class="line">        <span class="number">400</span> <span class="number">256</span> <span class="number">111</span>  <span class="number">73</span> <span class="number">116</span> <span class="number">313</span> <span class="number">410</span> <span class="number">551</span> <span class="number">319</span>  <span class="number">52</span>  <span class="number">66</span> <span class="number">127</span>  <span class="number">76</span> <span class="number">264</span>  <span class="number">39</span>;...</span><br><span class="line">        <span class="number">405</span> <span class="number">254</span> <span class="number">116</span>  <span class="number">73</span> <span class="number">121</span> <span class="number">315</span> <span class="number">464</span> <span class="number">555</span> <span class="number">416</span>  <span class="number">52</span>  <span class="number">67</span> <span class="number">121</span>  <span class="number">68</span> <span class="number">313</span>  <span class="number">39</span>;...</span><br><span class="line">        <span class="number">410</span> <span class="number">252</span> <span class="number">118</span>  <span class="number">74</span> <span class="number">124</span> <span class="number">319</span> <span class="number">492</span> <span class="number">559</span> <span class="number">462</span>  <span class="number">51</span>  <span class="number">68</span> <span class="number">116</span>  <span class="number">64</span> <span class="number">341</span>  <span class="number">40</span>;...</span><br><span class="line">        <span class="number">415</span> <span class="number">248</span> <span class="number">120</span>  <span class="number">74</span> <span class="number">126</span> <span class="number">322</span> <span class="number">508</span> <span class="number">560</span> <span class="number">482</span>  <span class="number">50</span>  <span class="number">69</span> <span class="number">112</span>  <span class="number">65</span> <span class="number">352</span>  <span class="number">41</span>;...</span><br><span class="line">        <span class="number">420</span> <span class="number">244</span> <span class="number">121</span>  <span class="number">74</span> <span class="number">128</span> <span class="number">326</span> <span class="number">517</span> <span class="number">561</span> <span class="number">490</span>  <span class="number">50</span>  <span class="number">69</span> <span class="number">108</span>  <span class="number">75</span> <span class="number">359</span>  <span class="number">42</span>;...</span><br><span class="line">        <span class="number">425</span> <span class="number">240</span> <span class="number">122</span>  <span class="number">73</span> <span class="number">131</span> <span class="number">330</span> <span class="number">524</span> <span class="number">558</span> <span class="number">488</span>  <span class="number">49</span>  <span class="number">70</span> <span class="number">105</span>  <span class="number">93</span> <span class="number">361</span>  <span class="number">42</span>;...</span><br><span class="line">        <span class="number">430</span> <span class="number">237</span> <span class="number">122</span>  <span class="number">73</span> <span class="number">135</span> <span class="number">334</span> <span class="number">531</span> <span class="number">556</span> <span class="number">482</span>  <span class="number">48</span>  <span class="number">72</span> <span class="number">104</span> <span class="number">123</span> <span class="number">364</span>  <span class="number">43</span>;...</span><br><span class="line">        <span class="number">435</span> <span class="number">232</span> <span class="number">122</span>  <span class="number">73</span> <span class="number">139</span> <span class="number">339</span> <span class="number">538</span> <span class="number">551</span> <span class="number">473</span>  <span class="number">47</span>  <span class="number">73</span> <span class="number">104</span> <span class="number">160</span> <span class="number">365</span>  <span class="number">44</span>;...</span><br><span class="line">        <span class="number">440</span> <span class="number">230</span> <span class="number">123</span>  <span class="number">73</span> <span class="number">144</span> <span class="number">346</span> <span class="number">544</span> <span class="number">544</span> <span class="number">462</span>  <span class="number">46</span>  <span class="number">76</span> <span class="number">105</span> <span class="number">207</span> <span class="number">367</span>  <span class="number">44</span>;...</span><br><span class="line">        <span class="number">445</span> <span class="number">226</span> <span class="number">124</span>  <span class="number">73</span> <span class="number">151</span> <span class="number">352</span> <span class="number">551</span> <span class="number">535</span> <span class="number">450</span>  <span class="number">44</span>  <span class="number">78</span> <span class="number">106</span> <span class="number">256</span> <span class="number">369</span>  <span class="number">45</span>;...</span><br><span class="line">        <span class="number">450</span> <span class="number">225</span> <span class="number">127</span>  <span class="number">74</span> <span class="number">161</span> <span class="number">360</span> <span class="number">556</span> <span class="number">522</span> <span class="number">439</span>  <span class="number">42</span>  <span class="number">83</span> <span class="number">110</span> <span class="number">300</span> <span class="number">372</span>  <span class="number">45</span>;...</span><br><span class="line">        <span class="number">455</span> <span class="number">222</span> <span class="number">128</span>  <span class="number">75</span> <span class="number">172</span> <span class="number">369</span> <span class="number">556</span> <span class="number">506</span> <span class="number">426</span>  <span class="number">41</span>  <span class="number">88</span> <span class="number">115</span> <span class="number">331</span> <span class="number">374</span>  <span class="number">46</span>;...</span><br><span class="line">        <span class="number">460</span> <span class="number">220</span> <span class="number">131</span>  <span class="number">77</span> <span class="number">186</span> <span class="number">381</span> <span class="number">554</span> <span class="number">488</span> <span class="number">413</span>  <span class="number">38</span>  <span class="number">95</span> <span class="number">123</span> <span class="number">346</span> <span class="number">376</span>  <span class="number">47</span>;...</span><br><span class="line">        <span class="number">465</span> <span class="number">218</span> <span class="number">134</span>  <span class="number">80</span> <span class="number">205</span> <span class="number">394</span> <span class="number">549</span> <span class="number">469</span> <span class="number">397</span>  <span class="number">35</span> <span class="number">103</span> <span class="number">134</span> <span class="number">347</span> <span class="number">379</span>  <span class="number">48</span>;...</span><br><span class="line">        <span class="number">470</span> <span class="number">216</span> <span class="number">138</span>  <span class="number">85</span> <span class="number">229</span> <span class="number">403</span> <span class="number">541</span> <span class="number">448</span> <span class="number">382</span>  <span class="number">33</span> <span class="number">113</span> <span class="number">148</span> <span class="number">341</span> <span class="number">384</span>  <span class="number">50</span>;...</span><br><span class="line">        <span class="number">475</span> <span class="number">214</span> <span class="number">143</span>  <span class="number">94</span> <span class="number">254</span> <span class="number">410</span> <span class="number">531</span> <span class="number">429</span> <span class="number">366</span>  <span class="number">31</span> <span class="number">125</span> <span class="number">167</span> <span class="number">328</span> <span class="number">389</span>  <span class="number">52</span>;...</span><br><span class="line">        <span class="number">480</span> <span class="number">214</span> <span class="number">150</span> <span class="number">109</span> <span class="number">281</span> <span class="number">415</span> <span class="number">519</span> <span class="number">408</span> <span class="number">352</span>  <span class="number">30</span> <span class="number">142</span> <span class="number">192</span> <span class="number">307</span> <span class="number">397</span>  <span class="number">55</span>;...</span><br><span class="line">        <span class="number">485</span> <span class="number">214</span> <span class="number">159</span> <span class="number">126</span> <span class="number">308</span> <span class="number">418</span> <span class="number">504</span> <span class="number">385</span> <span class="number">337</span>  <span class="number">29</span> <span class="number">162</span> <span class="number">219</span> <span class="number">282</span> <span class="number">405</span>  <span class="number">57</span>;...</span><br><span class="line">        <span class="number">490</span> <span class="number">216</span> <span class="number">174</span> <span class="number">148</span> <span class="number">332</span> <span class="number">419</span> <span class="number">488</span> <span class="number">363</span> <span class="number">325</span>  <span class="number">28</span> <span class="number">189</span> <span class="number">252</span> <span class="number">257</span> <span class="number">416</span>  <span class="number">62</span>;...</span><br><span class="line">        <span class="number">495</span> <span class="number">218</span> <span class="number">190</span> <span class="number">172</span> <span class="number">352</span> <span class="number">417</span> <span class="number">469</span> <span class="number">341</span> <span class="number">310</span>  <span class="number">28</span> <span class="number">219</span> <span class="number">291</span> <span class="number">230</span> <span class="number">429</span>  <span class="number">67</span>;...</span><br><span class="line">        <span class="number">500</span> <span class="number">223</span> <span class="number">207</span> <span class="number">198</span> <span class="number">370</span> <span class="number">413</span> <span class="number">450</span> <span class="number">324</span> <span class="number">299</span>  <span class="number">28</span> <span class="number">262</span> <span class="number">325</span> <span class="number">204</span> <span class="number">443</span>  <span class="number">75</span>;...</span><br><span class="line">        <span class="number">505</span> <span class="number">225</span> <span class="number">225</span> <span class="number">221</span> <span class="number">383</span> <span class="number">409</span> <span class="number">431</span> <span class="number">311</span> <span class="number">289</span>  <span class="number">29</span> <span class="number">305</span> <span class="number">347</span> <span class="number">178</span> <span class="number">454</span>  <span class="number">83</span>;...</span><br><span class="line">        <span class="number">510</span> <span class="number">226</span> <span class="number">242</span> <span class="number">241</span> <span class="number">390</span> <span class="number">403</span> <span class="number">414</span> <span class="number">301</span> <span class="number">283</span>  <span class="number">30</span> <span class="number">365</span> <span class="number">356</span> <span class="number">154</span> <span class="number">461</span>  <span class="number">92</span>;...</span><br><span class="line">        <span class="number">515</span> <span class="number">226</span> <span class="number">253</span> <span class="number">260</span> <span class="number">394</span> <span class="number">396</span> <span class="number">395</span> <span class="number">291</span> <span class="number">276</span>  <span class="number">30</span> <span class="number">416</span> <span class="number">353</span> <span class="number">129</span> <span class="number">466</span> <span class="number">100</span>;...</span><br><span class="line">        <span class="number">520</span> <span class="number">225</span> <span class="number">260</span> <span class="number">278</span> <span class="number">395</span> <span class="number">389</span> <span class="number">377</span> <span class="number">283</span> <span class="number">270</span>  <span class="number">31</span> <span class="number">465</span> <span class="number">346</span> <span class="number">109</span> <span class="number">469</span> <span class="number">108</span>;...</span><br><span class="line">        <span class="number">525</span> <span class="number">225</span> <span class="number">264</span> <span class="number">302</span> <span class="number">392</span> <span class="number">381</span> <span class="number">358</span> <span class="number">273</span> <span class="number">262</span>  <span class="number">31</span> <span class="number">509</span> <span class="number">333</span>  <span class="number">90</span> <span class="number">471</span> <span class="number">121</span>;...</span><br><span class="line">        <span class="number">530</span> <span class="number">227</span> <span class="number">267</span> <span class="number">339</span> <span class="number">385</span> <span class="number">372</span> <span class="number">341</span> <span class="number">265</span> <span class="number">256</span>  <span class="number">32</span> <span class="number">546</span> <span class="number">314</span>  <span class="number">75</span> <span class="number">474</span> <span class="number">133</span>;...</span><br><span class="line">        <span class="number">535</span> <span class="number">230</span> <span class="number">269</span> <span class="number">370</span> <span class="number">377</span> <span class="number">363</span> <span class="number">325</span> <span class="number">260</span> <span class="number">251</span>  <span class="number">32</span> <span class="number">581</span> <span class="number">294</span>  <span class="number">62</span> <span class="number">476</span> <span class="number">142</span>;...</span><br><span class="line">        <span class="number">540</span> <span class="number">236</span> <span class="number">272</span> <span class="number">392</span> <span class="number">367</span> <span class="number">353</span> <span class="number">309</span> <span class="number">257</span> <span class="number">250</span>  <span class="number">33</span> <span class="number">610</span> <span class="number">271</span>  <span class="number">51</span> <span class="number">483</span> <span class="number">150</span>;...</span><br><span class="line">        <span class="number">545</span> <span class="number">245</span> <span class="number">276</span> <span class="number">399</span> <span class="number">354</span> <span class="number">342</span> <span class="number">293</span> <span class="number">257</span> <span class="number">251</span>  <span class="number">34</span> <span class="number">634</span> <span class="number">248</span>  <span class="number">41</span> <span class="number">490</span> <span class="number">154</span>;...</span><br><span class="line">        <span class="number">550</span> <span class="number">253</span> <span class="number">282</span> <span class="number">400</span> <span class="number">341</span> <span class="number">331</span> <span class="number">279</span> <span class="number">259</span> <span class="number">254</span>  <span class="number">35</span> <span class="number">653</span> <span class="number">227</span>  <span class="number">35</span> <span class="number">506</span> <span class="number">155</span>;...</span><br><span class="line">        <span class="number">555</span> <span class="number">262</span> <span class="number">289</span> <span class="number">393</span> <span class="number">327</span> <span class="number">320</span> <span class="number">265</span> <span class="number">260</span> <span class="number">258</span>  <span class="number">37</span> <span class="number">666</span> <span class="number">206</span>  <span class="number">29</span> <span class="number">526</span> <span class="number">152</span>;...</span><br><span class="line">        <span class="number">560</span> <span class="number">272</span> <span class="number">299</span> <span class="number">380</span> <span class="number">312</span> <span class="number">308</span> <span class="number">253</span> <span class="number">260</span> <span class="number">264</span>  <span class="number">41</span> <span class="number">678</span> <span class="number">188</span>  <span class="number">25</span> <span class="number">553</span> <span class="number">147</span>;...</span><br><span class="line">        <span class="number">565</span> <span class="number">283</span> <span class="number">309</span> <span class="number">365</span> <span class="number">296</span> <span class="number">296</span> <span class="number">241</span> <span class="number">258</span> <span class="number">269</span>  <span class="number">44</span> <span class="number">687</span> <span class="number">170</span>  <span class="number">22</span> <span class="number">582</span> <span class="number">140</span>;...</span><br><span class="line">        <span class="number">570</span> <span class="number">298</span> <span class="number">322</span> <span class="number">349</span> <span class="number">280</span> <span class="number">284</span> <span class="number">234</span> <span class="number">256</span> <span class="number">272</span>  <span class="number">48</span> <span class="number">693</span> <span class="number">153</span>  <span class="number">19</span> <span class="number">618</span> <span class="number">133</span>;...</span><br><span class="line">        <span class="number">575</span> <span class="number">318</span> <span class="number">329</span> <span class="number">332</span> <span class="number">263</span> <span class="number">271</span> <span class="number">227</span> <span class="number">254</span> <span class="number">274</span>  <span class="number">52</span> <span class="number">698</span> <span class="number">138</span>  <span class="number">17</span> <span class="number">651</span> <span class="number">125</span>;...</span><br><span class="line">        <span class="number">580</span> <span class="number">341</span> <span class="number">335</span> <span class="number">315</span> <span class="number">247</span> <span class="number">260</span> <span class="number">225</span> <span class="number">254</span> <span class="number">278</span>  <span class="number">60</span> <span class="number">701</span> <span class="number">125</span>  <span class="number">17</span> <span class="number">680</span> <span class="number">118</span>;...</span><br><span class="line">        <span class="number">585</span> <span class="number">367</span> <span class="number">339</span> <span class="number">299</span> <span class="number">229</span> <span class="number">247</span> <span class="number">222</span> <span class="number">259</span> <span class="number">284</span>  <span class="number">76</span> <span class="number">704</span> <span class="number">114</span>  <span class="number">17</span> <span class="number">701</span> <span class="number">112</span>;...</span><br><span class="line">        <span class="number">590</span> <span class="number">390</span> <span class="number">341</span> <span class="number">285</span> <span class="number">214</span> <span class="number">232</span> <span class="number">221</span> <span class="number">270</span> <span class="number">295</span> <span class="number">102</span> <span class="number">705</span> <span class="number">106</span>  <span class="number">16</span> <span class="number">717</span> <span class="number">106</span>;...</span><br><span class="line">        <span class="number">595</span> <span class="number">409</span> <span class="number">341</span> <span class="number">272</span> <span class="number">198</span> <span class="number">220</span> <span class="number">220</span> <span class="number">284</span> <span class="number">316</span> <span class="number">136</span> <span class="number">705</span> <span class="number">100</span>  <span class="number">16</span> <span class="number">729</span> <span class="number">101</span>;...</span><br><span class="line">        <span class="number">600</span> <span class="number">424</span> <span class="number">342</span> <span class="number">264</span> <span class="number">185</span> <span class="number">210</span> <span class="number">220</span> <span class="number">302</span> <span class="number">348</span> <span class="number">190</span> <span class="number">706</span>  <span class="number">96</span>  <span class="number">16</span> <span class="number">736</span>  <span class="number">98</span>;...</span><br><span class="line">        <span class="number">605</span> <span class="number">435</span> <span class="number">342</span> <span class="number">257</span> <span class="number">175</span> <span class="number">200</span> <span class="number">220</span> <span class="number">324</span> <span class="number">384</span> <span class="number">256</span> <span class="number">707</span>  <span class="number">92</span>  <span class="number">16</span> <span class="number">742</span>  <span class="number">95</span>;...</span><br><span class="line">        <span class="number">610</span> <span class="number">442</span> <span class="number">342</span> <span class="number">252</span> <span class="number">169</span> <span class="number">194</span> <span class="number">220</span> <span class="number">344</span> <span class="number">434</span> <span class="number">336</span> <span class="number">707</span>  <span class="number">90</span>  <span class="number">16</span> <span class="number">745</span>  <span class="number">93</span>;...</span><br><span class="line">        <span class="number">615</span> <span class="number">448</span> <span class="number">341</span> <span class="number">247</span> <span class="number">164</span> <span class="number">189</span> <span class="number">220</span> <span class="number">362</span> <span class="number">482</span> <span class="number">418</span> <span class="number">707</span>  <span class="number">87</span>  <span class="number">16</span> <span class="number">747</span>  <span class="number">90</span>;...</span><br><span class="line">        <span class="number">620</span> <span class="number">450</span> <span class="number">341</span> <span class="number">241</span> <span class="number">160</span> <span class="number">185</span> <span class="number">223</span> <span class="number">377</span> <span class="number">528</span> <span class="number">505</span> <span class="number">708</span>  <span class="number">85</span>  <span class="number">16</span> <span class="number">748</span>  <span class="number">89</span>;...</span><br><span class="line">        <span class="number">625</span> <span class="number">451</span> <span class="number">339</span> <span class="number">235</span> <span class="number">156</span> <span class="number">183</span> <span class="number">227</span> <span class="number">389</span> <span class="number">568</span> <span class="number">581</span> <span class="number">708</span>  <span class="number">82</span>  <span class="number">16</span> <span class="number">748</span>  <span class="number">87</span>;...</span><br><span class="line">        <span class="number">630</span> <span class="number">451</span> <span class="number">339</span> <span class="number">229</span> <span class="number">154</span> <span class="number">180</span> <span class="number">233</span> <span class="number">400</span> <span class="number">604</span> <span class="number">641</span> <span class="number">710</span>  <span class="number">80</span>  <span class="number">18</span> <span class="number">748</span>  <span class="number">86</span>;...</span><br><span class="line">        <span class="number">635</span> <span class="number">451</span> <span class="number">338</span> <span class="number">224</span> <span class="number">152</span> <span class="number">177</span> <span class="number">239</span> <span class="number">410</span> <span class="number">629</span> <span class="number">682</span> <span class="number">711</span>  <span class="number">79</span>  <span class="number">18</span> <span class="number">748</span>  <span class="number">85</span>;...</span><br><span class="line">        <span class="number">640</span> <span class="number">451</span> <span class="number">338</span> <span class="number">220</span> <span class="number">151</span> <span class="number">176</span> <span class="number">244</span> <span class="number">420</span> <span class="number">648</span> <span class="number">717</span> <span class="number">712</span>  <span class="number">78</span>  <span class="number">18</span> <span class="number">748</span>  <span class="number">84</span>;...</span><br><span class="line">        <span class="number">645</span> <span class="number">451</span> <span class="number">337</span> <span class="number">217</span> <span class="number">149</span> <span class="number">175</span> <span class="number">251</span> <span class="number">429</span> <span class="number">663</span> <span class="number">740</span> <span class="number">714</span>  <span class="number">78</span>  <span class="number">18</span> <span class="number">748</span>  <span class="number">84</span>;...</span><br><span class="line">        <span class="number">650</span> <span class="number">450</span> <span class="number">336</span> <span class="number">216</span> <span class="number">148</span> <span class="number">175</span> <span class="number">258</span> <span class="number">438</span> <span class="number">676</span> <span class="number">758</span> <span class="number">716</span>  <span class="number">78</span>  <span class="number">19</span> <span class="number">748</span>  <span class="number">84</span>;...</span><br><span class="line">        <span class="number">655</span> <span class="number">450</span> <span class="number">335</span> <span class="number">216</span> <span class="number">148</span> <span class="number">175</span> <span class="number">263</span> <span class="number">445</span> <span class="number">685</span> <span class="number">770</span> <span class="number">718</span>  <span class="number">78</span>  <span class="number">20</span> <span class="number">748</span>  <span class="number">84</span>;...</span><br><span class="line">        <span class="number">660</span> <span class="number">451</span> <span class="number">334</span> <span class="number">219</span> <span class="number">148</span> <span class="number">175</span> <span class="number">268</span> <span class="number">452</span> <span class="number">693</span> <span class="number">781</span> <span class="number">720</span>  <span class="number">81</span>  <span class="number">23</span> <span class="number">747</span>  <span class="number">85</span>;...</span><br><span class="line">        <span class="number">665</span> <span class="number">451</span> <span class="number">332</span> <span class="number">224</span> <span class="number">149</span> <span class="number">177</span> <span class="number">273</span> <span class="number">457</span> <span class="number">700</span> <span class="number">790</span> <span class="number">722</span>  <span class="number">83</span>  <span class="number">24</span> <span class="number">747</span>  <span class="number">87</span>;...</span><br><span class="line">        <span class="number">670</span> <span class="number">453</span> <span class="number">332</span> <span class="number">230</span> <span class="number">151</span> <span class="number">180</span> <span class="number">278</span> <span class="number">462</span> <span class="number">705</span> <span class="number">797</span> <span class="number">725</span>  <span class="number">88</span>  <span class="number">26</span> <span class="number">747</span>  <span class="number">92</span>;...</span><br><span class="line">        <span class="number">675</span> <span class="number">454</span> <span class="number">331</span> <span class="number">238</span> <span class="number">154</span> <span class="number">183</span> <span class="number">281</span> <span class="number">466</span> <span class="number">709</span> <span class="number">803</span> <span class="number">729</span>  <span class="number">93</span>  <span class="number">30</span> <span class="number">747</span>  <span class="number">96</span>;...</span><br><span class="line">        <span class="number">680</span> <span class="number">455</span> <span class="number">331</span> <span class="number">251</span> <span class="number">158</span> <span class="number">186</span> <span class="number">283</span> <span class="number">468</span> <span class="number">712</span> <span class="number">809</span> <span class="number">731</span> <span class="number">102</span>  <span class="number">35</span> <span class="number">747</span> <span class="number">102</span>;...</span><br><span class="line">        <span class="number">685</span> <span class="number">457</span> <span class="number">330</span> <span class="number">269</span> <span class="number">162</span> <span class="number">189</span> <span class="number">286</span> <span class="number">470</span> <span class="number">715</span> <span class="number">814</span> <span class="number">735</span> <span class="number">112</span>  <span class="number">43</span> <span class="number">747</span> <span class="number">110</span>;...</span><br><span class="line">        <span class="number">690</span> <span class="number">458</span> <span class="number">329</span> <span class="number">288</span> <span class="number">165</span> <span class="number">192</span> <span class="number">291</span> <span class="number">473</span> <span class="number">717</span> <span class="number">819</span> <span class="number">739</span> <span class="number">125</span>  <span class="number">56</span> <span class="number">747</span> <span class="number">123</span>;...</span><br><span class="line">        <span class="number">695</span> <span class="number">460</span> <span class="number">328</span> <span class="number">312</span> <span class="number">168</span> <span class="number">195</span> <span class="number">296</span> <span class="number">477</span> <span class="number">719</span> <span class="number">824</span> <span class="number">742</span> <span class="number">141</span>  <span class="number">74</span> <span class="number">746</span> <span class="number">137</span>;...</span><br><span class="line">        <span class="number">700</span> <span class="number">462</span> <span class="number">328</span> <span class="number">340</span> <span class="number">170</span> <span class="number">199</span> <span class="number">302</span> <span class="number">483</span> <span class="number">721</span> <span class="number">828</span> <span class="number">746</span> <span class="number">161</span>  <span class="number">97</span> <span class="number">746</span> <span class="number">152</span>;...</span><br><span class="line">        <span class="number">705</span> <span class="number">463</span> <span class="number">327</span> <span class="number">366</span> <span class="number">171</span> <span class="number">200</span> <span class="number">313</span> <span class="number">489</span> <span class="number">720</span> <span class="number">830</span> <span class="number">748</span> <span class="number">182</span> <span class="number">128</span> <span class="number">746</span> <span class="number">169</span>;...</span><br><span class="line">        <span class="number">710</span> <span class="number">464</span> <span class="number">326</span> <span class="number">390</span> <span class="number">170</span> <span class="number">199</span> <span class="number">325</span> <span class="number">496</span> <span class="number">719</span> <span class="number">831</span> <span class="number">749</span> <span class="number">203</span> <span class="number">166</span> <span class="number">745</span> <span class="number">188</span>;...</span><br><span class="line">        <span class="number">715</span> <span class="number">465</span> <span class="number">325</span> <span class="number">412</span> <span class="number">168</span> <span class="number">198</span> <span class="number">338</span> <span class="number">503</span> <span class="number">722</span> <span class="number">833</span> <span class="number">751</span> <span class="number">223</span> <span class="number">210</span> <span class="number">744</span> <span class="number">207</span>;...</span><br><span class="line">        <span class="number">720</span> <span class="number">466</span> <span class="number">324</span> <span class="number">431</span> <span class="number">166</span> <span class="number">196</span> <span class="number">351</span> <span class="number">511</span> <span class="number">725</span> <span class="number">835</span> <span class="number">753</span> <span class="number">242</span> <span class="number">257</span> <span class="number">743</span> <span class="number">226</span>;...</span><br><span class="line">        <span class="number">725</span> <span class="number">466</span> <span class="number">324</span> <span class="number">447</span> <span class="number">164</span> <span class="number">195</span> <span class="number">364</span> <span class="number">518</span> <span class="number">727</span> <span class="number">836</span> <span class="number">754</span> <span class="number">257</span> <span class="number">305</span> <span class="number">744</span> <span class="number">243</span>;...</span><br><span class="line">        <span class="number">730</span> <span class="number">466</span> <span class="number">324</span> <span class="number">460</span> <span class="number">164</span> <span class="number">195</span> <span class="number">376</span> <span class="number">525</span> <span class="number">729</span> <span class="number">836</span> <span class="number">755</span> <span class="number">270</span> <span class="number">354</span> <span class="number">745</span> <span class="number">260</span>;...</span><br><span class="line">        <span class="number">735</span> <span class="number">466</span> <span class="number">323</span> <span class="number">472</span> <span class="number">165</span> <span class="number">196</span> <span class="number">389</span> <span class="number">532</span> <span class="number">730</span> <span class="number">837</span> <span class="number">755</span> <span class="number">282</span> <span class="number">401</span> <span class="number">748</span> <span class="number">277</span>;...</span><br><span class="line">        <span class="number">740</span> <span class="number">467</span> <span class="number">322</span> <span class="number">481</span> <span class="number">168</span> <span class="number">197</span> <span class="number">401</span> <span class="number">539</span> <span class="number">730</span> <span class="number">838</span> <span class="number">755</span> <span class="number">292</span> <span class="number">446</span> <span class="number">750</span> <span class="number">294</span>;...</span><br><span class="line">        <span class="number">745</span> <span class="number">467</span> <span class="number">321</span> <span class="number">488</span> <span class="number">172</span> <span class="number">200</span> <span class="number">413</span> <span class="number">546</span> <span class="number">730</span> <span class="number">839</span> <span class="number">755</span> <span class="number">302</span> <span class="number">485</span> <span class="number">750</span> <span class="number">310</span>;...</span><br><span class="line">        <span class="number">750</span> <span class="number">467</span> <span class="number">320</span> <span class="number">493</span> <span class="number">177</span> <span class="number">203</span> <span class="number">425</span> <span class="number">553</span> <span class="number">730</span> <span class="number">839</span> <span class="number">756</span> <span class="number">310</span> <span class="number">520</span> <span class="number">749</span> <span class="number">325</span>;...</span><br><span class="line">        <span class="number">755</span> <span class="number">467</span> <span class="number">318</span> <span class="number">497</span> <span class="number">181</span> <span class="number">205</span> <span class="number">436</span> <span class="number">559</span> <span class="number">730</span> <span class="number">839</span> <span class="number">757</span> <span class="number">314</span> <span class="number">551</span> <span class="number">748</span> <span class="number">339</span>;...</span><br><span class="line">        <span class="number">760</span> <span class="number">467</span> <span class="number">316</span> <span class="number">500</span> <span class="number">185</span> <span class="number">208</span> <span class="number">447</span> <span class="number">565</span> <span class="number">730</span> <span class="number">839</span> <span class="number">758</span> <span class="number">317</span> <span class="number">577</span> <span class="number">748</span> <span class="number">353</span>;...</span><br><span class="line">        <span class="number">765</span> <span class="number">467</span> <span class="number">315</span> <span class="number">502</span> <span class="number">189</span> <span class="number">212</span> <span class="number">458</span> <span class="number">570</span> <span class="number">730</span> <span class="number">839</span> <span class="number">759</span> <span class="number">323</span> <span class="number">599</span> <span class="number">747</span> <span class="number">366</span>;...</span><br><span class="line">        <span class="number">770</span> <span class="number">467</span> <span class="number">315</span> <span class="number">505</span> <span class="number">192</span> <span class="number">215</span> <span class="number">469</span> <span class="number">575</span> <span class="number">730</span> <span class="number">839</span> <span class="number">759</span> <span class="number">330</span> <span class="number">618</span> <span class="number">747</span> <span class="number">379</span>;...</span><br><span class="line">        <span class="number">775</span> <span class="number">467</span> <span class="number">314</span> <span class="number">510</span> <span class="number">194</span> <span class="number">217</span> <span class="number">477</span> <span class="number">578</span> <span class="number">730</span> <span class="number">839</span> <span class="number">759</span> <span class="number">334</span> <span class="number">633</span> <span class="number">747</span> <span class="number">390</span>;...</span><br><span class="line">        <span class="number">780</span> <span class="number">467</span> <span class="number">314</span> <span class="number">516</span> <span class="number">197</span> <span class="number">219</span> <span class="number">485</span> <span class="number">581</span> <span class="number">730</span> <span class="number">839</span> <span class="number">759</span> <span class="number">338</span> <span class="number">645</span> <span class="number">747</span> <span class="number">399</span>;...</span><br><span class="line">        <span class="number">785</span> <span class="number">467</span> <span class="number">313</span> <span class="number">520</span> <span class="number">200</span> <span class="number">222</span> <span class="number">493</span> <span class="number">583</span> <span class="number">730</span> <span class="number">839</span> <span class="number">759</span> <span class="number">343</span> <span class="number">656</span> <span class="number">746</span> <span class="number">408</span>;...</span><br><span class="line">        <span class="number">790</span> <span class="number">467</span> <span class="number">313</span> <span class="number">524</span> <span class="number">204</span> <span class="number">226</span> <span class="number">500</span> <span class="number">585</span> <span class="number">731</span> <span class="number">839</span> <span class="number">759</span> <span class="number">348</span> <span class="number">666</span> <span class="number">746</span> <span class="number">416</span>;...</span><br><span class="line">        <span class="number">795</span> <span class="number">466</span> <span class="number">312</span> <span class="number">527</span> <span class="number">210</span> <span class="number">231</span> <span class="number">506</span> <span class="number">587</span> <span class="number">731</span> <span class="number">839</span> <span class="number">759</span> <span class="number">353</span> <span class="number">674</span> <span class="number">746</span> <span class="number">422</span>;...</span><br><span class="line">        <span class="number">800</span> <span class="number">466</span> <span class="number">312</span> <span class="number">531</span> <span class="number">218</span> <span class="number">237</span> <span class="number">512</span> <span class="number">588</span> <span class="number">731</span> <span class="number">839</span> <span class="number">759</span> <span class="number">359</span> <span class="number">680</span> <span class="number">746</span> <span class="number">428</span>;...</span><br><span class="line">        <span class="number">805</span> <span class="number">466</span> <span class="number">311</span> <span class="number">535</span> <span class="number">225</span> <span class="number">243</span> <span class="number">517</span> <span class="number">589</span> <span class="number">731</span> <span class="number">839</span> <span class="number">759</span> <span class="number">365</span> <span class="number">686</span> <span class="number">745</span> <span class="number">434</span>;...</span><br><span class="line">        <span class="number">810</span> <span class="number">466</span> <span class="number">311</span> <span class="number">539</span> <span class="number">233</span> <span class="number">249</span> <span class="number">521</span> <span class="number">590</span> <span class="number">731</span> <span class="number">838</span> <span class="number">758</span> <span class="number">372</span> <span class="number">691</span> <span class="number">745</span> <span class="number">439</span>;...</span><br><span class="line">        <span class="number">815</span> <span class="number">466</span> <span class="number">311</span> <span class="number">544</span> <span class="number">243</span> <span class="number">257</span> <span class="number">525</span> <span class="number">590</span> <span class="number">731</span> <span class="number">837</span> <span class="number">757</span> <span class="number">380</span> <span class="number">694</span> <span class="number">745</span> <span class="number">444</span>;...</span><br><span class="line">        <span class="number">820</span> <span class="number">465</span> <span class="number">311</span> <span class="number">548</span> <span class="number">254</span> <span class="number">265</span> <span class="number">529</span> <span class="number">590</span> <span class="number">731</span> <span class="number">837</span> <span class="number">757</span> <span class="number">388</span> <span class="number">697</span> <span class="number">745</span> <span class="number">448</span>;...</span><br><span class="line">        <span class="number">825</span> <span class="number">464</span> <span class="number">311</span> <span class="number">552</span> <span class="number">264</span> <span class="number">273</span> <span class="number">532</span> <span class="number">591</span> <span class="number">731</span> <span class="number">836</span> <span class="number">756</span> <span class="number">396</span> <span class="number">700</span> <span class="number">745</span> <span class="number">451</span>;...</span><br><span class="line">        <span class="number">830</span> <span class="number">464</span> <span class="number">310</span> <span class="number">555</span> <span class="number">274</span> <span class="number">280</span> <span class="number">535</span> <span class="number">592</span> <span class="number">731</span> <span class="number">836</span> <span class="number">756</span> <span class="number">403</span> <span class="number">702</span> <span class="number">745</span> <span class="number">454</span>];</span><br><span class="line">TCS(:,<span class="number">2</span>:end) = TCS(:,<span class="number">2</span>:end)/<span class="number">1000</span>;        </span><br><span class="line">        </span><br><span class="line">% Data <span class="keyword">for</span> isotemperature lines needed <span class="keyword">for</span> calculating correlated color temperature</span><br><span class="line"></span><br><span class="line">% The following provides a table of isotemperature lines <span class="keyword">for</span> use <span class="keyword">with</span> the Robertson Method</span><br><span class="line">% (Robertson, <span class="number">1968</span>) to interpolate isotemperature lines <span class="keyword">from</span> the CIE <span class="number">1960</span> UCS.</span><br><span class="line">% The spacing of the isotemp lines <span class="keyword">is</span> very small (<span class="number">1</span> <span class="number">1</span>/MK) so very little</span><br><span class="line">% interpolation <span class="keyword">is</span> actually needed <span class="keyword">for</span> determining CCT. The latest (<span class="number">2002</span>)</span><br><span class="line">% recommended values <span class="keyword">for</span> the physical constants determining blackbody</span><br><span class="line">% radiation spectra are used</span><br><span class="line"></span><br><span class="line">dwave = wavelength(<span class="number">2</span>)-wavelength(<span class="number">1</span>); % wavelength increment = <span class="number">1</span> nm</span><br><span class="line"></span><br><span class="line">ubar = (<span class="number">2</span>/<span class="number">3</span>)*xbar;</span><br><span class="line">vbar = ybar;</span><br><span class="line">wbar = -<span class="number">0.5</span>*xbar + (<span class="number">3</span>/<span class="number">2</span>)*ybar + <span class="number">0.5</span>*zbar;</span><br><span class="line"></span><br><span class="line">% <span class="number">2002</span> CODATA recommended values</span><br><span class="line">h = <span class="number">6.6260693e-34</span>;</span><br><span class="line">c = <span class="number">299792458</span>;</span><br><span class="line">k = <span class="number">1.3806505e-23</span>;</span><br><span class="line">c1 = <span class="number">2</span>*pi*h*c^<span class="number">2</span>;</span><br><span class="line">c2 = h*c/k;</span><br><span class="line"></span><br><span class="line">MrecpK = [<span class="number">0.01</span> <span class="number">1</span>:<span class="number">600</span>]; % mega reciprical Kelvin values of isotemperature lines</span><br><span class="line">T = <span class="number">1.</span>/(MrecpK*<span class="number">1e-6</span>);</span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>:length(T)</span><br><span class="line">   spdref = c1 * (<span class="number">1e-9</span>*wavelength).^-<span class="number">5</span> ./ (exp(c2./(T(i).* <span class="number">1e-9</span>*wavelength)) - <span class="number">1</span>);</span><br><span class="line">   spdref = spdref/<span class="built_in">max</span>(spdref);</span><br><span class="line">   wave = wavelength*<span class="number">1e-9</span>;</span><br><span class="line">   </span><br><span class="line">   % Equations <span class="keyword">from</span> Wyszecki <span class="keyword">and</span> Sitles, Color Science, 2nd ed. <span class="number">1982</span>, page</span><br><span class="line">   % <span class="number">226</span> <span class="keyword">and</span> <span class="number">227</span></span><br><span class="line">   U = <span class="built_in">sum</span>(spdref.*ubar);</span><br><span class="line">   V = <span class="built_in">sum</span>(spdref.*vbar);</span><br><span class="line">   W = <span class="built_in">sum</span>(spdref.*wbar);</span><br><span class="line">   R = U+V+W;</span><br><span class="line">   u(i) = U/R;</span><br><span class="line">   v(i) = V/R;</span><br><span class="line">   </span><br><span class="line">   Uprime = c1*c2*(T(i))^-<span class="number">2</span>*<span class="built_in">sum</span>(wave.^-<span class="number">6.</span>*ubar.*exp(c2./(wave.*T(i))).*(exp(c2./(wave.*(T(i))))-<span class="number">1</span>).^-<span class="number">2</span>)*dwave;</span><br><span class="line">   Vprime = <span class="built_in">sum</span>(c1*c2*T(i)^-<span class="number">2</span>*wave.^-<span class="number">6.</span>*vbar.*exp(c2./(wave.*T(i))).*(exp(c2./(wave.*(T(i))))-<span class="number">1</span>).^-<span class="number">2</span>)*dwave;</span><br><span class="line">   Wprime = <span class="built_in">sum</span>(c1*c2*T(i)^-<span class="number">2</span>*wave.^-<span class="number">6.</span>*wbar.*exp(c2./(wave.*T(i))).*(exp(c2./(wave.*(T(i))))-<span class="number">1</span>).^-<span class="number">2</span>)*dwave;</span><br><span class="line">   Rprime = Uprime+Vprime+Wprime;</span><br><span class="line">   </span><br><span class="line">   sl(i) = (Vprime*R-V*Rprime)/(Uprime*R-U*Rprime);</span><br><span class="line">   m(i) = -<span class="number">1</span>/sl(i);</span><br><span class="line">end</span><br><span class="line">ut = u;</span><br><span class="line">vt = v;</span><br><span class="line">tt = m;</span><br><span class="line">isoTempLinesTable = [T<span class="string">&#x27; u&#x27;</span> v<span class="string">&#x27; m&#x27;</span>];</span><br><span class="line">%save isoTempLinesNewestFine.txt isoTempLinesTable -<span class="built_in">ascii</span>; % Optionally save file</span><br><span class="line"></span><br><span class="line">% Second, calculate Correlated Color Temperature (CCT), Tc</span><br><span class="line"></span><br><span class="line">%load (<span class="string">&#x27;isoTempLinesNewestFine.mat&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;ut&#x27;</span>, <span class="string">&#x27;vt&#x27;</span>, <span class="string">&#x27;tt&#x27;</span>); % If read <span class="keyword">from</span> previously saved file</span><br><span class="line"></span><br><span class="line">% Interpolate CIE functions to spd increments</span><br><span class="line">xbar = interp1(wavelength,xbar,wavelength_spd);</span><br><span class="line">xbar(isnan(xbar)) = <span class="number">0.0</span>;</span><br><span class="line">ybar = interp1(wavelength,ybar,wavelength_spd);</span><br><span class="line">ybar(isnan(ybar)) = <span class="number">0.0</span>;</span><br><span class="line">zbar = interp1(wavelength,zbar,wavelength_spd);</span><br><span class="line">zbar(isnan(zbar)) = <span class="number">0.0</span>;</span><br><span class="line">% Calculate Chromaticity Coordinates</span><br><span class="line">X = trapz(wavelength_spd,spd.*xbar);</span><br><span class="line">Y = trapz(wavelength_spd,spd.*ybar);</span><br><span class="line">Z = trapz(wavelength_spd,spd.*zbar);</span><br><span class="line">x = X/(X+Y+Z);</span><br><span class="line">y = Y/(X+Y+Z);</span><br><span class="line">u = <span class="number">4</span>*x/(-<span class="number">2</span>*x+<span class="number">12</span>*y+<span class="number">3</span>);</span><br><span class="line">v = <span class="number">6</span>*y/(-<span class="number">2</span>*x+<span class="number">12</span>*y+<span class="number">3</span>);</span><br><span class="line">fprintf(<span class="number">1</span>,<span class="string">&#x27;x = %.4f\ty = %.4f\n&#x27;</span>,x,y);</span><br><span class="line"></span><br><span class="line">% Find adjacent lines to (us, vs) </span><br><span class="line">n = length (T); </span><br><span class="line">index = <span class="number">0</span>; </span><br><span class="line">d1 = ((v-vt(<span class="number">1</span>)) - tt(<span class="number">1</span>)*(u-ut(<span class="number">1</span>)))/sqrt(<span class="number">1</span>+tt(<span class="number">1</span>)*tt(<span class="number">1</span>)); </span><br><span class="line"><span class="keyword">for</span> i=<span class="number">2</span>:n</span><br><span class="line">    d2 = ((v-vt(i)) - tt(i)*(u-ut(i)))/sqrt(<span class="number">1</span>+tt(i)*tt(i));</span><br><span class="line">    <span class="keyword">if</span> (d1/d2 &lt; <span class="number">0</span>)</span><br><span class="line">        index = i;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        d1 = d2;</span><br><span class="line">    end</span><br><span class="line">end</span><br><span class="line"><span class="keyword">if</span> index == <span class="number">0</span></span><br><span class="line">    Tc = -<span class="number">1</span>; % Not able to calculate CCT, u, v coordinates outside <span class="built_in">range</span>.</span><br><span class="line">    fprintf(<span class="number">1</span>,<span class="string">&#x27;Not able to calculate CCT, u, v coordinates outside range.\n&#x27;</span>);</span><br><span class="line">    %<span class="keyword">return</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    % Calculate CCT by interpolation between isotemperature lines</span><br><span class="line">    Tc = <span class="number">1</span>/(<span class="number">1</span>/T(index-<span class="number">1</span>)+d1/(d1-d2)*(<span class="number">1</span>/T(index)-<span class="number">1</span>/T(index-<span class="number">1</span>)));</span><br><span class="line">    fprintf(<span class="number">1</span>,<span class="string">&#x27;CCT = %.1f\n&#x27;</span>,Tc);</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">% Third, calculate the Color Rendering Indices (CRI <span class="keyword">and</span> its <span class="number">14</span> indices)</span><br><span class="line">% Calculate Reference Source Spectrum, spdref. </span><br><span class="line"><span class="keyword">if</span> (Tc &lt; <span class="number">5000</span>)</span><br><span class="line">    c1 = <span class="number">3.7418e-16</span>;</span><br><span class="line">    c2 = <span class="number">1.4388e-2</span>;</span><br><span class="line">    spdref = c1 * (<span class="number">1e-9</span>*wavelength_spd).^-<span class="number">5</span> ./ (exp(c2./(Tc.* <span class="number">1e-9</span>*wavelength_spd)) - <span class="number">1</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">if</span> (Tc &lt;= <span class="number">25000</span>)</span><br><span class="line">        load(<span class="string">&#x27;CIEDaySn&#x27;</span>,<span class="string">&#x27;wavelength&#x27;</span>,<span class="string">&#x27;S0&#x27;</span>,<span class="string">&#x27;S1&#x27;</span>,<span class="string">&#x27;S2&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (Tc &lt;= <span class="number">7000</span>)</span><br><span class="line">            xd = -<span class="number">4.6070e9</span> / Tc.^<span class="number">3</span> + <span class="number">2.9678e6</span> / Tc.^<span class="number">2</span> + <span class="number">0.09911e3</span> / Tc + <span class="number">0.244063</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            xd = -<span class="number">2.0064e9</span> / Tc.^<span class="number">3</span> + <span class="number">1.9018e6</span> / Tc.^<span class="number">2</span> + <span class="number">0.24748e3</span> / Tc + <span class="number">0.237040</span>;</span><br><span class="line">        end</span><br><span class="line">        yd = -<span class="number">3.000</span>*xd*xd + <span class="number">2.870</span>*xd - <span class="number">0.275</span>;</span><br><span class="line">        M1 = (-<span class="number">1.3515</span> - <span class="number">1.7703</span>*xd + <span class="number">5.9114</span>*yd) / (<span class="number">0.0241</span> + <span class="number">0.2562</span>*xd - <span class="number">0.7341</span>*yd);</span><br><span class="line">        M2 = (<span class="number">0.0300</span> - <span class="number">31.4424</span>*xd + <span class="number">30.0717</span>*yd) / (<span class="number">0.0241</span> + <span class="number">0.2562</span>*xd - <span class="number">0.7341</span>*yd);</span><br><span class="line">        spdref = S0 + M1*S1 + M2*S2;</span><br><span class="line">        spdref = interp1(wavelength,spdref,wavelength_spd);</span><br><span class="line">        spdref(isnan(spdref)) = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        R = -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    end</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">% Interpolate TCS values <span class="keyword">from</span> <span class="number">5</span> nm to spd nm increments</span><br><span class="line">TCS_1 = zeros(length(wavelength_spd),<span class="number">14</span>);</span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>:<span class="number">14</span></span><br><span class="line">    TCS_1(:,i) = interp1(TCS(:,<span class="number">1</span>),TCS(:,i+<span class="number">1</span>),wavelength_spd,<span class="string">&#x27;linear&#x27;</span>,<span class="number">0</span>);</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">% Calculate u, v chromaticity coordinates of samples under test illuminant, uk, vk <span class="keyword">and</span></span><br><span class="line">% reference illuminant, ur, vr.</span><br><span class="line">uki = zeros(<span class="number">1</span>,<span class="number">14</span>);</span><br><span class="line">vki = zeros(<span class="number">1</span>,<span class="number">14</span>);</span><br><span class="line">uri = zeros(<span class="number">1</span>,<span class="number">14</span>);</span><br><span class="line">vri = zeros(<span class="number">1</span>,<span class="number">14</span>);</span><br><span class="line">X = trapz(wavelength_spd,spd .* xbar);</span><br><span class="line">Y = trapz(wavelength_spd,spd .* ybar);</span><br><span class="line">Z = trapz(wavelength_spd,spd .* zbar);</span><br><span class="line">Yknormal = <span class="number">100</span> / Y;</span><br><span class="line">Yk = Y*Yknormal;</span><br><span class="line">uk = <span class="number">4</span>*X/(X+<span class="number">15</span>*Y+<span class="number">3</span>*Z);</span><br><span class="line">vk = <span class="number">6</span>*Y/(X+<span class="number">15</span>*Y+<span class="number">3</span>*Z);</span><br><span class="line">X = trapz(wavelength_spd,spdref .* xbar);</span><br><span class="line">Y = trapz(wavelength_spd,spdref .* ybar);</span><br><span class="line">Z = trapz(wavelength_spd,spdref .* zbar);</span><br><span class="line">Yrnormal = <span class="number">100</span> / Y;</span><br><span class="line">Yr = Y*Yrnormal;</span><br><span class="line">ur = <span class="number">4</span>*X/(X+<span class="number">15</span>*Y+<span class="number">3</span>*Z);</span><br><span class="line">vr = <span class="number">6</span>*Y/(X+<span class="number">15</span>*Y+<span class="number">3</span>*Z);</span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>:<span class="number">14</span></span><br><span class="line">	X = trapz(wavelength_spd,spd .* TCS_1(:,i) .* xbar);</span><br><span class="line">	Y = trapz(wavelength_spd,spd .* TCS_1(:,i) .* ybar);</span><br><span class="line">	Z = trapz(wavelength_spd,spd .* TCS_1(:,i) .* zbar);</span><br><span class="line">	Yki(i) = Y*Yknormal;</span><br><span class="line">	uki(i) = <span class="number">4</span>*X/(X+<span class="number">15</span>*Y+<span class="number">3</span>*Z);</span><br><span class="line">	vki(i) = <span class="number">6</span>*Y/(X+<span class="number">15</span>*Y+<span class="number">3</span>*Z);</span><br><span class="line">	X = trapz(wavelength_spd,spdref .* TCS_1(:,i) .* xbar);</span><br><span class="line">	Y = trapz(wavelength_spd,spdref .* TCS_1(:,i) .* ybar);</span><br><span class="line">	Z = trapz(wavelength_spd,spdref .* TCS_1(:,i) .* zbar);</span><br><span class="line">	Yri(i) = Y*Yrnormal;</span><br><span class="line">	uri(i) = <span class="number">4</span>*X/(X+<span class="number">15</span>*Y+<span class="number">3</span>*Z);</span><br><span class="line">	vri(i) = <span class="number">6</span>*Y/(X+<span class="number">15</span>*Y+<span class="number">3</span>*Z);</span><br><span class="line">end</span><br><span class="line">% Check tolorence <span class="keyword">for</span> reference illuminant</span><br><span class="line">DC = sqrt((uk-ur).^<span class="number">2</span> + (vk-vr).^<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">% Apply adaptive (perceived) color shift.</span><br><span class="line">ck = (<span class="number">4</span> - uk - <span class="number">10</span>*vk) / vk;</span><br><span class="line">dk = (<span class="number">1.708</span>*vk + <span class="number">0.404</span> - <span class="number">1.481</span>*uk) / vk;</span><br><span class="line">cr = (<span class="number">4</span> - ur - <span class="number">10</span>*vr) / vr;</span><br><span class="line">dr = (<span class="number">1.708</span>*vr + <span class="number">0.404</span> - <span class="number">1.481</span>*ur) / vr;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>:<span class="number">14</span></span><br><span class="line">	cki = (<span class="number">4</span> - uki(i) - <span class="number">10</span>*vki(i)) / vki(i);</span><br><span class="line">	dki = (<span class="number">1.708</span>*vki(i) + <span class="number">0.404</span> - <span class="number">1.481</span>*uki(i)) / vki(i);</span><br><span class="line">	ukip(i) = (<span class="number">10.872</span> + <span class="number">0.404</span>*cr/ck*cki - <span class="number">4</span>*dr/dk*dki) / (<span class="number">16.518</span> + <span class="number">1.481</span>*cr/ck*cki - dr/dk*dki);</span><br><span class="line">	vkip(i) = <span class="number">5.520</span> / (<span class="number">16.518</span> + <span class="number">1.481</span>*cr/ck*cki - dr/dk*dki);</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">%  Transformation into <span class="number">1964</span> Uniform space coordinates.</span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>:<span class="number">14</span></span><br><span class="line">	Wstarr(i) = <span class="number">25</span>*Yri(i).^<span class="number">.333333</span> - <span class="number">17</span>;</span><br><span class="line">	Ustarr(i) = <span class="number">13</span>*Wstarr(i)*(uri(i) - ur);</span><br><span class="line">	Vstarr(i) = <span class="number">13</span>*Wstarr(i)*(vri(i) - vr);</span><br><span class="line">	</span><br><span class="line">	Wstark(i) = <span class="number">25</span>*Yki(i).^<span class="number">.333333</span> - <span class="number">17</span>;</span><br><span class="line">	Ustark(i) = <span class="number">13</span>*Wstark(i)*(ukip(i) - ur); % after applying the adaptive color shift, <span class="string">u&#x27;k = ur</span></span><br><span class="line"><span class="string">	Vstark(i) = 13*Wstark(i)*(vkip(i) - vr); % after applying the adaptive color shift, v&#x27;</span>k = vr</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">% Determination of resultant color shift, delta E.</span><br><span class="line">deltaE = zeros(<span class="number">1</span>,<span class="number">14</span>);</span><br><span class="line">R = zeros(<span class="number">1</span>,<span class="number">14</span>);</span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>:<span class="number">14</span></span><br><span class="line">	deltaE(i) = sqrt((Ustarr(i) - Ustark(i)).^<span class="number">2</span> + (Vstarr(i) - Vstark(i)).^<span class="number">2</span> + (Wstarr(i) - Wstark(i)).^<span class="number">2</span>);</span><br><span class="line">	R(i) = <span class="number">100</span> - <span class="number">4.6</span>*deltaE(i);</span><br><span class="line">end</span><br><span class="line">Ra = <span class="built_in">sum</span>(R(<span class="number">1</span>:<span class="number">8</span>))/<span class="number">8</span>;</span><br><span class="line">fprintf(<span class="number">1</span>,<span class="string">&#x27;CRIra = %.1f\n&#x27;</span>,Ra);</span><br><span class="line"></span><br><span class="line">% fourth, calculate the gamut area formed by the <span class="number">8</span> CIE standard color samples</span><br><span class="line">ukii=[uki(:,<span class="number">1</span>:<span class="number">8</span>),uki(<span class="number">1</span>)];</span><br><span class="line">vkii=<span class="number">1.5</span>*[vki(:,<span class="number">1</span>:<span class="number">8</span>),vki(<span class="number">1</span>)];</span><br><span class="line">Ga=polyarea(ukii,vkii);</span><br><span class="line">% Normalize gamut area to equal energy source </span><br><span class="line">Ga=Ga/<span class="number">0.00728468</span>*<span class="number">100</span>;</span><br><span class="line">fprintf(<span class="number">1</span>,<span class="string">&#x27;Gamut Area Index = %.1f\n&#x27;</span>,Ga);</span><br><span class="line"></span><br><span class="line">% Fifth, calculate the FSI (full spectrum index)</span><br><span class="line">% Calculates the Full-spectrum Index</span><br><span class="line"></span><br><span class="line">% Interpolate to wavelength interval of 1nm <span class="keyword">from</span> 380nm to 730nm</span><br><span class="line">numWave = <span class="number">351</span>;</span><br><span class="line">t=(<span class="number">380</span>:<span class="number">1</span>:<span class="number">730</span>)<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">spd=interp1(wavelength_spd,spd,t,&#x27;</span>spline<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">spd(isnan(spd)) = 0.0; </span></span><br><span class="line"><span class="string">spd = spd/sum(spd); % Normalize the relative spd so that the total power equals 1</span></span><br><span class="line"><span class="string">%Equal energy cumulative spd</span></span><br><span class="line"><span class="string">EEcum=(1/numWave:1/numWave:1)&#x27;</span>;</span><br><span class="line">%Calculate FSI</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j=<span class="number">1</span>:numWave </span><br><span class="line">cum = cumsum(spd); % A MatLab function <span class="keyword">for</span> cumulative sums </span><br><span class="line">sqrDiff = (cum-EEcum).^<span class="number">2</span>; </span><br><span class="line">sumSqrDiff(j)=<span class="built_in">sum</span>(sqrDiff); </span><br><span class="line">spd=circshift(spd,<span class="number">1</span>); </span><br><span class="line">end </span><br><span class="line">FSI=mean(sumSqrDiff); </span><br><span class="line">FSCI=<span class="number">100</span>-<span class="number">5.1</span>*FSI;</span><br><span class="line">fprintf(<span class="number">1</span>,<span class="string">&#x27;FSCI = %.3f\n&#x27;</span>,FSCI);</span><br></pre></td></tr></table></figure>

<h2 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">helmholtz</span><br><span class="line">axis equal</span><br></pre></td></tr></table></figure>

<h2 id="MATLAB绘制多条曲线"><a href="#MATLAB绘制多条曲线" class="headerlink" title="MATLAB绘制多条曲线"></a>MATLAB绘制多条曲线</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">n = length(a(<span class="number">1</span>,:))-<span class="number">1</span>;  %how much number of color to use</span><br><span class="line">c = colormap(jet(n));  %number of color <span class="keyword">in</span> figure</span><br><span class="line">c1 = <span class="number">0</span>;</span><br><span class="line">figure(<span class="string">&#x27;color&#x27;</span>,[<span class="number">1</span> <span class="number">1</span> <span class="number">1</span>]); </span><br><span class="line"><span class="keyword">for</span> ix = <span class="number">2</span>:length(a(<span class="number">1</span>,:))</span><br><span class="line">    plot(a(:,<span class="number">1</span>),a(:,ix),<span class="string">&#x27;Color&#x27;</span>, c(ix-<span class="number">1</span>,:),  <span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">2</span>);</span><br><span class="line">    hold on;</span><br><span class="line">end</span><br><span class="line"><span class="built_in">set</span>(gca,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">20</span>);axis([<span class="built_in">min</span>(a(:,<span class="number">1</span>)),<span class="built_in">max</span>(a(:,<span class="number">1</span>)),<span class="number">0</span>  , <span class="number">0.7</span>]);</span><br><span class="line">xlabel(<span class="string">&#x27;wavelength (nm)&#x27;</span>);ylabel(<span class="string">&#x27;Intensity&#x27;</span>);</span><br></pre></td></tr></table></figure>



<p>&#96;&#96;python</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">%% <span class="built_in">input</span> a(wavelength,curve)</span><br><span class="line">number=length(a(<span class="number">1</span>,:))-<span class="number">1</span>;%总的绘制曲线的条数</span><br><span class="line">photo = <span class="number">6</span> ; %图片个数</span><br><span class="line">curve_n=number/photo; %%每个图片中的曲线</span><br><span class="line">b=a(:,<span class="number">2</span>:number+<span class="number">1</span>); %% curve</span><br><span class="line"></span><br><span class="line">x =a(:,<span class="number">1</span>); %% wavelength</span><br><span class="line">TempNum = <span class="number">6</span> ;%% 颜色的数量</span><br><span class="line">cmap = hsv(TempNum);</span><br><span class="line">figure(<span class="string">&#x27;color&#x27;</span>,[<span class="number">1</span> <span class="number">1</span> <span class="number">1</span>]);</span><br><span class="line"><span class="keyword">for</span> j=<span class="number">1</span>:photo</span><br><span class="line">        subplot(<span class="number">3</span>, <span class="number">2</span>, j);</span><br><span class="line">        k=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> i=(j-<span class="number">1</span>)*curve_n+<span class="number">1</span>:j*curve_n</span><br><span class="line">            y = b(:,i);</span><br><span class="line">            plot(x, y,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">3</span>,<span class="string">&#x27;Color&#x27;</span>,cmap(k,:));hold on;</span><br><span class="line">            k=k+<span class="number">1</span>;</span><br><span class="line">        end</span><br><span class="line">        hold off;</span><br><span class="line">        xlabel(<span class="string">&#x27;Wavelength(nm)&#x27;</span>);</span><br><span class="line">        axis([<span class="number">400</span> <span class="number">1300</span> <span class="number">0</span> <span class="number">1</span>]);</span><br><span class="line">        <span class="built_in">set</span>(gca,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Calibri&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">30</span>);</span><br><span class="line">        h = legend(<span class="string">&#x27;50&#x27;</span>,<span class="string">&#x27;100&#x27;</span>,<span class="string">&#x27;150&#x27;</span>,<span class="string">&#x27;200&#x27;</span>,<span class="string">&#x27;250&#x27;</span>);</span><br><span class="line">        <span class="built_in">set</span>(h, <span class="string">&#x27;Box&#x27;</span>, <span class="string">&#x27;off&#x27;</span>);</span><br><span class="line">end</span><br><span class="line">%         plot(wave,R,<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">3</span>);hold on;plot(wave,T,<span class="string">&#x27;b--&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">3</span>);</span><br><span class="line">%         xlabel(<span class="string">&#x27;Wavelength(nm)&#x27;</span>,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Calibri&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">36</span>);</span><br><span class="line">%         ylabel(<span class="string">&#x27;R&amp;T&#x27;</span>,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Calibri&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">36</span>);</span><br><span class="line">%         <span class="built_in">set</span>(gca,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Calibri&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">36</span>);</span><br><span class="line">%          n=<span class="number">32</span>; colormap(hsv(n)); pcolor([<span class="number">1</span>:n+<span class="number">1</span>;<span class="number">1</span>:n+<span class="number">1</span>]);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>MATLAB 控制FDTD程序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">function Y = objectivefunction(X)</span><br><span class="line">    % Note: X <span class="keyword">is</span> a [<span class="number">1</span>*<span class="number">2</span>] vector, i.e. X=[x1 x2]</span><br><span class="line">     x1=X(<span class="number">1</span>,<span class="number">1</span>);x2=X(<span class="number">1</span>,<span class="number">2</span>); % x2=second variable</span><br><span class="line">    path(path,<span class="string">&#x27;C:\Program Files\Lumerical\FDTD\api\matlab&#x27;</span>);%Add Lumerical Matlab API path</span><br><span class="line">    sim_file_path=(<span class="string">&#x27;D:\files\FDTD files\MATLABcomsol\multi&#x27;</span>); % update this path to use<span class="string">r&#x27;s folder 文件路径</span></span><br><span class="line"><span class="string">    sim_file_name=(&#x27;</span>Wu.fsp<span class="string">&#x27;);% 文件名字</span></span><br><span class="line"><span class="string">    h=appopen(&#x27;</span>fdtd<span class="string">&#x27;); %Open FDTD session</span></span><br><span class="line"><span class="string">    %Pass the path variables to FDTD</span></span><br><span class="line"><span class="string">    appputvar(h,&#x27;</span>sim_file_path<span class="string">&#x27;,sim_file_path);</span></span><br><span class="line"><span class="string">    appputvar(h,&#x27;</span>sim_file_name<span class="string">&#x27;,sim_file_name);</span></span><br><span class="line"><span class="string">    appevalscript(h,&#x27;</span>load(<span class="string">&quot;Wu.fsp&quot;</span>);<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">%   appevalscript(h,&#x27;</span>switchtolayout;<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">%%  set parameter</span></span><br><span class="line"><span class="string">    code=strcat(&#x27;</span>switchtolayout;<span class="string">&#x27;,&#x27;</span>select(<span class="string">&quot;group&quot;</span>);<span class="string">&#x27;,...</span></span><br><span class="line"><span class="string">    &#x27;</span><span class="built_in">set</span>(<span class="string">&quot;h1&quot;</span>,<span class="string">&#x27;,num2str(x1*1e-9,16),&#x27;</span>);<span class="string">&#x27;,...</span></span><br><span class="line"><span class="string">    &#x27;</span><span class="built_in">set</span>(<span class="string">&quot;h3&quot;</span>,<span class="string">&#x27;,num2str(x2*1e-9,16),&#x27;</span>);<span class="string">&#x27;,...</span></span><br><span class="line"><span class="string">    &#x27;</span>run;<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">    appevalscript(h,code);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">%     appevalscript(h,&#x27;</span>run;<span class="string">&#x27;);%跑</span></span><br><span class="line"><span class="string">    appevalscript(h,&#x27;</span>A=getresult(<span class="string">&quot;monitor&quot;</span>,<span class="string">&quot;T&quot;</span>);<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">    appevalscript(h,&#x27;</span>A_s=A.getattribute(<span class="string">&quot;T&quot;</span>);<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">    A_spectrum =appgetvar(h,&#x27;</span>A_s<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    A=10; % parameter of the optimization problem</span></span><br><span class="line"><span class="string">    n=2; % parameter of the optimization problem</span></span><br><span class="line"><span class="string">    appclose(h);</span></span><br><span class="line"><span class="string">    Y=sum(A_spectrum);</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">% Y=A*n+[(x1)^2-A*cos(2*pi*x1)]+[(x2)^2-A*cos(2*pi*x2)];</span></span><br><span class="line"><span class="string">% Y=Rastrigin function</span></span><br></pre></td></tr></table></figure>

<h2 id="MATLAB-绘制多条曲线"><a href="#MATLAB-绘制多条曲线" class="headerlink" title="MATLAB 绘制多条曲线"></a>MATLAB 绘制多条曲线</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">n = length(a(<span class="number">1</span>,:))-<span class="number">1</span>;  %how much number of color to use</span><br><span class="line">c = colormap(jet(n));  %number of color <span class="keyword">in</span> figure</span><br><span class="line">c1 = <span class="number">0</span>;</span><br><span class="line">figure(<span class="string">&#x27;color&#x27;</span>,[<span class="number">1</span> <span class="number">1</span> <span class="number">1</span>]); </span><br><span class="line"><span class="keyword">for</span> ix = <span class="number">2</span>:length(a(<span class="number">1</span>,:))</span><br><span class="line">    plot(a(:,<span class="number">1</span>),a(:,ix),<span class="string">&#x27;Color&#x27;</span>, c(ix-<span class="number">1</span>,:),  <span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">2</span>);</span><br><span class="line">    hold on;</span><br><span class="line">end</span><br><span class="line"><span class="built_in">set</span>(gca,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">20</span>);axis([<span class="built_in">min</span>(a(:,<span class="number">1</span>)),<span class="built_in">max</span>(a(:,<span class="number">1</span>)),<span class="number">0</span>  , <span class="number">0.7</span>]);</span><br><span class="line">xlabel(<span class="string">&#x27;wavelength (nm)&#x27;</span>);ylabel(<span class="string">&#x27;Intensity&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="picture函数导出透明图片"><a href="#picture函数导出透明图片" class="headerlink" title="picture函数导出透明图片"></a>picture函数导出透明图片</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">img = imread(<span class="string">&#x27;mypicture.png&#x27;</span>);</span><br><span class="line">min_x = <span class="number">0</span>;max_x = <span class="number">0.8</span>;min_y = <span class="number">0</span>;max_y = <span class="number">0.9</span>;</span><br><span class="line">imagesc([min_x max_x], [min_y max_y], flipdim(img,<span class="number">1</span>)); </span><br><span class="line"><span class="built_in">set</span>(gca,<span class="string">&#x27;ydir&#x27;</span>,<span class="string">&#x27;normal&#x27;</span>);</span><br><span class="line">hold on;</span><br><span class="line">plot(<span class="number">0.3333</span>,<span class="number">0.3333</span>,<span class="string">&#x27;r*&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="时间计算-tc-m"><a href="#时间计算-tc-m" class="headerlink" title="时间计算 tc.m"></a>时间计算 tc.m</h2><p>用法：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">t1 = clock;</span><br><span class="line"><span class="comment">% 程序</span></span><br><span class="line">t2 = clock;</span><br><span class="line">tc(t2, t1);</span><br></pre></td></tr></table></figure>

<p>函数：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[Frame_Name]</span>= <span class="title">tc</span><span class="params">(t2,t1)</span></span></span><br><span class="line">    time_distance = etime(t2,t1);</span><br><span class="line">    <span class="comment">% 保留小数点后两位</span></span><br><span class="line">    <span class="keyword">if</span> time_distance &lt;= <span class="number">60</span></span><br><span class="line">        Frame_Name = [ num2str(<span class="built_in">round</span>(time_distance,<span class="number">2</span>)) <span class="string">&#x27;s&#x27;</span>]</span><br><span class="line">        time_distance = time_distance/<span class="number">60</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(time_distance &gt;<span class="number">60</span> )&amp;&amp;(time_distance &lt;<span class="number">60</span>*<span class="number">60</span>)</span><br><span class="line">        Frame_Name = [ num2str(<span class="built_in">round</span>(time_distance/<span class="number">60</span>,<span class="number">2</span>)) <span class="string">&#x27;min&#x27;</span>]</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> time_distance &gt;= <span class="number">60</span>*<span class="number">60</span></span><br><span class="line">        Frame_Name = [ num2str(<span class="built_in">round</span>(time_distance/<span class="number">60</span>/<span class="number">60</span>,<span class="number">2</span>)) <span class="string">&#x27;h&#x27;</span>]</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line">start_time = time.time()</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">end_time = time.time()  <span class="comment"># calculate time</span></span><br><span class="line"><span class="keyword">if</span> end_time - start_time &gt;= <span class="number">3600</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&#123;&#125; h&quot;</span>.<span class="built_in">format</span>(<span class="built_in">round</span>((end_time - start_time) / <span class="number">3600</span>, <span class="number">2</span>)))</span><br><span class="line"><span class="keyword">elif</span> end_time - start_time &gt;= <span class="number">60</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&#123;&#125; min&quot;</span>.<span class="built_in">format</span>(<span class="built_in">round</span>((end_time - start_time) / <span class="number">60</span>, <span class="number">2</span>)))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&#123;&#125; s&quot;</span>.<span class="built_in">format</span>(<span class="built_in">round</span>((end_time - start_time), <span class="number">1</span>)))</span><br></pre></td></tr></table></figure>



<h2 id="黑体辐射强度"><a href="#黑体辐射强度" class="headerlink" title="黑体辐射强度"></a>黑体辐射强度</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">% simple model of the black body using MATLAB/Octave/Freemat</span><br><span class="line">wavelength = <span class="number">0.01</span>:<span class="number">0.01</span>:<span class="number">5.0</span>;     % microns sweep over a <span class="built_in">range</span> of wavelengths</span><br><span class="line">T = <span class="number">5000</span>;                       % temperature <span class="keyword">in</span> kelvin</span><br><span class="line">F = <span class="number">3.742</span>./ ((wavelength.^<span class="number">5</span>).*(exp(<span class="number">1.439e4</span>./(wavelength*T))-<span class="number">1</span>)) ; % gives the result <span class="keyword">in</span> W/m2/um x <span class="number">1e8</span></span><br><span class="line">plot(wavelength,F);</span><br><span class="line">xlabel(<span class="string">&#x27;wavelength (\mum)&#x27;</span>);       %  add axis labels <span class="keyword">and</span> plot title</span><br><span class="line">ylabel(<span class="string">&#x27;spectral intensity (W/m^2/\mum) x 10^8&#x27;</span>);</span><br><span class="line">title(<span class="string">&#x27;Blackbody Radiation&#x27;</span>);</span><br><span class="line">legend(sprintf(<span class="string">&#x27;T = %.0f K&#x27;</span>,T));</span><br></pre></td></tr></table></figure>

<h2 id="画彩色图"><a href="#画彩色图" class="headerlink" title="画彩色图"></a>画彩色图</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">figure</span>(<span class="string">&#x27;color&#x27;</span>,[<span class="number">1</span> <span class="number">1</span> <span class="number">1</span>]);</span><br><span class="line">x = <span class="built_in">linspace</span>(-grating_period, grating_period, <span class="number">100</span>); <span class="comment">% 绘制的范围 两个周期</span></span><br><span class="line">[tab1, z, o] = res3(x, aa, profil1, <span class="number">1</span>, parm); </span><br><span class="line">h = pcolor(x, z, <span class="built_in">real</span>(o)); <span class="comment">% 绘制图像，并返回句柄</span></span><br><span class="line">set(h, <span class="string">&#x27;EdgeColor&#x27;</span>, <span class="string">&#x27;none&#x27;</span>);</span><br><span class="line">axis tight; <span class="comment">% 自动调整坐标轴的范围，使其紧贴着数据的最小值和最大值</span></span><br><span class="line">colorbar;colormap jet;</span><br><span class="line">set(gca, <span class="string">&#x27;TickDir&#x27;</span>, <span class="string">&#x27;in&#x27;</span>, <span class="string">&#x27;Box&#x27;</span>, <span class="string">&#x27;off&#x27;</span>, <span class="string">&#x27;LineWidth&#x27;</span>, <span class="number">1.5</span>);</span><br><span class="line">set(gca,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Times New Roman&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">36</span>); <span class="comment">% Times New Roman</span></span><br><span class="line">xlabel(<span class="string">&#x27;X label range (um)&#x27;</span>,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Times New Roman&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">36</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;Z label (um)&#x27;</span>,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Times New Roman&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">36</span>);</span><br><span class="line">title(<span class="string">&#x27;两个周期 截面折射率&#x27;</span>,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Monospaced&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">36</span>);</span><br><span class="line">set(gcf,<span class="string">&#x27;unit&#x27;</span>,<span class="string">&#x27;centimeters&#x27;</span>,<span class="string">&#x27;position&#x27;</span>,[<span class="number">-25</span>,<span class="number">10</span>,<span class="number">20</span>,<span class="number">15</span>]) <span class="comment">% [位置横纵 宽 高]</span></span><br></pre></td></tr></table></figure>

<img src="https://cdn.staticaly.com/gh/yangmulao/blogcdn@master/img/image-20230405173146881.png" srcset="/img/loading.gif" lazyload alt="image-20230405173146881" style="zoom:50%;" />





<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">%<span class="built_in">input</span> a</span><br><span class="line">[ax,ay]=size(a);</span><br><span class="line">B=a(<span class="number">1</span>,<span class="number">2</span>:ay);</span><br><span class="line">A=a(<span class="number">2</span>:ax,<span class="number">1</span>);</span><br><span class="line">C=a(<span class="number">2</span>:ax,<span class="number">2</span>:ay);</span><br><span class="line">%  C=flipud(C);</span><br><span class="line">[ax,ay]=<span class="built_in">max</span>(<span class="built_in">max</span>(C));</span><br><span class="line">% C=C/ax;</span><br><span class="line">[x,y]=meshgrid(A,B);</span><br><span class="line">figure(<span class="string">&#x27;color&#x27;</span>,[<span class="number">1</span> <span class="number">1</span> <span class="number">1</span>]);</span><br><span class="line">surf(y,x,C<span class="string">&#x27;);shading interp;colorbar;</span></span><br><span class="line"><span class="string"> pcolor(A,B,C&#x27;</span>)</span><br><span class="line">% pcolor(B,A,C)</span><br><span class="line">colorbar,shading interp, hold on;</span><br><span class="line">[c,h] = contour(A,B,C<span class="string">&#x27;,[0.9],&#x27;</span>k--<span class="string">&#x27;,&#x27;</span>LineWidth<span class="string">&#x27;,1.2);%k 黑色</span></span><br><span class="line"><span class="string">[c,h] = contour(A,B,C&#x27;</span>,[<span class="number">0.8</span>],<span class="string">&#x27;b--&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">1.2</span>);%k 蓝色</span><br><span class="line">[c,h] = contour(A,B,C<span class="string">&#x27;,[0.6 0.6],&#x27;</span>k--<span class="string">&#x27;,&#x27;</span>LineWidth<span class="string">&#x27;,1.2);%k 红色</span></span><br><span class="line"><span class="string">set(gca,&#x27;</span>FontName<span class="string">&#x27;,&#x27;</span>Times New Roman<span class="string">&#x27;,&#x27;</span>FontSize<span class="string">&#x27;,36);</span></span><br><span class="line"><span class="string">colormap hot;</span></span><br><span class="line"><span class="string">% colormap jet;</span></span><br><span class="line"><span class="string">xlabel(&#x27;</span>Wavelength(μm)<span class="string">&#x27;,&#x27;</span>FontName<span class="string">&#x27;,&#x27;</span>Times New Roman<span class="string">&#x27;,&#x27;</span>FontSize<span class="string">&#x27;,36);</span></span><br><span class="line"><span class="string">ylabel(&#x27;</span>Incident angle(degree)<span class="string">&#x27;,&#x27;</span>FontName<span class="string">&#x27;,&#x27;</span>Times New Roman<span class="string">&#x27;,&#x27;</span>FontSize<span class="string">&#x27;,36);</span></span><br><span class="line"><span class="string">set(gcf,&#x27;</span>unit<span class="string">&#x27;,&#x27;</span>centimeters<span class="string">&#x27;,&#x27;</span>position<span class="string">&#x27;,[5 5 25 20]) % 长//宽</span></span><br><span class="line"><span class="string">% set(gca,&#x27;</span>Position<span class="string">&#x27;,[.1 .3 .2 .5]);</span></span><br><span class="line"><span class="string">set(gca, &#x27;</span>yTick<span class="string">&#x27;, [0:30:90]);   %设置轴坐标刻度</span></span><br></pre></td></tr></table></figure>

<h2 id="螺丝程序"><a href="#螺丝程序" class="headerlink" title="螺丝程序"></a>螺丝程序</h2><p>·&#96;python</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">% a = <span class="number">0</span>:<span class="number">0.02</span>:<span class="number">1</span>*<span class="number">2</span>*pi;</span><br><span class="line">% z = sin(a);z=z<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">% le = length(a);</span></span><br><span class="line"><span class="string">% y1 =0*cos(a);</span></span><br><span class="line"><span class="string">% y1 = y1&#x27;</span>;</span><br><span class="line">% y2=cos(a);</span><br><span class="line">% y2 = y2<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">% yy = [y1 ;y2];</span></span><br><span class="line"><span class="string">% YY = yy;</span></span><br><span class="line"><span class="string">% for ix = 1:3</span></span><br><span class="line"><span class="string">% YY = [YY ;yy];</span></span><br><span class="line"><span class="string">% end</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">a = -1:0.02:1;</span></span><br><span class="line"><span class="string">a1 = 0.98:-0.02:-1;</span></span><br><span class="line"><span class="string">b = [a a1];</span></span><br><span class="line"><span class="string">y = asin(b);</span></span><br><span class="line"><span class="string">y = y&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="全排列组合"><a href="#全排列组合" class="headerlink" title="全排列组合"></a>全排列组合</h2><p>··&#96;python</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cs1 = <span class="number">1</span>:<span class="number">4</span>;</span><br><span class="line">cs2 = <span class="number">1</span>:<span class="number">3</span>;</span><br><span class="line">cs3 = <span class="number">2</span>:<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">[j1,j2,j3]=ndgrid(cs1,cs2,cs3);</span><br><span class="line">COM=[j1(:),j2(:),j3(:)];clear cs1 cs2 cs3 j1 j2 j3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">scale = <span class="number">10</span>; % 分辨率</span><br><span class="line">column = DomainElementsY / scale ; % <span class="number">10</span> 划分的个数 矩阵的列数 </span><br><span class="line">A = double(logical(de2bi(<span class="number">0</span>:<span class="number">2</span>^column-<span class="number">1</span>, column)));</span><br></pre></td></tr></table></figure>

<h2 id="西瓜函数"><a href="#西瓜函数" class="headerlink" title="西瓜函数"></a>西瓜函数</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line">function SolvePde_FrozenWatermelon</span><br><span class="line">% 把西瓜放冰箱里，多长时间才能冰透？</span><br><span class="line">% 求解冰镇西瓜过程中的温度扩散问题（热传导方程）</span><br><span class="line">%       <span class="number">1</span>   ∂T     <span class="number">1</span>   ∂        ∂</span><br><span class="line">%      ---.---- = ---.----( r2.----)</span><br><span class="line">%       a   ∂t     r2  ∂r       ∂r</span><br><span class="line">%</span><br><span class="line">%   初始条件：</span><br><span class="line">%            t = <span class="number">0</span>, <span class="number">0</span> ≤ r ≤ R, T = T0</span><br><span class="line">%   边值条件：</span><br><span class="line">%            t &gt; <span class="number">0</span>, r = <span class="number">0</span>, ∂T/∂r = <span class="number">0</span></span><br><span class="line">%            t &gt; <span class="number">0</span>, r = R, h(T - Tinf) = -k.∂T/∂r</span><br><span class="line">%</span><br><span class="line">%   <span class="number">1.</span> 假设西瓜的外形是一个半径为R的完美的球体</span><br><span class="line">%   <span class="number">2.</span> 假设西瓜没有瓜皮，没有瓜籽，瓜瓤也是完全均匀的，其密度、导热能力、比热容</span><br><span class="line">%      全是均匀的，一切物性参数都不随温度变化而变化</span><br><span class="line">%   <span class="number">3.</span> 冰箱是一个恒温为Tinf ℃的环境</span><br><span class="line">%</span><br><span class="line">%   August <span class="number">4</span>  <span class="number">2017</span>, editted by ZhongHua-Xie, Tianjin University of Science <span class="keyword">and</span> Technology.</span><br><span class="line"></span><br><span class="line">% 相关参数</span><br><span class="line">h = <span class="number">5</span>;%        % 西瓜与静止冷空气的对流换热系数 [w/(㎡.K)]</span><br><span class="line">k = <span class="number">0.48</span>;%     % 西瓜的导热系数 [w/(m.K)]</span><br><span class="line">p = <span class="number">918</span>;      % 西瓜的密度 [kg/m3]</span><br><span class="line">Cp = <span class="number">3990</span>;    % 热容 [J/(kg.K)]</span><br><span class="line">a = k/(p*Cp); % 西瓜的热扩散系数 [㎡/s]</span><br><span class="line">T0 = <span class="number">32</span>;      % 初始温度 [℃]</span><br><span class="line">Tinf = <span class="number">6</span>;     % 终极温度 [℃]</span><br><span class="line"></span><br><span class="line">m = <span class="number">2</span>;                                     % 方程中的m参数</span><br><span class="line">r = linspace(<span class="number">0</span>,<span class="number">9</span>,<span class="number">50</span>)/<span class="number">100</span>;                  % 定义距离向量r</span><br><span class="line">t = linspace(<span class="number">0</span>,<span class="number">10</span>,<span class="number">50</span>)*<span class="number">3600</span>;                % 定义时间向量t</span><br><span class="line">Td = pdepe(m,@pdefun,@pdeic,@pdebc,r,t);   % 方程求解</span><br><span class="line"></span><br><span class="line">% 结果可视化</span><br><span class="line">figure;</span><br><span class="line">surf(r*<span class="number">100</span>,t/<span class="number">3600</span>,Td);                     % 绘制温度T关于距离r和时间t的三维曲面</span><br><span class="line">colorbar;</span><br><span class="line">zlim([<span class="built_in">min</span>(Td(:))-<span class="number">2</span>,<span class="built_in">max</span>(Td(:))+<span class="number">2</span>]);</span><br><span class="line">title(<span class="string">&#x27;T(r,t)&#x27;</span>); </span><br><span class="line">xlabel(<span class="string">&#x27;Distance r&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;Time t&#x27;</span>)</span><br><span class="line">view(<span class="number">116</span>,<span class="number">33</span>);</span><br><span class="line">text(<span class="number">8</span>,-<span class="number">0.5</span>,<span class="number">34.5</span>,<span class="string">&#x27;开始冷藏&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;Rotation&#x27;</span>,<span class="number">40</span>)</span><br><span class="line">text(<span class="number">0</span>,<span class="number">5</span>,<span class="number">26</span>,<span class="string">&#x27;瓜心&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">18</span>)</span><br><span class="line">text(<span class="number">7</span>,<span class="number">2</span>,<span class="number">10.5</span>,<span class="string">&#x27;瓜皮&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">18</span>)</span><br><span class="line"></span><br><span class="line">% 绘制西瓜等效切面温度扩散动画</span><br><span class="line">num = size(Td,<span class="number">2</span>);</span><br><span class="line">thetai = linspace(<span class="number">0</span>,<span class="number">2</span>*pi,<span class="number">50</span>);</span><br><span class="line">[R,Theta] = meshgrid(r,thetai);</span><br><span class="line">X = <span class="number">100</span>*R.*cos(Theta);</span><br><span class="line">Y = <span class="number">100</span>*R.*sin(Theta);</span><br><span class="line">Tdi = ones(size(thetai<span class="string">&#x27;))*Td(1,:);</span></span><br><span class="line"><span class="string">X_bac = linspace(min(X(:))-1,max(X(:))+1,50);</span></span><br><span class="line"><span class="string">Y_bac = linspace(min(Y(:))-1,max(Y(:))+1,50);</span></span><br><span class="line"><span class="string">[X_bac,Y_bac] = meshgrid(X_bac,Y_bac);</span></span><br><span class="line"><span class="string">figure;</span></span><br><span class="line"><span class="string">% 绘制背景温度面</span></span><br><span class="line"><span class="string">surf(X_bac,Y_bac,Tinf*ones(size(X_bac)),&#x27;</span>FaceColo<span class="string">r&#x27;,&#x27;</span>interp<span class="string">&#x27;,&#x27;</span>EdgeColo<span class="string">r&#x27;,&#x27;</span>none<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">hold on;</span></span><br><span class="line"><span class="string">% 绘制零时刻西瓜等效温度切面</span></span><br><span class="line"><span class="string">hs = surf(X,Y,Tdi,&#x27;</span>FaceColo<span class="string">r&#x27;,&#x27;</span>interp<span class="string">&#x27;,&#x27;</span>EdgeColo<span class="string">r&#x27;,&#x27;</span>none<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">axis equal;</span></span><br><span class="line"><span class="string">axis([min(X_bac(:)),max(X_bac(:)),min(Y_bac(:)),max(Y_bac(:))])</span></span><br><span class="line"><span class="string">xlabel(&#x27;</span>X<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">ylabel(&#x27;</span>Y<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">caxis([Tinf,max(Td(:))]);</span></span><br><span class="line"><span class="string">colorbar;</span></span><br><span class="line"><span class="string">view(2);</span></span><br><span class="line"><span class="string">ht = title([&#x27;</span>冷藏<span class="string">&#x27;,num2str(t(1)/3600,&#x27;</span>%<span class="number">2.1</span><span class="string">f&#x27;),&#x27;</span>小时后<span class="string">&#x27;]);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">% filename = &#x27;</span>冰镇西瓜温度扩散动画.gi<span class="string">f&#x27;;</span></span><br><span class="line"><span class="string">% f = getframe(gcf);</span></span><br><span class="line"><span class="string">% IM = frame2im(f);</span></span><br><span class="line"><span class="string">% [IM,map] = rgb2ind(IM,256);</span></span><br><span class="line"><span class="string">% imwrite(IM,map,filename,&#x27;</span>gi<span class="string">f&#x27;, &#x27;</span>Loopcount<span class="string">&#x27;,inf,&#x27;</span>DelayTime<span class="string">&#x27;,0.2);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for i = 2:num</span></span><br><span class="line"><span class="string">    Tdi = ones(size(thetai&#x27;</span>))*Td(i,:);</span><br><span class="line">    <span class="built_in">set</span>(hs,<span class="string">&#x27;ZData&#x27;</span>,Tdi);</span><br><span class="line">    <span class="built_in">set</span>(ht,<span class="string">&#x27;String&#x27;</span>,[<span class="string">&#x27;冷藏&#x27;</span>,num2str(t(i)/<span class="number">3600</span>,<span class="string">&#x27;%2.1f&#x27;</span>),<span class="string">&#x27;小时后&#x27;</span>]);</span><br><span class="line">    pause(<span class="number">0.2</span>);</span><br><span class="line"></span><br><span class="line">%     f = getframe(gcf);</span><br><span class="line">%     IM = frame2im(f);</span><br><span class="line">%     [IM,<span class="built_in">map</span>] = rgb2ind(IM,<span class="number">256</span>);</span><br><span class="line">%     imwrite(IM,<span class="built_in">map</span>,filename,<span class="string">&#x27;gif&#x27;</span>,<span class="string">&#x27;WriteMode&#x27;</span>,<span class="string">&#x27;append&#x27;</span>,<span class="string">&#x27;DelayTime&#x27;</span>,<span class="number">0.2</span>);   </span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">    function [c,f,s] = pdefun(r,t,T,dT)</span><br><span class="line">        % 偏微分方程函数</span><br><span class="line">        c = <span class="number">1</span>/a;</span><br><span class="line">        f = dT;</span><br><span class="line">        s = <span class="number">0</span>;</span><br><span class="line">    end</span><br><span class="line"></span><br><span class="line">    function u0 = pdeic(r)</span><br><span class="line">        % 初始条件函数</span><br><span class="line">        u0 = T0;</span><br><span class="line">    end</span><br><span class="line"></span><br><span class="line">    function [pa,qa,pb,qb] = pdebc(ra,Ta,rb,Tb,t)</span><br><span class="line">        % 边值条件函数</span><br><span class="line">        pa = <span class="number">0</span>;</span><br><span class="line">        qa = <span class="number">1</span>;</span><br><span class="line">        pb = h*(Tb - Tinf);</span><br><span class="line">        qb = k;</span><br><span class="line">    end</span><br><span class="line"></span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<h2 id="有效折射理论"><a href="#有效折射理论" class="headerlink" title="有效折射理论"></a>有效折射理论</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">clc;</span><br><span class="line">clear;</span><br><span class="line">S11R=importdata(<span class="string">&#x27;real11.txt&#x27;</span>);</span><br><span class="line">S11I=importdata(<span class="string">&#x27;imag11.txt&#x27;</span>);</span><br><span class="line">S21R=importdata(<span class="string">&#x27;real21.txt&#x27;</span>);</span><br><span class="line">S21I=importdata(<span class="string">&#x27;imag21.txt&#x27;</span>);%导入数据</span><br><span class="line">real11=S11R.data;</span><br><span class="line">imag11=S11I.data;</span><br><span class="line">real21=S21R.data;</span><br><span class="line">imag21=S21I.data;</span><br><span class="line">N=<span class="number">1001</span>;</span><br><span class="line">d=<span class="number">0.00002</span>;</span><br><span class="line">c=<span class="number">3e8</span>;</span><br><span class="line"></span><br><span class="line">f=zeros(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">s11=zeros(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">s21=zeros(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">z1=zeros(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">z=zeros(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">kd=zeros(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">n1=zeros(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">n=zeros(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">e=zeros(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">miu=zeros(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i=<span class="number">1</span>:N</span><br><span class="line">    f(i)=real11(i,<span class="number">1</span>);</span><br><span class="line">    s11(i)=real11(i,<span class="number">2</span>)+<span class="number">1j</span>*imag11(i,<span class="number">2</span>);</span><br><span class="line">    s21(i)=real21(i,<span class="number">2</span>)+<span class="number">1j</span>*imag21(i,<span class="number">2</span>);</span><br><span class="line">end</span><br><span class="line"><span class="keyword">for</span> i=<span class="number">1</span>:N</span><br><span class="line">    z1(i)=sqrt(((<span class="number">1</span>+s11(i))^<span class="number">2</span>-s21(i)^<span class="number">2</span>)/((<span class="number">1</span>-s11(i))^<span class="number">2</span>-s21(i)^<span class="number">2</span>));</span><br><span class="line">    <span class="keyword">if</span> real(z1(i))&gt;<span class="number">0</span></span><br><span class="line">        z(i)=z1(i);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        z(i)=-z1(i);</span><br><span class="line">    end</span><br><span class="line">    kd(i)=d*<span class="number">2</span>*pi*f(i)*<span class="number">1e9</span>/c;</span><br><span class="line">    n1(i)=acos((<span class="number">1</span>-s11(i)^<span class="number">2</span>+s21(i)^<span class="number">2</span>)/<span class="number">2</span>/s21(i))/kd(i);</span><br><span class="line">    <span class="keyword">if</span> imag(n1(i))&gt;<span class="number">0</span></span><br><span class="line">        n(i)=n1(i);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        n(i)=-n1(i);</span><br><span class="line">    end</span><br><span class="line">    e(i)=n(i)/z(i);</span><br><span class="line">    miu(i)=n(i)*z(i);</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">figure(<span class="number">1</span>)</span><br><span class="line"> subplot(<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line"> plot(f,real(e),f,imag(e),<span class="string">&#x27;r:&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"> xlabel(<span class="string">&#x27;Frequency/THz&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"> ylabel(<span class="string">&#x27;Permittivity (\epsilon)&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"> legend(<span class="string">&#x27;Re(\epsilon)&#x27;</span>,<span class="string">&#x27;Im(\epsilon)&#x27;</span>);</span><br><span class="line"> </span><br><span class="line"> subplot(<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line"> plot(f,real(miu),f,imag(miu),<span class="string">&#x27;r:&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"> xlabel(<span class="string">&#x27;Frequency/THz&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"> ylabel(<span class="string">&#x27;Permeability (\mu)&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"> legend(<span class="string">&#x27;Re(\mu)&#x27;</span>,<span class="string">&#x27;Im(\mu))&#x27;</span>);</span><br><span class="line"> </span><br><span class="line"> subplot(<span class="number">3</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line"> plot(f,real(z),f,imag(z),<span class="string">&#x27;r:&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"> xlabel(<span class="string">&#x27;Frequency/THz&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"> ylabel(<span class="string">&#x27;Impedance (z)&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"> legend(<span class="string">&#x27;Re(Z)&#x27;</span>,<span class="string">&#x27;Im(Z))&#x27;</span>);</span><br><span class="line"> </span><br><span class="line"> subplot(<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>)</span><br><span class="line"> plot(f,real(n),f,imag(n),<span class="string">&#x27;r:&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"> xlabel(<span class="string">&#x27;Frequency/THz&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"> ylabel(<span class="string">&#x27;Refractive Index (n)&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"> legend(<span class="string">&#x27;Re(n)&#x27;</span>,<span class="string">&#x27;Im(n))&#x27;</span>);</span><br><span class="line"> hold on</span><br><span class="line"> plot(f,f-f,<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line"> %---------------------------------------------------------</span><br><span class="line"> figure(<span class="number">2</span>)</span><br><span class="line"> plot(f,real(miu),f,imag(miu),<span class="string">&#x27;r:&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"> xlabel(<span class="string">&#x27;Frequency/THz&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"> ylabel(<span class="string">&#x27;Permeability (\mu)&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"> legend(<span class="string">&#x27;Re(\mu)&#x27;</span>,<span class="string">&#x27;Im(\mu))&#x27;</span>);</span><br><span class="line"></span><br><span class="line"> figure(<span class="number">3</span>)</span><br><span class="line"> plot(f,real(e),f,imag(e),<span class="string">&#x27;r:&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"> xlabel(<span class="string">&#x27;Frequency/THz&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"> ylabel(<span class="string">&#x27;Permittivity (\epsilon)&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"> legend(<span class="string">&#x27;Re(\epsilon)&#x27;</span>,<span class="string">&#x27;Im(\epsilon)&#x27;</span>);</span><br><span class="line"> </span><br><span class="line"> figure(<span class="number">4</span>)</span><br><span class="line"> plot(f,real(z),f,imag(z),<span class="string">&#x27;r:&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"> xlabel(<span class="string">&#x27;Frequency/THz&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"> ylabel(<span class="string">&#x27;Impedance (z)&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"> legend(<span class="string">&#x27;Re(Z)&#x27;</span>,<span class="string">&#x27;Im(Z))&#x27;</span>);</span><br><span class="line"> </span><br><span class="line">  figure(<span class="number">5</span>)</span><br><span class="line"> plot(f,real(n),f,imag(n),<span class="string">&#x27;r:&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"> xlabel(<span class="string">&#x27;Frequency/THz&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"> ylabel(<span class="string">&#x27; refractive index(n)&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"> legend(<span class="string">&#x27;Re(n)&#x27;</span>,<span class="string">&#x27;Im(n))&#x27;</span>);</span><br><span class="line"> yy=interp1(f,n,<span class="number">1</span>);</span><br><span class="line"> </span><br><span class="line">% figure(<span class="number">2</span>)</span><br><span class="line">% subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">% plot(f,real(epsilon1),f,imag(epsilon1),<span class="string">&#x27;r:&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">2</span>); xlabel(<span class="string">&#x27;Frequency/GHz&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);ylabel(<span class="string">&#x27;Permittivity (\epsilon)&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);legend(<span class="string">&#x27;Re(\epsilon1)&#x27;</span>,<span class="string">&#x27;Im(\epsilon1)&#x27;</span>,<span class="number">4</span>);</span><br><span class="line">% subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">% plot(f,real(epsilon2),f,imag(epsilon2),<span class="string">&#x27;r:&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">2</span>); xlabel(<span class="string">&#x27;Frequency/GHz&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);ylabel(<span class="string">&#x27;Permittivity (\epsilon)&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>); legend(<span class="string">&#x27;Re(\epsilon2)&#x27;</span>,<span class="string">&#x27;Im(\epsilon2)&#x27;</span>,<span class="number">4</span>);</span><br><span class="line">% subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">% plot(f,real(epsilon3),f,imag(epsilon3),<span class="string">&#x27;r:&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">2</span>); xlabel(<span class="string">&#x27;Frequency/GHz&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>); ylabel(<span class="string">&#x27;Permittivity (\epsilon)&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>); legend(<span class="string">&#x27;Re(\epsilon3)&#x27;</span>,<span class="string">&#x27;Im(\epsilon3)&#x27;</span>,<span class="number">4</span>);</span><br><span class="line">% subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>)</span><br><span class="line">% plot(f,real(mur),f,imag(mur),<span class="string">&#x27;r:&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">2</span>); xlabel(<span class="string">&#x27;Frequency/GHz&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>); ylabel(<span class="string">&#x27;Permeability (\mu)&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">10</span>,<span class="string">&#x27;fontweight&#x27;</span>,<span class="string">&#x27;b&#x27;</span>);legend(<span class="string">&#x27;Re(\mu)&#x27;</span>,<span class="string">&#x27;Im(\mu))&#x27;</span>,<span class="number">4</span>);</span><br></pre></td></tr></table></figure>

<h2 id="折射率等差-插值"><a href="#折射率等差-插值" class="headerlink" title="折射率等差 插值"></a>折射率等差 插值</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">clear Z;%%%%%%%%%%% a:原始数据</span><br><span class="line">z1=<span class="number">0.34</span>:<span class="number">0.02</span>:<span class="number">2.5</span>;z1=z1*<span class="number">1000</span>;</span><br><span class="line">n=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i=<span class="number">1</span>:length(a(:,<span class="number">1</span>)) % 原x数据 <span class="number">528</span></span><br><span class="line">    <span class="keyword">for</span> m=<span class="number">1</span>:length(z1) % 等差后的数据 <span class="number">979</span></span><br><span class="line">        <span class="keyword">if</span> (a(i,<span class="number">1</span>)-z1(m)&lt;=<span class="number">0</span>)&amp;&amp;(a(i+<span class="number">1</span>,<span class="number">1</span>)-z1(m)&gt;<span class="number">0</span>)</span><br><span class="line">            y11(n,<span class="number">1</span>)=a(i,<span class="number">2</span>)+(z1(n)-a(i,<span class="number">1</span>))*(a(i+<span class="number">1</span>,<span class="number">2</span>)-a(i,<span class="number">2</span>))/(a(i+<span class="number">1</span>,<span class="number">1</span>)-a(i,<span class="number">1</span>));</span><br><span class="line">            y22(n,<span class="number">1</span>)=a(i,<span class="number">3</span>)+(z1(n)-a(i,<span class="number">1</span>))*(a(i+<span class="number">1</span>,<span class="number">3</span>)-a(i,<span class="number">3</span>))/(a(i+<span class="number">1</span>,<span class="number">1</span>)-a(i,<span class="number">1</span>));</span><br><span class="line">            n=n+<span class="number">1</span>;</span><br><span class="line">        end</span><br><span class="line">    end  </span><br><span class="line">end</span><br><span class="line">%y11=y11<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">z1=z1&#x27;</span>;</span><br><span class="line"> %y22=y22<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">%Z=[z1,y11,y22];</span></span><br><span class="line"><span class="string">clear i;clear m;clear n;</span></span><br><span class="line"><span class="string">% clear y11;clear y22;clear z1;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">% c=roundn(Z,-4); </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[tmp I] = unique(a(:,1), &#x27;</span>first<span class="string">&#x27;);a = a(I,:); % 删除矩阵中第一列重复项</span></span><br><span class="line"><span class="string">wave = 300:20:2500;</span></span><br><span class="line"><span class="string">for ix = 2:length(a(1,:))</span></span><br><span class="line"><span class="string">    b(ix,:) = interp1(a(:,1),a(:,ix),wave,&#x27;</span>spline<span class="string">&#x27;);%  &#x27;</span>nearest<span class="string">&#x27;是最邻近插值， &#x27;</span>linea<span class="string">r&#x27;线性插值； &#x27;</span>spline<span class="string">&#x27;三次样条插值； &#x27;</span>pchip<span class="string">&#x27;立方插值．</span></span><br><span class="line"><span class="string">end</span></span><br><span class="line"><span class="string">b=b&#x27;</span>;</span><br><span class="line">wave=wave<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">b(:,1) = wave;</span></span><br></pre></td></tr></table></figure>

<h2 id="阻抗分析"><a href="#阻抗分析" class="headerlink" title="阻抗分析"></a>阻抗分析</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">function [R] = reflection_disp_norm(n_in, n_out, n_disp, d, <span class="keyword">lambda</span>)</span><br><span class="line">%REFLECTION_DISP_NORM Calculates the normal reflection spectrum of a multi-layer structure</span><br><span class="line">%   R: reflection spectrum</span><br><span class="line">% </span><br><span class="line">%   n_in: scalar/vector that specifies the refractive index of the incident material</span><br><span class="line">%   n_out: scalar/vector that specifies the refractive index of the substrate material</span><br><span class="line">%   n_disp: matrix that specifies the dispersive refractive indices of the structure</span><br><span class="line">%   d: vector that specifies the thicknesses of each layer</span><br><span class="line">%   theta_in: vector that specifies the wavelength of interest</span><br><span class="line">%%</span><br><span class="line">d = <span class="built_in">abs</span>(d);  %<span class="built_in">abs</span>取绝对值</span><br><span class="line">K = length(d); </span><br><span class="line">Z_out = <span class="number">1.</span>/n_out; </span><br><span class="line">Z_in = <span class="number">1</span>/n_in; </span><br><span class="line"></span><br><span class="line">%% Iteratively use the impedance method迭代地使用阻抗法</span><br><span class="line">Z_inter = Z_out; </span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>:K</span><br><span class="line">    j = K-i+<span class="number">1</span>; </span><br><span class="line">    nj = n_disp(:, j); </span><br><span class="line">    dj = d(j); </span><br><span class="line">    Z_inter = <span class="number">1.</span>/nj .* (Z_inter + 1i*<span class="number">1.</span>/nj .* tan(<span class="number">2</span>*pi*nj./<span class="keyword">lambda</span> * dj)) ./ (<span class="number">1.</span>/nj + 1i.*Z_inter .* tan(<span class="number">2</span>*pi*nj./<span class="keyword">lambda</span> * dj));   </span><br><span class="line">end</span><br><span class="line">R = <span class="built_in">abs</span>((Z_inter - Z_in) ./ (Z_inter + Z_in)).^<span class="number">2</span>; </span><br><span class="line">end</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>计算ART 吸收&#x2F;透射&#x2F;反射</p>
<p>&#96;&#96;python</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">% % M = reflectance_TE(<span class="number">1</span>,<span class="number">1</span>,[<span class="number">3</span> <span class="number">4</span>],[<span class="number">100</span> <span class="number">50</span>]*<span class="number">1e-9</span>,<span class="number">0</span>,<span class="number">400</span>*<span class="number">1e-9</span>)</span><br><span class="line">% n0 = <span class="number">1</span>;</span><br><span class="line">% nsubs = <span class="number">1</span>;</span><br><span class="line">% n_layers = [<span class="number">3</span> <span class="number">4</span>];</span><br><span class="line">% d_layers = [<span class="number">100</span> <span class="number">50</span>]*<span class="number">1e-9</span>;</span><br><span class="line">% theta_in = <span class="number">0</span>;</span><br><span class="line">% <span class="keyword">lambda</span> = <span class="number">400</span>*<span class="number">1e-9</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function [R_TE,T_TE] = reflectance_TE(n0,nsubs,n_layers,d_layers,theta_in,<span class="keyword">lambda</span>)</span><br><span class="line"></span><br><span class="line">% Mohammad Asif Zaman</span><br><span class="line">% June <span class="number">3</span> <span class="keyword">and</span> <span class="number">4</span>, <span class="number">2018</span></span><br><span class="line">% Reflectance calculaiton</span><br><span class="line">% Arguments: </span><br><span class="line">% n0 = refractive index of the <span class="built_in">input</span> medium</span><br><span class="line">% nsubs = refractive index of the substrate</span><br><span class="line">% n_layers = refractive indices of the thin-film layers</span><br><span class="line">% theta_in = incident angle (<span class="keyword">in</span> radians)</span><br><span class="line">% <span class="keyword">lambda</span> = wavelength</span><br><span class="line">% R_TE = output = reflectivity</span><br><span class="line">% -------------------------------- %</span><br><span class="line">%                                  %</span><br><span class="line">%               Air                %  </span><br><span class="line">%                                  %  </span><br><span class="line">% -------------------------------- % </span><br><span class="line">%             Layer <span class="number">1</span>              %</span><br><span class="line">% -------------------------------- %</span><br><span class="line">%             Layer <span class="number">2</span>              %</span><br><span class="line">% -------------------------------- %</span><br><span class="line">%                .                 %</span><br><span class="line">%                .                 %</span><br><span class="line">%                .                 %</span><br><span class="line">% -------------------------------- %</span><br><span class="line">%             Layer N              %  </span><br><span class="line">% -------------------------------- %</span><br><span class="line">%                                  %</span><br><span class="line">%            Substrate             %   </span><br><span class="line">%                                  %   </span><br><span class="line">% -------------------------------- %</span><br><span class="line">% We calculate the parameter theta, Z, <span class="keyword">and</span> eta on <span class="built_in">all</span> layers</span><br><span class="line">% There are N dielectric layers. The air (<span class="keyword">or</span> other) layer on top. And a</span><br><span class="line">% substrate layer on bottom. So, total N+<span class="number">2</span> layers.</span><br><span class="line">% We define (N+<span class="number">2</span>)x <span class="number">1</span> matrices <span class="keyword">for</span> <span class="built_in">all</span> quantities.</span><br><span class="line">% Haus book.</span><br><span class="line"></span><br><span class="line">Z0 = <span class="number">377</span>;</span><br><span class="line"></span><br><span class="line">theta_out = asin(n0*sin(theta_in)/nsubs); % 正入射=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">N = length(n_layers);   % 结构层数</span><br><span class="line">n = zeros(N+<span class="number">2</span>,<span class="number">1</span>);       % 材料折射率</span><br><span class="line">theta =  zeros(N+<span class="number">2</span>,<span class="number">1</span>);  % 入射角度</span><br><span class="line">Z = zeros(N+<span class="number">2</span>,<span class="number">1</span>);       % 阻抗</span><br><span class="line">eta = zeros(N+<span class="number">2</span>,<span class="number">1</span>);     % 导纳</span><br><span class="line"></span><br><span class="line">n(<span class="number">1</span>) = n0;              % 空气折射率</span><br><span class="line">n(end) = nsubs;         % 最底层 基底折射率</span><br><span class="line">n(<span class="number">2</span>:end-<span class="number">1</span>) = n_layers;	% 中间层为多层薄膜结构</span><br><span class="line"></span><br><span class="line">theta(<span class="number">1</span>) = theta_in;    % 入射角度=<span class="number">0</span></span><br><span class="line">theta(end) = theta_out; % 出射角度=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">Z(<span class="number">1</span>) = Z0./(n(<span class="number">1</span>)*cos(theta(<span class="number">1</span>)));        % 第一层阻抗</span><br><span class="line">Z(end) = Z0./(n(end)*cos(theta(end)));  % 最底层阻抗</span><br><span class="line"></span><br><span class="line">eta(<span class="number">1</span>) = Z0./(cos(theta(<span class="number">1</span>)) .*n(<span class="number">1</span>));        % 媒质<span class="number">1</span>波阻抗</span><br><span class="line">eta(end) = Z0./(cos(theta(end)) .*n(end));  % 媒质end波阻抗</span><br><span class="line"></span><br><span class="line">Matrices = [<span class="number">1</span>,<span class="number">0</span>;<span class="number">0</span>,<span class="number">1</span>];</span><br><span class="line">Mcon = Matrices(:,:,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> k = N:-<span class="number">1</span>:<span class="number">1</span>    % Work backwards <span class="keyword">from</span> the last layer. </span><br><span class="line">%   k represents index over the dielectric layers.</span><br><span class="line">    m = k + <span class="number">1</span>;    % Layer index going <span class="keyword">from</span> N+<span class="number">1</span> to <span class="number">2.</span> </span><br><span class="line">                  % since we know the parameters <span class="keyword">for</span> layer <span class="number">1</span> <span class="keyword">and</span> layer N+<span class="number">2.</span></span><br><span class="line">    </span><br><span class="line">    % Calculate parameters at m layer using data <span class="keyword">from</span> (m+<span class="number">1</span>) layer </span><br><span class="line">    theta(m) = asin( n(m+<span class="number">1</span>)*sin( theta(m+<span class="number">1</span>) ) / n(m)  );        % 入射角度=<span class="number">0</span></span><br><span class="line">    eta(m) = Z0./( cos(theta(m)) .*n(m) );</span><br><span class="line">    </span><br><span class="line">    tmp = <span class="number">2</span>*pi*n(m)/<span class="keyword">lambda</span> * cos(theta(m)) * d_layers(k);       % delta</span><br><span class="line">    Z(m) = eta(m)*( Z(m+<span class="number">1</span>) + i*eta(m)*tan(tmp) ) ./ (eta(m) + i*Z(m+<span class="number">1</span>)*tan(tmp));</span><br><span class="line">    %%</span><br><span class="line">    eta1(m) = n(m)*cos(theta(m));</span><br><span class="line">    Matrices(:,:,m) = [cos(tmp),-1i*sin(tmp)/eta1(m);</span><br><span class="line">        -1i*eta1(m)*sin(tmp),cos(tmp)]; % matrices de cada capa</span><br><span class="line">    Mcon = Mcon*Matrices(:,:,m);</span><br><span class="line">end</span><br><span class="line">BC = Mcon*[<span class="number">1</span>;n(end)*cos(theta(end))];</span><br><span class="line">% BC = Mcon*[<span class="number">1</span>;<span class="number">1</span>];</span><br><span class="line">Y = BC(<span class="number">2</span>)/BC(<span class="number">1</span>);</span><br><span class="line">eta_o = n0*cos(theta_in);</span><br><span class="line">% theta</span><br><span class="line">% eta</span><br><span class="line">% Z</span><br><span class="line">% R_TE = ((eta_o-Y)/(eta_o+Y))*conj((eta_o-Y)/(eta_o+Y)); % reflectancia</span><br><span class="line">% R_TE = <span class="built_in">abs</span>( (Z(<span class="number">2</span>)-Z(<span class="number">1</span>) ) ./ ( Z(<span class="number">2</span>)+Z(<span class="number">1</span>) ) ).^<span class="number">2</span>;</span><br><span class="line">R_TE = ( (Z(<span class="number">2</span>)-Z(<span class="number">1</span>) ) / ( Z(<span class="number">2</span>)+Z(<span class="number">1</span>) ) )    *conj( (Z(<span class="number">2</span>)-Z(<span class="number">1</span>) ) / ( Z(<span class="number">2</span>)+Z(<span class="number">1</span>) ) );</span><br><span class="line">T_TE = real(eta(end)/eta(<span class="number">1</span>))* <span class="built_in">abs</span>( (   <span class="number">2</span>*Z(<span class="number">2</span>) ) ./ ( Z(<span class="number">2</span>)+Z(<span class="number">1</span>) ) ).^<span class="number">2</span>;</span><br></pre></td></tr></table></figure>









<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line">clc;</span><br><span class="line">clear <span class="built_in">all</span>;</span><br><span class="line">%% Constantes</span><br><span class="line">c_speed = <span class="number">3e17</span>;% 光速/nm</span><br><span class="line">hbar = <span class="number">6.582119514e-16</span>; %eV*s</span><br><span class="line">J = <span class="number">2.6544e-3</span>;% factor admitancia</span><br><span class="line"></span><br><span class="line">Cavidad = &#123;<span class="string">&#x27;sustrato&#x27;</span>,<span class="string">&#x27;plata&#x27;</span>,<span class="string">&#x27;silica&#x27;</span>,<span class="string">&#x27;TDBC&#x27;</span>,<span class="string">&#x27;silica&#x27;</span>,<span class="string">&#x27;plata&#x27;</span>,<span class="string">&#x27;aire&#x27;</span>&#125;;</span><br><span class="line">Ncapas = length(Cavidad);           % layer = <span class="number">7</span></span><br><span class="line">polarizacion = <span class="number">2</span>; %TM = <span class="number">1</span>, TE = <span class="number">2</span>   % TE-polarization</span><br><span class="line"></span><br><span class="line">dEntrada = <span class="number">0</span>;                       % thickness</span><br><span class="line">dAg = <span class="number">30</span>;</span><br><span class="line">dTDBC = <span class="number">20</span>;</span><br><span class="line">dSilicaL = <span class="number">50</span>;</span><br><span class="line">dSilicaR = <span class="number">50</span>;</span><br><span class="line">dS = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">n0 = <span class="number">1</span>;                             % 空气折射率</span><br><span class="line">nEntrada = <span class="number">1.4587</span>;                  % 入射折射率</span><br><span class="line">nS = <span class="number">1</span>;                             % 基底折射率</span><br><span class="line"></span><br><span class="line">%% Definici髇 de par醡etros</span><br><span class="line">x = <span class="number">200</span>;</span><br><span class="line">y = <span class="number">200</span>;</span><br><span class="line">Emin = <span class="number">1.5</span>; % eV</span><br><span class="line">Emax = <span class="number">3.2</span>; % eV</span><br><span class="line"><span class="keyword">lambda</span> = linspace(<span class="number">2</span>*pi*c_speed*hbar/Emax,<span class="number">2</span>*pi*c_speed*hbar/Emin,y); % 波长/nm </span><br><span class="line"></span><br><span class="line">theta = <span class="number">0</span>;%(pi/<span class="number">180</span>)*linspace(<span class="number">0</span>,<span class="number">90</span>,x); % 入射角度-<span class="number">200</span>扫描点</span><br><span class="line">w1 = <span class="number">2</span>*pi*c_speed./<span class="keyword">lambda</span>;</span><br><span class="line">E = hbar*w1;</span><br><span class="line">ko = <span class="number">2</span>*pi./<span class="keyword">lambda</span>;</span><br><span class="line"></span><br><span class="line">kx = zeros(y,x);</span><br><span class="line">R = zeros(length(theta),length(<span class="keyword">lambda</span>));</span><br><span class="line">T = zeros(length(theta),length(<span class="keyword">lambda</span>));</span><br><span class="line">A = zeros(length(theta),length(<span class="keyword">lambda</span>));</span><br><span class="line"></span><br><span class="line">% <span class="keyword">for</span> i = <span class="number">1</span>:y</span><br><span class="line">%     <span class="keyword">for</span> ii = <span class="number">1</span>:x</span><br><span class="line">%         kx(i,ii) = n0*ko(i)*sin(theta(ii)); % 入射角度</span><br><span class="line">%     end</span><br><span class="line">% end</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k = <span class="number">1</span>:length(theta) % incident-angle</span><br><span class="line"><span class="keyword">for</span> l = <span class="number">1</span>:length(<span class="keyword">lambda</span>) % wavelength</span><br><span class="line">    %% Variables</span><br><span class="line">    w = <span class="number">2</span>*pi*c_speed/<span class="keyword">lambda</span>(l);</span><br><span class="line"></span><br><span class="line">eps5a = lorentzAg(w); % silver</span><br><span class="line">eps5a_real = real(eps5a);</span><br><span class="line">eps5a_im = imag(eps5a);</span><br><span class="line"></span><br><span class="line">eps5g = lorentzTDBC(w); % TDBC</span><br><span class="line">eps5g_real = real(eps5g);</span><br><span class="line">eps5g_im = imag(eps5g);</span><br><span class="line"></span><br><span class="line">% Indice de refracci髇 Ag y TBDC</span><br><span class="line">nAg = (eps5a_real+1i*eps5a_im)^<span class="number">0.5</span>;</span><br><span class="line">nTDBC = (eps5g_real+1i*eps5g_im)^<span class="number">0.5</span>;</span><br><span class="line">n_silica = sellmeier(<span class="keyword">lambda</span>(l));</span><br><span class="line">%% 相邻两个界面的入射角度 theta</span><br><span class="line">theta_Entrada = theta(k); % 入射角度</span><br><span class="line">theta_Ag1 = asin((nEntrada/nAg)*sin(theta_Entrada));</span><br><span class="line">theta_silicaL = asin((nAg/n_silica)*sin(theta_Ag1));</span><br><span class="line">theta_TDBC = asin((n_silica/nTDBC)*sin(theta_silicaL));</span><br><span class="line">theta_silicaR = asin((nTDBC/n_silica)*sin(theta_TDBC));</span><br><span class="line">theta_Ag2 = asin((n_silica/nAg)*sin(theta_silicaR));</span><br><span class="line">theta_S = asin((nAg/nS)*sin(theta_Ag2)); % </span><br><span class="line">%% delta</span><br><span class="line">deltaEntrada = <span class="number">2</span>*pi*nEntrada*dEntrada*cos(theta_Entrada)/<span class="keyword">lambda</span>(l);</span><br><span class="line">deltaAg1 = <span class="number">2</span>*pi*nAg*dAg*cos(theta_Ag1)/<span class="keyword">lambda</span>(l);</span><br><span class="line">delta_silicaL = <span class="number">2</span>*pi*n_silica*dSilicaL*cos(theta_silicaL)/<span class="keyword">lambda</span>(l);</span><br><span class="line">deltaTDBC = <span class="number">2</span>*pi*nTDBC*dTDBC*cos(theta_TDBC)/<span class="keyword">lambda</span>(l);</span><br><span class="line">delta_silicaR = <span class="number">2</span>*pi*n_silica*dSilicaR*cos(theta_silicaR)/<span class="keyword">lambda</span>(l);</span><br><span class="line">deltaAg2 = <span class="number">2</span>*pi*nAg*dAg*cos(theta_Ag2)/<span class="keyword">lambda</span>(l);</span><br><span class="line">deltaS = <span class="number">2</span>*pi*nS*dS*cos(theta_S)/<span class="keyword">lambda</span>(l);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> polarizacion == <span class="number">1</span></span><br><span class="line">        etaEntrada = nEntrada/cos(theta_Entrada);        etaAg1 = nAg/cos(theta_Ag1);</span><br><span class="line">        eta_silicaL = n_silica/cos(theta_silicaL);        etaTDBC = nTDBC/cos(theta_TDBC);</span><br><span class="line">        eta_silicaR = n_silica/cos(theta_silicaR);        etaAg2 = nAg/cos(theta_Ag2);</span><br><span class="line">        etaS = nS/cos(theta_S);        eta_m = etaS;        eta_o = n0/cos(theta(k));</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">        etaEntrada = nEntrada*cos(theta_Entrada);</span><br><span class="line">        etaAg1 = nAg*cos(theta_Ag1);</span><br><span class="line">        eta_silicaL = n_silica*cos(theta_silicaL);</span><br><span class="line">        etaTDBC = nTDBC*cos(theta_TDBC);</span><br><span class="line">        eta_silicaR = n_silica*cos(theta_silicaR);</span><br><span class="line">        etaAg2 = nAg*cos(theta_Ag2);</span><br><span class="line">        etaS = nS*cos(theta_S);</span><br><span class="line">        eta_m = etaS;</span><br><span class="line">        eta_o = n0*cos(theta(k));</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">delta = [deltaEntrada deltaAg1 delta_silicaL deltaTDBC delta_silicaR deltaAg2 deltaS];</span><br><span class="line">eta   = [etaEntrada   etaAg1   eta_silicaL   etaTDBC   eta_silicaR   etaAg2   etaS  ];</span><br><span class="line"></span><br><span class="line">%% Matriz de matrices de cada capa</span><br><span class="line">Matrices = [cos(deltaEntrada),-1i*sin(deltaEntrada)/etaEntrada; % primera matriz</span><br><span class="line">           -1i*etaEntrada*sin(deltaEntrada),cos(deltaEntrada)];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i=<span class="number">2</span>:Ncapas</span><br><span class="line">        Matrices(:,:,i) = [cos(delta(i)),-1i*sin(delta(i))/eta(i); % matrices de cada capa</span><br><span class="line">                           -1i*eta(i)*sin(delta(i)),cos(delta(i))];</span><br><span class="line">    end</span><br><span class="line"></span><br><span class="line">%% Matriz <span class="keyword">del</span> conjunto</span><br><span class="line">Mcon = Matrices(:,:,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i=<span class="number">2</span>:Ncapas</span><br><span class="line">        Mcon = Mcon*Matrices(:,:,i); % matriz <span class="keyword">del</span> conjunto</span><br><span class="line">    end</span><br><span class="line"></span><br><span class="line">%% C醠culo de la reflectancia</span><br><span class="line">BC = Mcon*[<span class="number">1</span>;etaS];</span><br><span class="line">Y = BC(<span class="number">2</span>)/BC(<span class="number">1</span>);</span><br><span class="line">R(k,l) = ((eta_o-Y)/(eta_o+Y))*conj((eta_o-Y)/(eta_o+Y)); % reflectancia</span><br><span class="line">A(k,l) = (<span class="number">4</span>*eta_o*real(BC(<span class="number">1</span>)*conj(BC(<span class="number">2</span>))-eta_m))   /((eta_o*BC(<span class="number">1</span>)+BC(<span class="number">2</span>))*conj(eta_o*BC(<span class="number">1</span>)+BC(<span class="number">2</span>))); % absorbancia</span><br><span class="line">T(k,l) = (<span class="number">4</span>*eta_o*real(eta_m))/((eta_o*BC(<span class="number">1</span>)+BC(<span class="number">2</span>))*conj(eta_o*BC(<span class="number">1</span>)+BC(<span class="number">2</span>))); % transmitancia</span><br><span class="line"></span><br><span class="line">end</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">%% Curva de Dispersi髇</span><br><span class="line">% figure (<span class="number">1</span>)</span><br><span class="line">% E = repmat(E,x,<span class="number">1</span>);</span><br><span class="line">% h = surf(kx<span class="string">&#x27;,E,R);</span></span><br><span class="line"><span class="string">% colormap (parula)</span></span><br><span class="line"><span class="string">% ylim([Emin,Emax])</span></span><br><span class="line"><span class="string">% xlim([0,max(max(kx))+0.05*max(max(kx))])</span></span><br><span class="line"><span class="string">% set(h,&#x27;</span>edgecolo<span class="string">r&#x27;,&#x27;</span>none<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">% colorbar</span></span><br><span class="line"><span class="string">% view(2)</span></span><br><span class="line"><span class="string">% ylabel(&#x27;</span>Energ韆 [eV]<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">% xlabel(&#x27;</span>k_&#123;||&#125; [nm^&#123;-<span class="number">1</span>&#125;]<span class="string">&#x27;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">%% Reflectancia, Absortancia y Transmitancia</span></span><br><span class="line"><span class="string">figure (2)</span></span><br><span class="line"><span class="string">plot(lambda,T(1,:),&#x27;</span><span class="string">b&#x27;,lambda,R(1,:),&#x27;</span><span class="string">r&#x27;,lambda,A(1,:),&#x27;</span>g<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">legend(&#x27;</span>\fontsize&#123;<span class="number">9</span>&#125;Transmitancia<span class="string">&#x27;,&#x27;</span>\fontsize&#123;<span class="number">9</span>&#125;Reflectancia<span class="string">&#x27;,&#x27;</span>\fontsize&#123;<span class="number">9</span>&#125;Absortancia<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">xlabel(&#x27;</span>Longitud de onda [nm]<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">ylabel(&#x27;</span>Intensidad<span class="string">&#x27;)</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>



<h2 id="MATLAB绘制不同Ra-距离不同的图片"><a href="#MATLAB绘制不同Ra-距离不同的图片" class="headerlink" title="MATLAB绘制不同Ra 距离不同的图片"></a>MATLAB绘制不同Ra 距离不同的图片</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ix = <span class="number">1</span>:length(a(:,<span class="number">1</span>)) % 最里面</span><br><span class="line">        plot(a(ix,<span class="number">1</span>),a(ix,<span class="number">2</span>),<span class="string">&#x27;ko&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">1.2</span>);hold on; </span><br><span class="line">end  </span><br><span class="line"><span class="built_in">set</span>(gca,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;times new Roman&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">20</span>);</span><br><span class="line">axis([<span class="number">0</span>,<span class="number">0.9</span>,<span class="number">0</span>,<span class="number">0.9</span>]);box on;hold on;</span><br><span class="line"><span class="built_in">set</span>(gca,<span class="string">&#x27;linewidth&#x27;</span>,<span class="number">1.2</span>);</span><br><span class="line"><span class="built_in">set</span>(gca,<span class="string">&#x27;XTick&#x27;</span>,[<span class="number">0</span>:<span class="number">0.3</span>:<span class="number">0.9</span>]);   % 修改x轴坐标间隔</span><br><span class="line"><span class="built_in">set</span>(gca,<span class="string">&#x27;YTick&#x27;</span>,[<span class="number">0</span>:<span class="number">0.3</span>:<span class="number">0.9</span>]);   % 修改x轴坐标间隔</span><br><span class="line">% xlabel(<span class="string">&#x27;Δ&#123;\itA&#125;_&#123;sol&#125;&#x27;</span>); ylabel(<span class="string">&#x27;&#123;\itT&#125;_&#123;lum&#125;&#x27;</span>);</span><br><span class="line"><span class="keyword">for</span> ix = <span class="number">1</span>:length(a(:,<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">if</span> a(ix,<span class="number">4</span>) &lt;= <span class="number">0.02</span></span><br><span class="line">        plot(a(ix,<span class="number">1</span>),a(ix,<span class="number">2</span>),<span class="string">&#x27;ro&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">0.6</span>);hold on;</span><br><span class="line">    end</span><br><span class="line">    <span class="keyword">if</span> a(ix,<span class="number">4</span>) &lt;= <span class="number">0.04</span> &amp;&amp; a(ix,<span class="number">4</span>) &gt; <span class="number">0.02</span></span><br><span class="line">        plot(a(ix,<span class="number">1</span>),a(ix,<span class="number">2</span>),<span class="string">&#x27;b.&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">0.1</span>);hold on;</span><br><span class="line">    end</span><br><span class="line">    <span class="keyword">if</span> a(ix,<span class="number">4</span>) &gt; <span class="number">0.04</span></span><br><span class="line">        plot(a(ix,<span class="number">1</span>),a(ix,<span class="number">2</span>),<span class="string">&#x27;k.&#x27;</span>,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">0.05</span>);hold on;</span><br><span class="line">    end</span><br><span class="line">    </span><br><span class="line">end</span><br><span class="line"><span class="built_in">set</span>(gca,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;times new Roman&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">20</span>);</span><br><span class="line">axis([<span class="number">0</span>,<span class="number">0.9</span>,<span class="number">0</span>,<span class="number">0.9</span>]);box on;hold on;</span><br><span class="line"><span class="built_in">set</span>(gca,<span class="string">&#x27;linewidth&#x27;</span>,<span class="number">1.2</span>);</span><br><span class="line"><span class="built_in">set</span>(gca,<span class="string">&#x27;XTick&#x27;</span>,[<span class="number">0</span>:<span class="number">0.3</span>:<span class="number">0.9</span>]);   % 修改x轴坐标间隔</span><br><span class="line"><span class="built_in">set</span>(gca,<span class="string">&#x27;YTick&#x27;</span>,[<span class="number">0</span>:<span class="number">0.3</span>:<span class="number">0.9</span>]);   % 修改x轴坐标间隔</span><br><span class="line">% xlabel(<span class="string">&#x27;Δ&#123;\itA&#125;_&#123;sol&#125;&#x27;</span>); ylabel(<span class="string">&#x27;&#123;\itT&#125;_&#123;lum&#125;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="TETM折射率有效折射率"><a href="#TETM折射率有效折射率" class="headerlink" title="TETM折射率有效折射率"></a>TETM折射率有效折射率</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">a1 = <span class="number">3.47</span>;</span><br><span class="line">a2 = <span class="number">1.45</span>;</span><br><span class="line">f = <span class="number">0</span>:<span class="number">0.01</span>:<span class="number">1</span>;</span><br><span class="line">t = <span class="number">0</span>;</span><br><span class="line">Py = <span class="number">400</span>;</span><br><span class="line">lam = <span class="number">1550</span>;</span><br><span class="line"><span class="keyword">for</span>   ix = f</span><br><span class="line">    t = t+<span class="number">1</span>;</span><br><span class="line">    te = (    ix/a2^<span class="number">2</span>+(<span class="number">1</span>-ix)/a1^<span class="number">2</span>   )^-<span class="number">0.5</span>;</span><br><span class="line">    n_TE(t,<span class="number">1</span>) = te;</span><br><span class="line">    tm = (    ix*a2^<span class="number">2</span>+(<span class="number">1</span>-ix)*a1^<span class="number">2</span>   )^<span class="number">0.5</span>;</span><br><span class="line">    n_TM(t,<span class="number">1</span>) = tm;</span><br><span class="line">    te2 = te*(<span class="number">1</span>+pi^<span class="number">2</span>/<span class="number">3</span>*(Py/lam)^<span class="number">2</span>*ix^<span class="number">2</span>*(<span class="number">1</span>-ix)^<span class="number">2</span>*( a1^<span class="number">2</span>-a2^<span class="number">2</span>)^<span class="number">2</span>* tm^<span class="number">2</span>*(te/a1/a2)^<span class="number">4</span>    )^<span class="number">0.5</span>;</span><br><span class="line">    %     te*(<span class="number">1</span>+pi*pi/<span class="number">3</span>*(Py/lam)^<span class="number">2</span>*f^<span class="number">2</span>*(<span class="number">1</span>-f)^<span class="number">2</span>*( a1^<span class="number">2</span>-a1^<span class="number">2</span>)^<span class="number">2</span>* tm^<span class="number">2</span>*(te/a1/a2)^<span class="number">4</span>    )^<span class="number">0.5</span>;</span><br><span class="line">    n_TE2(t,<span class="number">1</span>) = te2;</span><br><span class="line">    tm2 = tm*(<span class="number">1</span>+pi^<span class="number">2</span>/<span class="number">3</span>*(Py/lam)^<span class="number">2</span>*ix^<span class="number">2</span>*(<span class="number">1</span>-ix)^<span class="number">2</span>*( a1^<span class="number">2</span>-a2^<span class="number">2</span>)^<span class="number">2</span>/tm^<span class="number">2</span>   )^<span class="number">0.5</span>;</span><br><span class="line">    n_TM2(t,<span class="number">1</span>) = tm2;</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">plot(f,n_TE);hold on;plot(f,n_TM);      hold on;plot(f,n_TE2);hold on;plot(f,n_TM2);</span><br></pre></td></tr></table></figure>

<h2 id="chen-shuo神经网络生成-代码"><a href="#chen-shuo神经网络生成-代码" class="headerlink" title="chen_shuo神经网络生成_代码"></a>chen_shuo神经网络生成_代码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">% clc;clear <span class="built_in">all</span>;</span><br><span class="line">% close <span class="built_in">all</span>;</span><br><span class="line">t1=clock;</span><br><span class="line">%%</span><br><span class="line">% wave_range = [<span class="number">300</span>:<span class="number">10</span>:<span class="number">2000</span>, <span class="number">2100</span>:<span class="number">100</span>:<span class="number">10000</span>];</span><br><span class="line">wave_range = <span class="number">400</span>:<span class="number">5</span>:<span class="number">1300</span>; save(<span class="string">&#x27;wave_range.mat&#x27;</span>,<span class="string">&#x27;wave_range&#x27;</span>);</span><br><span class="line">M_mat = nk_data(wave_range);</span><br><span class="line">shoulian = <span class="number">1</span>;save(<span class="string">&#x27;shoulian.mat&#x27;</span>,<span class="string">&#x27;shoulian&#x27;</span>);</span><br><span class="line">%%</span><br><span class="line">% <span class="number">1</span>  MgF2     % <span class="number">11</span> W</span><br><span class="line">% <span class="number">2</span>  SiO2     % <span class="number">12</span> Mo</span><br><span class="line">% <span class="number">3</span>  Al2O3    % <span class="number">13</span> Cr</span><br><span class="line">% <span class="number">4</span>  Si3N4    % <span class="number">14</span> Fe</span><br><span class="line">% <span class="number">5</span>  Si3N41直 % <span class="number">15</span> Ti</span><br><span class="line">% <span class="number">6</span>  TiO2     % <span class="number">16</span> Ag</span><br><span class="line">% <span class="number">7</span>  SiN      % <span class="number">17</span> Al</span><br><span class="line">% <span class="number">8</span>  Ge       % <span class="number">18</span> Cu-<span class="number">0.29</span>-SiO2</span><br><span class="line">% <span class="number">9</span>  Au</span><br><span class="line">% <span class="number">10</span> Cu</span><br><span class="line">load(<span class="string">&#x27;matlab.mat&#x27;</span>); % 结构<span class="number">2</span>--尺寸</span><br><span class="line">% <span class="keyword">for</span> ink = <span class="number">9</span>:<span class="number">17</span>     cool(<span class="number">1</span>,<span class="number">1</span>) = ink   ;</span><br><span class="line"></span><br><span class="line">lb = cool(:,<span class="number">2</span>)<span class="string">&#x27;;st1 = cool(:,3)&#x27;</span>;ub = cool(:,<span class="number">4</span>)<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">nk_M = M_mat(:,cool(1,1)); for nx = 2:length(cool(:,1))  nk_M = [nk_M,M_mat(:,cool(nx,1))]; end</span></span><br><span class="line"><span class="string">nk_M = [nk_M M_mat(:,2)];   save(&#x27;</span>nk_M.mat<span class="string">&#x27;,&#x27;</span>nk_M<span class="string">&#x27;);    % save nk_M;    % W基底</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">PopulationSize_Data = 0.1*10000 ;  Generations = 8; StallGenerations = Generations; InitialPopulation=st1; nvars = length(lb); % number of variables</span></span><br><span class="line"><span class="string">[x,Aa,exitflag,output,population,score] = GA_code(nvars,lb,ub,PopulationSize_Data,Generations,StallGenerations,InitialPopulation);</span></span><br><span class="line"><span class="string">Aa = -roundn(Aa,-4);   t2=clock;tc(t2,t1);	x=roundn(x&#x27;</span>,-<span class="number">0</span>);    wave_range = wave_range<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">%% plot</span></span><br><span class="line"><span class="string">% for dd=5:2:30</span></span><br><span class="line"><span class="string">%     x(3,1)=dd;</span></span><br><span class="line"><span class="string">%%</span></span><br><span class="line"><span class="string">cs1 = 2:2:20;</span></span><br><span class="line"><span class="string">cs2 = 10:10:300;</span></span><br><span class="line"><span class="string">cs3 = 2:2:20;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[j1,j2,j3]=ndgrid(cs1,cs2,cs3);</span></span><br><span class="line"><span class="string">com=[j1(:),j2(:),j3(:)];clear cs1 cs2 cs3 j1 j2 j3</span></span><br><span class="line"><span class="string">for ix = 1:length(com)</span></span><br><span class="line"><span class="string">    x = com(ix,:)&#x27;</span>;</span><br><span class="line">    shoulian = <span class="number">2</span>;save(<span class="string">&#x27;shoulian.mat&#x27;</span>,<span class="string">&#x27;shoulian&#x27;</span>);</span><br><span class="line">    RTA = <span class="built_in">round</span>(objectivefunction(x<span class="string">&#x27;),4); </span></span><br><span class="line"><span class="string">    R1(:,ix) = RTA(:,1);</span></span><br><span class="line"><span class="string">    T1(:,ix) = RTA(:,2);</span></span><br><span class="line"><span class="string">    A1(:,ix) = RTA(:,3);</span></span><br><span class="line"><span class="string">    R2(:,ix) = RTA(:,4);</span></span><br><span class="line"><span class="string">    T2(:,ix) = RTA(:,5);</span></span><br><span class="line"><span class="string">    A2(:,ix) = RTA(:,6);</span></span><br><span class="line"><span class="string">end</span></span><br><span class="line"><span class="string">%  Tt(:,ink) = RTA(:,3);end</span></span><br><span class="line"><span class="string">figure(&#x27;</span>colo<span class="string">r&#x27;,[1 1 1]); </span></span><br><span class="line"><span class="string">plot(wave_range,RTA(:,1),&#x27;</span><span class="string">b&#x27;,  wave_range,RTA(:,2),&#x27;</span><span class="string">r&#x27;,  wave_range,RTA(:,3),&#x27;</span>g<span class="string">&#x27;,  &#x27;</span>LineWidth<span class="string">&#x27;,2);hold on;</span></span><br><span class="line"><span class="string">plot(wave_range,RTA(:,4),&#x27;</span>b--<span class="string">&#x27;,wave_range,RTA(:,5),&#x27;</span>r--<span class="string">&#x27;,wave_range,RTA(:,6),&#x27;</span>g--<span class="string">&#x27;,&#x27;</span>LineWidth<span class="string">&#x27;,2);hold on;</span></span><br><span class="line"><span class="string">legend(&#x27;</span>\fontsize&#123;<span class="number">20</span>&#125;<span class="string">R&#x27;,&#x27;</span>\fontsize&#123;<span class="number">20</span>&#125;T<span class="string">&#x27;,&#x27;</span>\fontsize&#123;<span class="number">20</span>&#125;A<span class="string">&#x27;); xlabel(&#x27;</span>wavelength (nm)<span class="string">&#x27;);ylabel(&#x27;</span>Intensity<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">set(gca,&#x27;</span>FontSize<span class="string">&#x27;,20);axis([min(wave_range),max(wave_range),0,1]);</span></span><br><span class="line"><span class="string">% aZ = [cool(:,1),x];% z_1 = [x ;-fval*100; A_spectrum];% A_avg(mx)=Aa; % print(gcf,&#x27;</span>-dpng<span class="string">&#x27;,&#x27;</span><span class="number">1.</span>png<span class="string">&#x27;);picture(1);  semilogx(wave_range,a,&#x27;</span>k<span class="string">&#x27;,&#x27;</span>LineWidth<span class="string">&#x27;,1);axis([300 20000 0 1]);</span></span><br><span class="line"><span class="string">clear st1 t1 t2 ub lb score population nx exitflag shoulian CrossoverFraction_Data InitialPopulationMatrix_Data MaxGenerations_Data;clear MaxStallGenerations_Data PopulationSize_Data nvars output ans</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>


                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E5%8D%9A%E5%AE%A2%E5%9B%BE%E7%89%87/">#博客图片</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>MATLAB代码</div>
      <div>http://example.com/2023/11/08/MATLAB/MATLAB代码/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年11月8日</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>更新于</div>
          <div>2023年5月12日</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/11/08/Python/Python%E5%B8%B8%E7%94%A8/" title="Python常用">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Python常用</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  

<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>





  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
